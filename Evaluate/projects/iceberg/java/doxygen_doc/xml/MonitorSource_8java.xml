<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.17">
  <compounddef id="MonitorSource_8java" kind="file" language="Java">
    <compoundname>MonitorSource.java</compoundname>
    <innerclass refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource" prot="public">org::apache::iceberg::flink::maintenance::operator::MonitorSource</innerclass>
    <innerclass refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1_1TableChangeIterator" prot="package">org::apache::iceberg::flink::maintenance::operator::MonitorSource::TableChangeIterator</innerclass>
    <innerclass refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1_1TableChangeIteratorSerializer" prot="private">org::apache::iceberg::flink::maintenance::operator::MonitorSource::TableChangeIteratorSerializer</innerclass>
    <innernamespace refid="namespaceorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator">org::apache::iceberg::flink::maintenance::operator</innernamespace>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">/*</highlight></codeline>
<codeline lineno="2"><highlight class="comment"><sp/>*<sp/>Licensed<sp/>to<sp/>the<sp/>Apache<sp/>Software<sp/>Foundation<sp/>(ASF)<sp/>under<sp/>one</highlight></codeline>
<codeline lineno="3"><highlight class="comment"><sp/>*<sp/>or<sp/>more<sp/>contributor<sp/>license<sp/>agreements.<sp/><sp/>See<sp/>the<sp/>NOTICE<sp/>file</highlight></codeline>
<codeline lineno="4"><highlight class="comment"><sp/>*<sp/>distributed<sp/>with<sp/>this<sp/>work<sp/>for<sp/>additional<sp/>information</highlight></codeline>
<codeline lineno="5"><highlight class="comment"><sp/>*<sp/>regarding<sp/>copyright<sp/>ownership.<sp/><sp/>The<sp/>ASF<sp/>licenses<sp/>this<sp/>file</highlight></codeline>
<codeline lineno="6"><highlight class="comment"><sp/>*<sp/>to<sp/>you<sp/>under<sp/>the<sp/>Apache<sp/>License,<sp/>Version<sp/>2.0<sp/>(the</highlight></codeline>
<codeline lineno="7"><highlight class="comment"><sp/>*<sp/>&quot;License&quot;);<sp/>you<sp/>may<sp/>not<sp/>use<sp/>this<sp/>file<sp/>except<sp/>in<sp/>compliance</highlight></codeline>
<codeline lineno="8"><highlight class="comment"><sp/>*<sp/>with<sp/>the<sp/>License.<sp/><sp/>You<sp/>may<sp/>obtain<sp/>a<sp/>copy<sp/>of<sp/>the<sp/>License<sp/>at</highlight></codeline>
<codeline lineno="9"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="10"><highlight class="comment"><sp/>*<sp/><sp/><sp/>http://www.apache.org/licenses/LICENSE-2.0</highlight></codeline>
<codeline lineno="11"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="12"><highlight class="comment"><sp/>*<sp/>Unless<sp/>required<sp/>by<sp/>applicable<sp/>law<sp/>or<sp/>agreed<sp/>to<sp/>in<sp/>writing,</highlight></codeline>
<codeline lineno="13"><highlight class="comment"><sp/>*<sp/>software<sp/>distributed<sp/>under<sp/>the<sp/>License<sp/>is<sp/>distributed<sp/>on<sp/>an</highlight></codeline>
<codeline lineno="14"><highlight class="comment"><sp/>*<sp/>&quot;AS<sp/>IS&quot;<sp/>BASIS,<sp/>WITHOUT<sp/>WARRANTIES<sp/>OR<sp/>CONDITIONS<sp/>OF<sp/>ANY</highlight></codeline>
<codeline lineno="15"><highlight class="comment"><sp/>*<sp/>KIND,<sp/>either<sp/>express<sp/>or<sp/>implied.<sp/><sp/>See<sp/>the<sp/>License<sp/>for<sp/>the</highlight></codeline>
<codeline lineno="16"><highlight class="comment"><sp/>*<sp/>specific<sp/>language<sp/>governing<sp/>permissions<sp/>and<sp/>limitations</highlight></codeline>
<codeline lineno="17"><highlight class="comment"><sp/>*<sp/>under<sp/>the<sp/>License.</highlight></codeline>
<codeline lineno="18"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="19" refid="namespaceorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">package<sp/></highlight><highlight class="normal">org.apache.iceberg.flink.maintenance.operator;</highlight></codeline>
<codeline lineno="20"><highlight class="normal"></highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>java.io.IOException;</highlight></codeline>
<codeline lineno="22"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>java.util.Iterator;</highlight></codeline>
<codeline lineno="23"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.flink.annotation.Internal;</highlight></codeline>
<codeline lineno="24"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.flink.api.common.typeinfo.TypeInformation;</highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.flink.api.connector.source.Boundedness;</highlight></codeline>
<codeline lineno="26"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.flink.api.connector.source.SourceReader;</highlight></codeline>
<codeline lineno="27"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.flink.api.connector.source.SourceReaderContext;</highlight></codeline>
<codeline lineno="28"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.flink.api.connector.source.util.ratelimit.RateLimitedSourceReader;</highlight></codeline>
<codeline lineno="29"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.flink.api.connector.source.util.ratelimit.RateLimiter;</highlight></codeline>
<codeline lineno="30"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.flink.api.connector.source.util.ratelimit.RateLimiterStrategy;</highlight></codeline>
<codeline lineno="31"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.flink.core.io.SimpleVersionedSerializer;</highlight></codeline>
<codeline lineno="32"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.flink.core.memory.DataInputDeserializer;</highlight></codeline>
<codeline lineno="33"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.flink.core.memory.DataOutputSerializer;</highlight></codeline>
<codeline lineno="34"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1DataOperations" kindref="compound">DataOperations</ref>;</highlight></codeline>
<codeline lineno="35"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Snapshot" kindref="compound">Snapshot</ref>;</highlight></codeline>
<codeline lineno="36"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Table" kindref="compound">Table</ref>;</highlight></codeline>
<codeline lineno="37"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1flink" kindref="compound">flink</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1flink_1_1TableLoader" kindref="compound">TableLoader</ref>;</highlight></codeline>
<codeline lineno="38"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.relocated.com.google.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1common" kindref="compound">common</ref>.annotations.VisibleForTesting;</highlight></codeline>
<codeline lineno="39"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.relocated.com.google.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1common" kindref="compound">common</ref>.base.<ref refid="classorg_1_1apache_1_1iceberg_1_1relocated_1_1com_1_1google_1_1common_1_1base_1_1MoreObjects" kindref="compound">MoreObjects</ref>;</highlight></codeline>
<codeline lineno="40"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.relocated.com.google.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1common" kindref="compound">common</ref>.base.<ref refid="classorg_1_1apache_1_1iceberg_1_1relocated_1_1com_1_1google_1_1common_1_1base_1_1Preconditions" kindref="compound">Preconditions</ref>;</highlight></codeline>
<codeline lineno="41"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.slf4j.Logger;</highlight></codeline>
<codeline lineno="42"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.slf4j.LoggerFactory;</highlight></codeline>
<codeline lineno="43"><highlight class="normal"></highlight></codeline>
<codeline lineno="45"><highlight class="normal">@Internal</highlight></codeline>
<codeline lineno="46" refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource" kindref="compound">MonitorSource</ref><sp/></highlight><highlight class="keyword">extends</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1SingleThreadedIteratorSource" kindref="compound">SingleThreadedIteratorSource</ref>&lt;TableChange&gt;<sp/>{</highlight></codeline>
<codeline lineno="47" refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1a9925be85f74058e6fc9a1a235c7c4bc2" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/>Logger<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1a9925be85f74058e6fc9a1a235c7c4bc2" kindref="member">LOG</ref><sp/>=<sp/>LoggerFactory.getLogger(<ref refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource" kindref="compound">MonitorSource</ref>.class);</highlight></codeline>
<codeline lineno="48"><highlight class="normal"></highlight></codeline>
<codeline lineno="49" refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1a396d1b1fbf12992cf8e4e2b183bcefd9" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1flink_1_1TableLoader" kindref="compound">TableLoader</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1a396d1b1fbf12992cf8e4e2b183bcefd9" kindref="member">tableLoader</ref>;</highlight></codeline>
<codeline lineno="50" refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1ac4b607caaa9c0f1a9285114c26c48315" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/>RateLimiterStrategy<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1ac4b607caaa9c0f1a9285114c26c48315" kindref="member">rateLimiterStrategy</ref>;</highlight></codeline>
<codeline lineno="51" refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1a0872bbb8f704b34bb4e039607d3bff59" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1a0872bbb8f704b34bb4e039607d3bff59" kindref="member">maxReadBack</ref>;</highlight></codeline>
<codeline lineno="52"><highlight class="normal"></highlight></codeline>
<codeline lineno="61" refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1ac912b00987325e10e31830741780b662" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1ac912b00987325e10e31830741780b662" kindref="member">MonitorSource</ref>(</highlight></codeline>
<codeline lineno="62"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1flink_1_1TableLoader" kindref="compound">TableLoader</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1a396d1b1fbf12992cf8e4e2b183bcefd9" kindref="member">tableLoader</ref>,<sp/>RateLimiterStrategy<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1ac4b607caaa9c0f1a9285114c26c48315" kindref="member">rateLimiterStrategy</ref>,<sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1a0872bbb8f704b34bb4e039607d3bff59" kindref="member">maxReadBack</ref>)<sp/>{</highlight></codeline>
<codeline lineno="63"><highlight class="normal"><sp/><sp/><sp/><sp/>Preconditions.checkNotNull(<ref refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1a396d1b1fbf12992cf8e4e2b183bcefd9" kindref="member">tableLoader</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Table<sp/>loader<sp/>should<sp/>no<sp/>be<sp/>null&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="64"><highlight class="normal"><sp/><sp/><sp/><sp/>Preconditions.checkNotNull(<ref refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1ac4b607caaa9c0f1a9285114c26c48315" kindref="member">rateLimiterStrategy</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Rate<sp/>limiter<sp/>strategy<sp/>should<sp/>no<sp/>be<sp/>null&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="65"><highlight class="normal"><sp/><sp/><sp/><sp/>Preconditions.checkArgument(<ref refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1a0872bbb8f704b34bb4e039607d3bff59" kindref="member">maxReadBack</ref><sp/>&gt;<sp/>0,<sp/></highlight><highlight class="stringliteral">&quot;Need<sp/>to<sp/>read<sp/>at<sp/>least<sp/>1<sp/>snapshot<sp/>to<sp/>work&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="66"><highlight class="normal"></highlight></codeline>
<codeline lineno="67"><highlight class="normal"><sp/><sp/><sp/><sp/>this.tableLoader<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1a396d1b1fbf12992cf8e4e2b183bcefd9" kindref="member">tableLoader</ref>;</highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/><sp/><sp/>this.rateLimiterStrategy<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1ac4b607caaa9c0f1a9285114c26c48315" kindref="member">rateLimiterStrategy</ref>;</highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/><sp/><sp/>this.maxReadBack<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1a0872bbb8f704b34bb4e039607d3bff59" kindref="member">maxReadBack</ref>;</highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="71"><highlight class="normal"></highlight></codeline>
<codeline lineno="72"><highlight class="normal"><sp/><sp/>@Override</highlight></codeline>
<codeline lineno="73" refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1afe634a476be6106dd38064da04553967" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>Boundedness<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1afe634a476be6106dd38064da04553967" kindref="member">getBoundedness</ref>()<sp/>{</highlight></codeline>
<codeline lineno="74"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>Boundedness.CONTINUOUS_UNBOUNDED;</highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="76"><highlight class="normal"></highlight></codeline>
<codeline lineno="77"><highlight class="normal"><sp/><sp/>@Override</highlight></codeline>
<codeline lineno="78" refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1a34730411bcac3adca08ba306a410a482" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>TypeInformation&lt;TableChange&gt;<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1a34730411bcac3adca08ba306a410a482" kindref="member">getProducedType</ref>()<sp/>{</highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>TypeInformation.of(TableChange.class);</highlight></codeline>
<codeline lineno="80"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="81"><highlight class="normal"></highlight></codeline>
<codeline lineno="82"><highlight class="normal"><sp/><sp/>@Override</highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/>Iterator&lt;TableChange&gt;<sp/>createIterator()<sp/>{</highlight></codeline>
<codeline lineno="84"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>TableChangeIterator(<ref refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1a396d1b1fbf12992cf8e4e2b183bcefd9" kindref="member">tableLoader</ref>,<sp/></highlight><highlight class="keyword">null</highlight><highlight class="normal">,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1a0872bbb8f704b34bb4e039607d3bff59" kindref="member">maxReadBack</ref>);</highlight></codeline>
<codeline lineno="85"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="86"><highlight class="normal"></highlight></codeline>
<codeline lineno="87"><highlight class="normal"><sp/><sp/>@Override</highlight></codeline>
<codeline lineno="88"><highlight class="normal"><sp/><sp/>SimpleVersionedSerializer&lt;Iterator&lt;TableChange&gt;&gt;<sp/>iteratorSerializer()<sp/>{</highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>TableChangeIteratorSerializer(<ref refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1a396d1b1fbf12992cf8e4e2b183bcefd9" kindref="member">tableLoader</ref>,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1a0872bbb8f704b34bb4e039607d3bff59" kindref="member">maxReadBack</ref>);</highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="91"><highlight class="normal"></highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/>@Override</highlight></codeline>
<codeline lineno="93" refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1a332531edcc222ce79dd1293ddf9c8bb9" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>SourceReader&lt;TableChange,<sp/>GlobalSplit&lt;TableChange&gt;&gt;<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1a332531edcc222ce79dd1293ddf9c8bb9" kindref="member">createReader</ref>(</highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>SourceReaderContext<sp/>readerContext)<sp/></highlight><highlight class="keywordflow">throws</highlight><highlight class="normal"><sp/>Exception<sp/>{</highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/><sp/><sp/>RateLimiter<sp/>rateLimiter<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1ac4b607caaa9c0f1a9285114c26c48315" kindref="member">rateLimiterStrategy</ref>.createRateLimiter(1);</highlight></codeline>
<codeline lineno="96"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>RateLimitedSourceReader&lt;&gt;(super.createReader(readerContext),<sp/>rateLimiter);</highlight></codeline>
<codeline lineno="97"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="98"><highlight class="normal"></highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/>@VisibleForTesting</highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal">TableChangeIterator<sp/></highlight><highlight class="keyword">implements</highlight><highlight class="normal"><sp/>Iterator&lt;TableChange&gt;<sp/>{</highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/>Long<sp/>lastSnapshotId;</highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1a0872bbb8f704b34bb4e039607d3bff59" kindref="member">maxReadBack</ref>;</highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Table" kindref="compound">Table</ref><sp/>table;</highlight></codeline>
<codeline lineno="105"><highlight class="normal"></highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/><sp/><sp/>TableChangeIterator(<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1flink_1_1TableLoader" kindref="compound">TableLoader</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1a396d1b1fbf12992cf8e4e2b183bcefd9" kindref="member">tableLoader</ref>,<sp/>Long<sp/>lastSnapshotId,<sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1a0872bbb8f704b34bb4e039607d3bff59" kindref="member">maxReadBack</ref>)<sp/>{</highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this.lastSnapshotId<sp/>=<sp/>lastSnapshotId;</highlight></codeline>
<codeline lineno="108"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this.maxReadBack<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1a0872bbb8f704b34bb4e039607d3bff59" kindref="member">maxReadBack</ref>;</highlight></codeline>
<codeline lineno="109"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1a396d1b1fbf12992cf8e4e2b183bcefd9" kindref="member">tableLoader</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1flink_1_1TableLoader_1ab670ee7ee0a850c9e28aef433ad637d9" kindref="member">open</ref>();</highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this.table<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1a396d1b1fbf12992cf8e4e2b183bcefd9" kindref="member">tableLoader</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1flink_1_1TableLoader_1aa2f427933d5c638323bc5fa698cbe109" kindref="member">loadTable</ref>();</highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="112"><highlight class="normal"></highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><sp/><sp/>@Override</highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">boolean</highlight><highlight class="normal"><sp/>hasNext()<sp/>{</highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="117"><highlight class="normal"></highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/>@Override</highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>TableChange<sp/>next()<sp/>{</highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>table.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Table_1aec4e667308c60dcf66b1ff8ddfe44783" kindref="member">refresh</ref>();</highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Snapshot" kindref="compound">Snapshot</ref><sp/>currentSnapshot<sp/>=<sp/>table.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Table_1a5c4df259908bf1a7e85b7264de73f943" kindref="member">currentSnapshot</ref>();</highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Long<sp/>current<sp/>=<sp/>currentSnapshot<sp/>!=<sp/></highlight><highlight class="keyword">null</highlight><highlight class="normal"><sp/>?<sp/>currentSnapshot.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Snapshot_1aad24e075e95dfc00842c2eea7081154a" kindref="member">snapshotId</ref>()<sp/>:<sp/></highlight><highlight class="keyword">null</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Long<sp/>checking<sp/>=<sp/>current;</highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TableChange<sp/></highlight><highlight class="keyword">event</highlight><highlight class="normal"><sp/>=<sp/>TableChange.empty();</highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>readBack<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(checking<sp/>!=<sp/></highlight><highlight class="keyword">null</highlight><highlight class="normal"><sp/>&amp;&amp;<sp/>!checking.equals(lastSnapshotId)<sp/>&amp;&amp;<sp/>++readBack<sp/>&lt;=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1a0872bbb8f704b34bb4e039607d3bff59" kindref="member">maxReadBack</ref>)<sp/>{</highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Snapshot" kindref="compound">Snapshot</ref><sp/>snapshot<sp/>=<sp/>table.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Table_1a7a9dd6d8d4967fe8aed041134b9140f7" kindref="member">snapshot</ref>(checking);</highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(snapshot<sp/>!=<sp/></highlight><highlight class="keyword">null</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="classorg_1_1apache_1_1iceberg_1_1DataOperations" kindref="compound">DataOperations</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1DataOperations_1ad83128eeb6561dd7db2e1cfbdd81bbad" kindref="member">REPLACE</ref>.equals(snapshot.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Snapshot_1a42c6d33eacf20dec9eb38501f46da7e5" kindref="member">operation</ref>()))<sp/>{</highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1a9925be85f74058e6fc9a1a235c7c4bc2" kindref="member">LOG</ref>.debug(</highlight><highlight class="stringliteral">&quot;Reading<sp/>snapshot<sp/>{}&quot;</highlight><highlight class="normal">,<sp/>snapshot.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Snapshot_1aad24e075e95dfc00842c2eea7081154a" kindref="member">snapshotId</ref>());</highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">event</highlight><highlight class="normal">.merge(</highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>TableChange(snapshot,<sp/>table.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Table_1aae6b533eb4c5f1d348a092dfce3c789b" kindref="member">io</ref>()));</highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1a9925be85f74058e6fc9a1a235c7c4bc2" kindref="member">LOG</ref>.debug(</highlight><highlight class="stringliteral">&quot;Skipping<sp/>replace<sp/>snapshot<sp/>{}&quot;</highlight><highlight class="normal">,<sp/>snapshot.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Snapshot_1aad24e075e95dfc00842c2eea7081154a" kindref="member">snapshotId</ref>());</highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="136"><highlight class="normal"></highlight></codeline>
<codeline lineno="137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>checking<sp/>=<sp/>snapshot.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Snapshot_1acd3a6b3df8d7040aa0a502e425c2a523" kindref="member">parentId</ref>();</highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>If<sp/>the<sp/>last<sp/>snapshot<sp/>has<sp/>been<sp/>removed<sp/>from<sp/>the<sp/>history</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>checking<sp/>=<sp/></highlight><highlight class="keyword">null</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="143"><highlight class="normal"></highlight></codeline>
<codeline lineno="144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>lastSnapshotId<sp/>=<sp/>current;</highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>event;</highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">catch</highlight><highlight class="normal"><sp/>(Exception<sp/>e)<sp/>{</highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1a9925be85f74058e6fc9a1a235c7c4bc2" kindref="member">LOG</ref>.warn(</highlight><highlight class="stringliteral">&quot;Failed<sp/>to<sp/>fetch<sp/>table<sp/>changes<sp/>for<sp/>{}&quot;</highlight><highlight class="normal">,<sp/>table,<sp/>e);</highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>TableChange.empty();</highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="151"><highlight class="normal"></highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/>@Override</highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>String<sp/>toString()<sp/>{</highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>MoreObjects.toStringHelper(</highlight><highlight class="keyword">this</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.add(</highlight><highlight class="stringliteral">&quot;lastSnapshotId&quot;</highlight><highlight class="normal">,<sp/>lastSnapshotId)</highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.add(</highlight><highlight class="stringliteral">&quot;maxReadBack&quot;</highlight><highlight class="normal">,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1a0872bbb8f704b34bb4e039607d3bff59" kindref="member">maxReadBack</ref>)</highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.add(</highlight><highlight class="stringliteral">&quot;table&quot;</highlight><highlight class="normal">,<sp/>table)</highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.toString();</highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="161"><highlight class="normal"></highlight></codeline>
<codeline lineno="162" refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1_1TableChangeIteratorSerializer" refkind="compound"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1_1TableChangeIteratorSerializer" kindref="compound">TableChangeIteratorSerializer</ref></highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">implements</highlight><highlight class="normal"><sp/>SimpleVersionedSerializer&lt;Iterator&lt;TableChange&gt;&gt;<sp/>{</highlight></codeline>
<codeline lineno="164"><highlight class="normal"></highlight></codeline>
<codeline lineno="165" refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1_1TableChangeIteratorSerializer_1a959285d99448f7741737ad7276114702" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1_1TableChangeIteratorSerializer_1a959285d99448f7741737ad7276114702" kindref="member">CURRENT_VERSION</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="166" refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1_1TableChangeIteratorSerializer_1a962995fda08edee43690dda19152405a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1flink_1_1TableLoader" kindref="compound">TableLoader</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1_1TableChangeIteratorSerializer_1a962995fda08edee43690dda19152405a" kindref="member">tableLoader</ref>;</highlight></codeline>
<codeline lineno="167" refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1_1TableChangeIteratorSerializer_1a8cc3080453c36281abe2ee23c690b87a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1_1TableChangeIteratorSerializer_1a8cc3080453c36281abe2ee23c690b87a" kindref="member">maxReadBack</ref>;</highlight></codeline>
<codeline lineno="168"><highlight class="normal"></highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1_1TableChangeIteratorSerializer" kindref="compound">TableChangeIteratorSerializer</ref>(<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1flink_1_1TableLoader" kindref="compound">TableLoader</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1_1TableChangeIteratorSerializer_1a962995fda08edee43690dda19152405a" kindref="member">tableLoader</ref>,<sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1_1TableChangeIteratorSerializer_1a8cc3080453c36281abe2ee23c690b87a" kindref="member">maxReadBack</ref>)<sp/>{</highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this.tableLoader<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1_1TableChangeIteratorSerializer_1a962995fda08edee43690dda19152405a" kindref="member">tableLoader</ref>;</highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this.maxReadBack<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1_1TableChangeIteratorSerializer_1a8cc3080453c36281abe2ee23c690b87a" kindref="member">maxReadBack</ref>;</highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="173"><highlight class="normal"></highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/>@Override</highlight></codeline>
<codeline lineno="175" refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1_1TableChangeIteratorSerializer_1a259c3820bc4d0beeeb2040a62a736cfc" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1_1TableChangeIteratorSerializer_1a259c3820bc4d0beeeb2040a62a736cfc" kindref="member">getVersion</ref>()<sp/>{</highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1_1TableChangeIteratorSerializer_1a959285d99448f7741737ad7276114702" kindref="member">CURRENT_VERSION</ref>;</highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="178"><highlight class="normal"></highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/>@Override</highlight></codeline>
<codeline lineno="180" refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1_1TableChangeIteratorSerializer_1adb137fe5241df8cedcd1c45a3dc62038" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">byte</highlight><highlight class="normal">[]<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1_1TableChangeIteratorSerializer_1adb137fe5241df8cedcd1c45a3dc62038" kindref="member">serialize</ref>(Iterator&lt;TableChange&gt;<sp/>iterator)<sp/></highlight><highlight class="keywordflow">throws</highlight><highlight class="normal"><sp/>IOException<sp/>{</highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Preconditions.checkArgument(</highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>iterator<sp/>instanceof<sp/>TableChangeIterator,</highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Use<sp/>TableChangeIterator<sp/>iterator.<sp/>Found<sp/>incompatible<sp/>type:<sp/>%s&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>iterator.getClass());</highlight></codeline>
<codeline lineno="185"><highlight class="normal"></highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>TableChangeIterator<sp/>tableChangeIterator<sp/>=<sp/>(TableChangeIterator)<sp/>iterator;</highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>DataOutputSerializer<sp/>out<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>DataOutputSerializer(8);</highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>toStore<sp/>=</highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tableChangeIterator.lastSnapshotId<sp/>!=<sp/></highlight><highlight class="keyword">null</highlight><highlight class="normal"><sp/>?<sp/>tableChangeIterator.lastSnapshotId<sp/>:<sp/>-1L;</highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>out.writeLong(toStore);</highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>out.getCopyOfBuffer();</highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="193"><highlight class="normal"></highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/><sp/><sp/>@Override</highlight></codeline>
<codeline lineno="195" refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1_1TableChangeIteratorSerializer_1af7743d7d057c2916342c25bda8887359" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>TableChangeIterator<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1_1TableChangeIteratorSerializer_1af7743d7d057c2916342c25bda8887359" kindref="member">deserialize</ref>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>version,<sp/></highlight><highlight class="keywordtype">byte</highlight><highlight class="normal">[]<sp/>serialized)<sp/></highlight><highlight class="keywordflow">throws</highlight><highlight class="normal"><sp/>IOException<sp/>{</highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(version<sp/>==<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1_1TableChangeIteratorSerializer_1a959285d99448f7741737ad7276114702" kindref="member">CURRENT_VERSION</ref>)<sp/>{</highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DataInputDeserializer<sp/>in<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>DataInputDeserializer(serialized);</highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>fromStore<sp/>=<sp/>in.readLong();</highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>TableChangeIterator(</highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1_1TableChangeIteratorSerializer_1a962995fda08edee43690dda19152405a" kindref="member">tableLoader</ref>,<sp/>fromStore<sp/>!=<sp/>-1<sp/>?<sp/>fromStore<sp/>:<sp/></highlight><highlight class="keyword">null</highlight><highlight class="normal">,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1flink_1_1maintenance_1_1operator_1_1MonitorSource_1_1TableChangeIteratorSerializer_1a8cc3080453c36281abe2ee23c690b87a" kindref="member">maxReadBack</ref>);</highlight></codeline>
<codeline lineno="201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>IOException(</highlight><highlight class="stringliteral">&quot;Unrecognized<sp/>version<sp/>or<sp/>corrupt<sp/>state:<sp/>&quot;</highlight><highlight class="normal"><sp/>+<sp/>version);</highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="206"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="flink/v1.19/flink/src/main/java/org/apache/iceberg/flink/maintenance/operator/MonitorSource.java"/>
  </compounddef>
</doxygen>
