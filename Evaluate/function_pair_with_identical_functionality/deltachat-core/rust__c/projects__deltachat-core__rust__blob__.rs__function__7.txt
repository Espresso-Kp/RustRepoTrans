<path>
projects/deltachat-core/rust/blob.rs
</path>
<function>
    pub fn to_abs_path(&self) -> PathBuf {
        let fname = Path::new(&self.name).strip_prefix("$BLOBDIR/").unwrap();
        self.blobdir.join(fname)
    }
</function>
------

<path>
projects/deltachat-core/c/dc_tools.c
</path>
<function>
char* dc_get_abs_path(dc_context_t* context, const char* pathNfilename)
{
	int   success           = 0;
	char* pathNfilename_abs = NULL;

	if (context==NULL || pathNfilename==NULL) {
		goto cleanup;
	}

	pathNfilename_abs = dc_strdup(pathNfilename);

	if (strncmp(pathNfilename_abs, "$BLOBDIR", 8)==0) {
		if (context->blobdir==NULL) {
			goto cleanup;
		}
		dc_str_replace(&pathNfilename_abs, "$BLOBDIR", context->blobdir);
	}

	success = 1;

cleanup:
	if (!success) {
		free(pathNfilename_abs);
		pathNfilename_abs = NULL;
	}
	return pathNfilename_abs;
}
</function>
