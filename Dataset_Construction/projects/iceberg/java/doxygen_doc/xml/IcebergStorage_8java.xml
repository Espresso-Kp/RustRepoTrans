<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.17">
  <compounddef id="IcebergStorage_8java" kind="file" language="Java">
    <compoundname>IcebergStorage.java</compoundname>
    <innerclass refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage" prot="public">org::apache::iceberg::pig::IcebergStorage</innerclass>
    <innernamespace refid="namespaceorg_1_1apache_1_1iceberg_1_1pig">org::apache::iceberg::pig</innernamespace>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">/*</highlight></codeline>
<codeline lineno="2"><highlight class="comment"><sp/>*<sp/>Licensed<sp/>to<sp/>the<sp/>Apache<sp/>Software<sp/>Foundation<sp/>(ASF)<sp/>under<sp/>one</highlight></codeline>
<codeline lineno="3"><highlight class="comment"><sp/>*<sp/>or<sp/>more<sp/>contributor<sp/>license<sp/>agreements.<sp/><sp/>See<sp/>the<sp/>NOTICE<sp/>file</highlight></codeline>
<codeline lineno="4"><highlight class="comment"><sp/>*<sp/>distributed<sp/>with<sp/>this<sp/>work<sp/>for<sp/>additional<sp/>information</highlight></codeline>
<codeline lineno="5"><highlight class="comment"><sp/>*<sp/>regarding<sp/>copyright<sp/>ownership.<sp/><sp/>The<sp/>ASF<sp/>licenses<sp/>this<sp/>file</highlight></codeline>
<codeline lineno="6"><highlight class="comment"><sp/>*<sp/>to<sp/>you<sp/>under<sp/>the<sp/>Apache<sp/>License,<sp/>Version<sp/>2.0<sp/>(the</highlight></codeline>
<codeline lineno="7"><highlight class="comment"><sp/>*<sp/>&quot;License&quot;);<sp/>you<sp/>may<sp/>not<sp/>use<sp/>this<sp/>file<sp/>except<sp/>in<sp/>compliance</highlight></codeline>
<codeline lineno="8"><highlight class="comment"><sp/>*<sp/>with<sp/>the<sp/>License.<sp/><sp/>You<sp/>may<sp/>obtain<sp/>a<sp/>copy<sp/>of<sp/>the<sp/>License<sp/>at</highlight></codeline>
<codeline lineno="9"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="10"><highlight class="comment"><sp/>*<sp/><sp/><sp/>http://www.apache.org/licenses/LICENSE-2.0</highlight></codeline>
<codeline lineno="11"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="12"><highlight class="comment"><sp/>*<sp/>Unless<sp/>required<sp/>by<sp/>applicable<sp/>law<sp/>or<sp/>agreed<sp/>to<sp/>in<sp/>writing,</highlight></codeline>
<codeline lineno="13"><highlight class="comment"><sp/>*<sp/>software<sp/>distributed<sp/>under<sp/>the<sp/>License<sp/>is<sp/>distributed<sp/>on<sp/>an</highlight></codeline>
<codeline lineno="14"><highlight class="comment"><sp/>*<sp/>&quot;AS<sp/>IS&quot;<sp/>BASIS,<sp/>WITHOUT<sp/>WARRANTIES<sp/>OR<sp/>CONDITIONS<sp/>OF<sp/>ANY</highlight></codeline>
<codeline lineno="15"><highlight class="comment"><sp/>*<sp/>KIND,<sp/>either<sp/>express<sp/>or<sp/>implied.<sp/><sp/>See<sp/>the<sp/>License<sp/>for<sp/>the</highlight></codeline>
<codeline lineno="16"><highlight class="comment"><sp/>*<sp/>specific<sp/>language<sp/>governing<sp/>permissions<sp/>and<sp/>limitations</highlight></codeline>
<codeline lineno="17"><highlight class="comment"><sp/>*<sp/>under<sp/>the<sp/>License.</highlight></codeline>
<codeline lineno="18"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="19"><highlight class="normal"></highlight><highlight class="keyword">package<sp/></highlight><highlight class="normal">org.apache.iceberg.pig;</highlight></codeline>
<codeline lineno="20"><highlight class="normal"></highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>java.io.IOException;</highlight></codeline>
<codeline lineno="22"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>java.io.Serializable;</highlight></codeline>
<codeline lineno="23"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>java.util.Collections;</highlight></codeline>
<codeline lineno="24"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>java.util.List;</highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>java.util.Map;</highlight></codeline>
<codeline lineno="26"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>java.util.Properties;</highlight></codeline>
<codeline lineno="27"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>java.util.stream.Collectors;</highlight></codeline>
<codeline lineno="28"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1hadoop" kindref="compound">hadoop</ref>.conf.Configuration;</highlight></codeline>
<codeline lineno="29"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1hadoop" kindref="compound">hadoop</ref>.fs.Path;</highlight></codeline>
<codeline lineno="30"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1hadoop" kindref="compound">hadoop</ref>.mapreduce.InputFormat;</highlight></codeline>
<codeline lineno="31"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1hadoop" kindref="compound">hadoop</ref>.mapreduce.Job;</highlight></codeline>
<codeline lineno="32"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1hadoop" kindref="compound">hadoop</ref>.mapreduce.RecordReader;</highlight></codeline>
<codeline lineno="33"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1hadoop" kindref="compound">hadoop</ref>.util.ReflectionUtils;</highlight></codeline>
<codeline lineno="34"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1Schema" kindref="compound">Schema</ref>;</highlight></codeline>
<codeline lineno="35"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Table" kindref="compound">Table</ref>;</highlight></codeline>
<codeline lineno="36"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Tables" kindref="compound">Tables</ref>;</highlight></codeline>
<codeline lineno="37"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1expressions" kindref="compound">expressions</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1Expressions" kindref="compound">Expressions</ref>;</highlight></codeline>
<codeline lineno="38"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1hadoop" kindref="compound">hadoop</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1hadoop_1_1HadoopTables" kindref="compound">HadoopTables</ref>;</highlight></codeline>
<codeline lineno="39"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1pig" kindref="compound">pig</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergPigInputFormat" kindref="compound">IcebergPigInputFormat</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergPigInputFormat_1_1IcebergRecordReader" kindref="compound">IcebergRecordReader</ref>;</highlight></codeline>
<codeline lineno="40"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.relocated.com.google.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1common" kindref="compound">common</ref>.collect.ImmutableList;</highlight></codeline>
<codeline lineno="41"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.relocated.com.google.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1common" kindref="compound">common</ref>.collect.Lists;</highlight></codeline>
<codeline lineno="42"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.relocated.com.google.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1common" kindref="compound">common</ref>.collect.<ref refid="classorg_1_1apache_1_1iceberg_1_1relocated_1_1com_1_1google_1_1common_1_1collect_1_1Maps" kindref="compound">Maps</ref>;</highlight></codeline>
<codeline lineno="43"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1types" kindref="compound">types</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1types_1_1Types" kindref="compound">Types</ref>;</highlight></codeline>
<codeline lineno="44"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1util" kindref="compound">util</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1util_1_1NaNUtil" kindref="compound">NaNUtil</ref>;</highlight></codeline>
<codeline lineno="45"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.pig.Expression;</highlight></codeline>
<codeline lineno="46"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.pig.Expression.BetweenExpression;</highlight></codeline>
<codeline lineno="47"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.pig.Expression.BinaryExpression;</highlight></codeline>
<codeline lineno="48"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.pig.Expression.Column;</highlight></codeline>
<codeline lineno="49"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.pig.Expression.Const;</highlight></codeline>
<codeline lineno="50"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.pig.Expression.InExpression;</highlight></codeline>
<codeline lineno="51"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.pig.Expression.OpType;</highlight></codeline>
<codeline lineno="52"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.pig.Expression.UnaryExpression;</highlight></codeline>
<codeline lineno="53"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.pig.LoadFunc;</highlight></codeline>
<codeline lineno="54"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.pig.LoadMetadata;</highlight></codeline>
<codeline lineno="55"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.pig.LoadPredicatePushdown;</highlight></codeline>
<codeline lineno="56"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.pig.LoadPushDown;</highlight></codeline>
<codeline lineno="57"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.pig.ResourceSchema;</highlight></codeline>
<codeline lineno="58"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.pig.ResourceStatistics;</highlight></codeline>
<codeline lineno="59"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.pig.backend.<ref refid="namespaceorg_1_1apache_1_1hadoop" kindref="compound">hadoop</ref>.executionengine.mapReduceLayer.PigSplit;</highlight></codeline>
<codeline lineno="60"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.pig.data.Tuple;</highlight></codeline>
<codeline lineno="61"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.pig.impl.logicalLayer.FrontendException;</highlight></codeline>
<codeline lineno="62"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.pig.impl.util.ObjectSerializer;</highlight></codeline>
<codeline lineno="63"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.pig.impl.util.UDFContext;</highlight></codeline>
<codeline lineno="64"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.slf4j.Logger;</highlight></codeline>
<codeline lineno="65"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.slf4j.LoggerFactory;</highlight></codeline>
<codeline lineno="66"><highlight class="normal"></highlight></codeline>
<codeline lineno="67" refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage" kindref="compound">IcebergStorage</ref><sp/></highlight><highlight class="keyword">extends</highlight><highlight class="normal"><sp/>LoadFunc</highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/><sp/><sp/>implements<sp/>LoadMetadata,<sp/>LoadPredicatePushdown,<sp/>LoadPushDown<sp/>{</highlight></codeline>
<codeline lineno="69" refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1ab1661113ec43d43819cd8e0b9c1ed7b0" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/>Logger<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1ab1661113ec43d43819cd8e0b9c1ed7b0" kindref="member">LOG</ref><sp/>=<sp/>LoggerFactory.getLogger(<ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage" kindref="compound">IcebergStorage</ref>.class);</highlight></codeline>
<codeline lineno="70"><highlight class="normal"></highlight></codeline>
<codeline lineno="71" refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1af00868a2f8d6a73e66c67ab161a70636" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/>String<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1af00868a2f8d6a73e66c67ab161a70636" kindref="member">PIG_ICEBERG_TABLES_IMPL</ref><sp/>=<sp/></highlight><highlight class="stringliteral">&quot;pig.iceberg.tables.impl&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="72" refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a7fb383533387c561a6ddc48d05717011" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Tables" kindref="compound">Tables</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a7fb383533387c561a6ddc48d05717011" kindref="member">iceberg</ref>;</highlight></codeline>
<codeline lineno="73" refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a05dc7177f076721dacd0df0c54080c8b" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>Map&lt;String,<sp/>Table&gt;<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a05dc7177f076721dacd0df0c54080c8b" kindref="member">tables</ref><sp/>=<sp/>Maps.newConcurrentMap();</highlight></codeline>
<codeline lineno="74" refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a12ae4e84e8d1c93ae80b7d3f540bac37" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>Map&lt;String,<sp/>String&gt;<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a12ae4e84e8d1c93ae80b7d3f540bac37" kindref="member">locations</ref><sp/>=<sp/>Maps.newConcurrentMap();</highlight></codeline>
<codeline lineno="75"><highlight class="normal"></highlight></codeline>
<codeline lineno="76" refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a9ce62b1c3dc655963c557545d65015ee" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/>String<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a9ce62b1c3dc655963c557545d65015ee" kindref="member">signature</ref>;</highlight></codeline>
<codeline lineno="77"><highlight class="normal"></highlight></codeline>
<codeline lineno="78" refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a7cad6eb1315d80ea41c6827a2c183fe4" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergPigInputFormat_1_1IcebergRecordReader" kindref="compound">IcebergRecordReader</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a7cad6eb1315d80ea41c6827a2c183fe4" kindref="member">reader</ref>;</highlight></codeline>
<codeline lineno="79"><highlight class="normal"></highlight></codeline>
<codeline lineno="80"><highlight class="normal"><sp/><sp/>@Override</highlight></codeline>
<codeline lineno="81" refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1aab7f6d8a2eb75a7ee4b7f6c487e07a48" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1aab7f6d8a2eb75a7ee4b7f6c487e07a48" kindref="member">setLocation</ref>(String<sp/>location,<sp/>Job<sp/>job)<sp/>{</highlight></codeline>
<codeline lineno="82"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1ab1661113ec43d43819cd8e0b9c1ed7b0" kindref="member">LOG</ref>.info(</highlight><highlight class="stringliteral">&quot;[{}]:<sp/>setLocation()<sp/>-&gt;<sp/>{}&quot;</highlight><highlight class="normal">,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a9ce62b1c3dc655963c557545d65015ee" kindref="member">signature</ref>,<sp/>location);</highlight></codeline>
<codeline lineno="83"><highlight class="normal"></highlight></codeline>
<codeline lineno="84"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a12ae4e84e8d1c93ae80b7d3f540bac37" kindref="member">locations</ref>.put(<ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a9ce62b1c3dc655963c557545d65015ee" kindref="member">signature</ref>,<sp/>location);</highlight></codeline>
<codeline lineno="85"><highlight class="normal"></highlight></codeline>
<codeline lineno="86"><highlight class="normal"><sp/><sp/><sp/><sp/>Configuration<sp/>conf<sp/>=<sp/>job.getConfiguration();</highlight></codeline>
<codeline lineno="87"><highlight class="normal"></highlight></codeline>
<codeline lineno="88"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1ae1feb5c75fafe922e9f8437f77c25d58" kindref="member">copyUDFContextToScopedConfiguration</ref>(conf,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergPigInputFormat" kindref="compound">IcebergPigInputFormat</ref>.ICEBERG_SCHEMA);</highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1ae1feb5c75fafe922e9f8437f77c25d58" kindref="member">copyUDFContextToScopedConfiguration</ref>(conf,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergPigInputFormat" kindref="compound">IcebergPigInputFormat</ref>.ICEBERG_PROJECTED_FIELDS);</highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1ae1feb5c75fafe922e9f8437f77c25d58" kindref="member">copyUDFContextToScopedConfiguration</ref>(conf,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergPigInputFormat" kindref="compound">IcebergPigInputFormat</ref>.ICEBERG_FILTER_EXPRESSION);</highlight></codeline>
<codeline lineno="91"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="92"><highlight class="normal"></highlight></codeline>
<codeline lineno="93"><highlight class="normal"><sp/><sp/>@Override</highlight></codeline>
<codeline lineno="94" refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a4da37a039dd90f11debfb2c95363b5bd" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>InputFormat<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a4da37a039dd90f11debfb2c95363b5bd" kindref="member">getInputFormat</ref>()<sp/>{</highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1ab1661113ec43d43819cd8e0b9c1ed7b0" kindref="member">LOG</ref>.info(</highlight><highlight class="stringliteral">&quot;[{}]:<sp/>getInputFormat()&quot;</highlight><highlight class="normal">,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a9ce62b1c3dc655963c557545d65015ee" kindref="member">signature</ref>);</highlight></codeline>
<codeline lineno="96"><highlight class="normal"><sp/><sp/><sp/><sp/>String<sp/>location<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a12ae4e84e8d1c93ae80b7d3f540bac37" kindref="member">locations</ref>.get(<ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a9ce62b1c3dc655963c557545d65015ee" kindref="member">signature</ref>);</highlight></codeline>
<codeline lineno="97"><highlight class="normal"></highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergPigInputFormat" kindref="compound">IcebergPigInputFormat</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a05dc7177f076721dacd0df0c54080c8b" kindref="member">tables</ref>.get(location),<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a9ce62b1c3dc655963c557545d65015ee" kindref="member">signature</ref>);</highlight></codeline>
<codeline lineno="99"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="100"><highlight class="normal"></highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/>@Override</highlight></codeline>
<codeline lineno="102" refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1af717b0a6329b4db259eb718efbcda26e" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>Tuple<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1af717b0a6329b4db259eb718efbcda26e" kindref="member">getNext</ref>()<sp/>throws<sp/>IOException<sp/>{</highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a7cad6eb1315d80ea41c6827a2c183fe4" kindref="member">reader</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergPigInputFormat_1_1IcebergRecordReader_1a6df66495afabaafe85522aee441dbef6" kindref="member">nextKeyValue</ref>())<sp/>{</highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">null</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="106"><highlight class="normal"></highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(Tuple)<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a7cad6eb1315d80ea41c6827a2c183fe4" kindref="member">reader</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergPigInputFormat_1_1IcebergRecordReader_1a79424aa606b71e4ccac2f40a9ec79000" kindref="member">getCurrentValue</ref>();</highlight></codeline>
<codeline lineno="108"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="109"><highlight class="normal"></highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/>@Override</highlight></codeline>
<codeline lineno="111" refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1aa75fe4c96dc9db3af2bdd9554a0f41dd" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1aa75fe4c96dc9db3af2bdd9554a0f41dd" kindref="member">prepareToRead</ref>(RecordReader<sp/>newReader,<sp/>PigSplit<sp/>split)<sp/>{</highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1ab1661113ec43d43819cd8e0b9c1ed7b0" kindref="member">LOG</ref>.info(</highlight><highlight class="stringliteral">&quot;[{}]:<sp/>prepareToRead()<sp/>-&gt;<sp/>{}&quot;</highlight><highlight class="normal">,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a9ce62b1c3dc655963c557545d65015ee" kindref="member">signature</ref>,<sp/>split);</highlight></codeline>
<codeline lineno="113"><highlight class="normal"></highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/>this.reader<sp/>=<sp/>(<ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergPigInputFormat_1_1IcebergRecordReader" kindref="compound">IcebergRecordReader</ref>)<sp/>newReader;</highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="116"><highlight class="normal"></highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/>@Override</highlight></codeline>
<codeline lineno="118" refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a914edf7def3195e7c81e6e17ffcffc92" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>ResourceSchema<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a914edf7def3195e7c81e6e17ffcffc92" kindref="member">getSchema</ref>(String<sp/>location,<sp/>Job<sp/>job)<sp/></highlight><highlight class="keywordflow">throws</highlight><highlight class="normal"><sp/>IOException<sp/>{</highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1ab1661113ec43d43819cd8e0b9c1ed7b0" kindref="member">LOG</ref>.info(</highlight><highlight class="stringliteral">&quot;[{}]:<sp/>getSchema()<sp/>-&gt;<sp/>{}&quot;</highlight><highlight class="normal">,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a9ce62b1c3dc655963c557545d65015ee" kindref="member">signature</ref>,<sp/>location);</highlight></codeline>
<codeline lineno="120"><highlight class="normal"></highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1Schema" kindref="compound">Schema</ref><sp/>schema<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a5437340e04099e9f22bbad698384fd81" kindref="member">load</ref>(location,<sp/>job).<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Table_1a1e7f6c302ab9df95642c549195732a09" kindref="member">schema</ref>();</highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1ad34c42f76c7cbfa11d9c371d8a2be13a" kindref="member">storeInUDFContext</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergPigInputFormat" kindref="compound">IcebergPigInputFormat</ref>.ICEBERG_SCHEMA,<sp/>schema);</highlight></codeline>
<codeline lineno="123"><highlight class="normal"></highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1SchemaUtil" kindref="compound">SchemaUtil</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1SchemaUtil_1ac73223efcfd3c44f8c2d8ab3a7c7b5ac" kindref="member">convert</ref>(schema);</highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="126"><highlight class="normal"></highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/>@Override</highlight></codeline>
<codeline lineno="128" refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a5b4bec273b3e439ba0546a1e72934fe6" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>ResourceStatistics<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a5b4bec273b3e439ba0546a1e72934fe6" kindref="member">getStatistics</ref>(String<sp/>location,<sp/>Job<sp/>job)<sp/>{</highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1ab1661113ec43d43819cd8e0b9c1ed7b0" kindref="member">LOG</ref>.info(</highlight><highlight class="stringliteral">&quot;[{}]:<sp/>getStatistics()<sp/>-&gt;<sp/>:<sp/>{}&quot;</highlight><highlight class="normal">,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a9ce62b1c3dc655963c557545d65015ee" kindref="member">signature</ref>,<sp/>location);</highlight></codeline>
<codeline lineno="130"><highlight class="normal"></highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">null</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="133"><highlight class="normal"></highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/>@Override</highlight></codeline>
<codeline lineno="135" refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a33291b2410fac1ff9797c02842a6a325" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>String[]<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a33291b2410fac1ff9797c02842a6a325" kindref="member">getPartitionKeys</ref>(String<sp/>location,<sp/>Job<sp/>job)<sp/>{</highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1ab1661113ec43d43819cd8e0b9c1ed7b0" kindref="member">LOG</ref>.info(</highlight><highlight class="stringliteral">&quot;[{}]:<sp/>getPartitionKeys()&quot;</highlight><highlight class="normal">,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a9ce62b1c3dc655963c557545d65015ee" kindref="member">signature</ref>);</highlight></codeline>
<codeline lineno="137"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>String[0];</highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="139"><highlight class="normal"></highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/>@Override</highlight></codeline>
<codeline lineno="141" refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a8df4333f7cac3d6719b4fdb799017d94" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a8df4333f7cac3d6719b4fdb799017d94" kindref="member">setPartitionFilter</ref>(<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1expressions_1_1Expression" kindref="compound">Expression</ref><sp/>partitionFilter)<sp/>{</highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1ab1661113ec43d43819cd8e0b9c1ed7b0" kindref="member">LOG</ref>.info(</highlight><highlight class="stringliteral">&quot;[{}]:<sp/>setPartitionFilter()<sp/>-&gt;<sp/>{}&quot;</highlight><highlight class="normal">,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a9ce62b1c3dc655963c557545d65015ee" kindref="member">signature</ref>,<sp/>partitionFilter);</highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="144"><highlight class="normal"></highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/>@Override</highlight></codeline>
<codeline lineno="146" refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a6b1afdd150969cd0e5b3b6880ebbfdb9" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>List&lt;String&gt;<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a6b1afdd150969cd0e5b3b6880ebbfdb9" kindref="member">getPredicateFields</ref>(String<sp/>location,<sp/>Job<sp/>job)<sp/></highlight><highlight class="keywordflow">throws</highlight><highlight class="normal"><sp/>IOException<sp/>{</highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1ab1661113ec43d43819cd8e0b9c1ed7b0" kindref="member">LOG</ref>.info(</highlight><highlight class="stringliteral">&quot;[{}]:<sp/>getPredicateFields()<sp/>-&gt;<sp/>{}&quot;</highlight><highlight class="normal">,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a9ce62b1c3dc655963c557545d65015ee" kindref="member">signature</ref>,<sp/>location);</highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1Schema" kindref="compound">Schema</ref><sp/>schema<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a5437340e04099e9f22bbad698384fd81" kindref="member">load</ref>(location,<sp/>job).<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Table_1a1e7f6c302ab9df95642c549195732a09" kindref="member">schema</ref>();</highlight></codeline>
<codeline lineno="149"><highlight class="normal"></highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/>List&lt;String&gt;<sp/>result<sp/>=<sp/>Lists.newArrayList();</highlight></codeline>
<codeline lineno="151"><highlight class="normal"></highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(<ref refid="classorg_1_1apache_1_1iceberg_1_1types_1_1Types" kindref="compound">Types</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1types_1_1Types_1_1NestedField" kindref="compound">NestedField</ref><sp/>nf<sp/>:<sp/>schema.<ref refid="classorg_1_1apache_1_1iceberg_1_1Schema_1a503ecd80a74c35c4b05435bb6afc9415" kindref="member">columns</ref>())<sp/>{</highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(nf.type().typeId())<sp/>{</highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>MAP:</highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>LIST:</highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>STRUCT:</highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result.add(nf.name());</highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="162"><highlight class="normal"></highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result;</highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="165"><highlight class="normal"></highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/>@Override</highlight></codeline>
<codeline lineno="167" refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a2ace4a5b3795c94bde2bd9e9ef607f1e" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>ImmutableList&lt;OpType&gt;<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a2ace4a5b3795c94bde2bd9e9ef607f1e" kindref="member">getSupportedExpressionTypes</ref>()<sp/>{</highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1ab1661113ec43d43819cd8e0b9c1ed7b0" kindref="member">LOG</ref>.info(</highlight><highlight class="stringliteral">&quot;[{}]:<sp/>getSupportedExpressionTypes()&quot;</highlight><highlight class="normal">,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a9ce62b1c3dc655963c557545d65015ee" kindref="member">signature</ref>);</highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ImmutableList.of(</highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>OpType.OP_AND,</highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>OpType.OP_OR,</highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>OpType.OP_EQ,</highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>OpType.OP_NE,</highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>OpType.OP_NOT,</highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>OpType.OP_GE,</highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>OpType.OP_GT,</highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>OpType.OP_LE,</highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>OpType.OP_LT,</highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>OpType.OP_BETWEEN,</highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>OpType.OP_IN,</highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>OpType.OP_NULL);</highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="183"><highlight class="normal"></highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/>@Override</highlight></codeline>
<codeline lineno="185" refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a44460a9ea8896774749280db7870b323" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a44460a9ea8896774749280db7870b323" kindref="member">setPushdownPredicate</ref>(<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1expressions_1_1Expression" kindref="compound">Expression</ref><sp/>predicate)<sp/></highlight><highlight class="keywordflow">throws</highlight><highlight class="normal"><sp/>IOException<sp/>{</highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1ab1661113ec43d43819cd8e0b9c1ed7b0" kindref="member">LOG</ref>.info(</highlight><highlight class="stringliteral">&quot;[{}]:<sp/>setPushdownPredicate()&quot;</highlight><highlight class="normal">,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a9ce62b1c3dc655963c557545d65015ee" kindref="member">signature</ref>);</highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1ab1661113ec43d43819cd8e0b9c1ed7b0" kindref="member">LOG</ref>.info(</highlight><highlight class="stringliteral">&quot;[{}]:<sp/>Pig<sp/>predicate<sp/>expression:<sp/>{}&quot;</highlight><highlight class="normal">,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a9ce62b1c3dc655963c557545d65015ee" kindref="member">signature</ref>,<sp/>predicate);</highlight></codeline>
<codeline lineno="188"><highlight class="normal"></highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1expressions" kindref="compound">expressions</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1expressions_1_1Expression" kindref="compound">Expression</ref><sp/>icebergExpression<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1afbbb5771cf5cc9bd381802d02b1150aa" kindref="member">convert</ref>(predicate);</highlight></codeline>
<codeline lineno="190"><highlight class="normal"></highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1ab1661113ec43d43819cd8e0b9c1ed7b0" kindref="member">LOG</ref>.info(</highlight><highlight class="stringliteral">&quot;[{}]:<sp/>Iceberg<sp/>predicate<sp/>expression:<sp/>{}&quot;</highlight><highlight class="normal">,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a9ce62b1c3dc655963c557545d65015ee" kindref="member">signature</ref>,<sp/>icebergExpression);</highlight></codeline>
<codeline lineno="192"><highlight class="normal"></highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1ad34c42f76c7cbfa11d9c371d8a2be13a" kindref="member">storeInUDFContext</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergPigInputFormat" kindref="compound">IcebergPigInputFormat</ref>.ICEBERG_FILTER_EXPRESSION,<sp/>icebergExpression);</highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="195"><highlight class="normal"></highlight></codeline>
<codeline lineno="196" refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1afbbb5771cf5cc9bd381802d02b1150aa" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1expressions" kindref="compound">expressions</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1expressions_1_1Expression" kindref="compound">Expression</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1afbbb5771cf5cc9bd381802d02b1150aa" kindref="member">convert</ref>(<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1expressions_1_1Expression" kindref="compound">Expression</ref><sp/>expression)</highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throws</highlight><highlight class="normal"><sp/>IOException<sp/>{</highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/>OpType<sp/>op<sp/>=<sp/>expression.getOpType();</highlight></codeline>
<codeline lineno="199"><highlight class="normal"></highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(expression<sp/>instanceof<sp/>BinaryExpression)<sp/>{</highlight></codeline>
<codeline lineno="201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1expressions_1_1Expression" kindref="compound">Expression</ref><sp/>lhs<sp/>=<sp/>((BinaryExpression)<sp/>expression).getLhs();</highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1expressions_1_1Expression" kindref="compound">Expression</ref><sp/>rhs<sp/>=<sp/>((BinaryExpression)<sp/>expression).getRhs();</highlight></codeline>
<codeline lineno="203"><highlight class="normal"></highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(op)<sp/>{</highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>OP_AND:</highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1Expressions" kindref="compound">Expressions</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1Expressions_1ab5f3130e4b4bc72d48c2c120cabf2193" kindref="member">and</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1afbbb5771cf5cc9bd381802d02b1150aa" kindref="member">convert</ref>(lhs),<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1afbbb5771cf5cc9bd381802d02b1150aa" kindref="member">convert</ref>(rhs));</highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>OP_OR:</highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1Expressions" kindref="compound">Expressions</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1Expressions_1acea175d2d1b03fb3a5b1f12bc730a7e9" kindref="member">or</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1afbbb5771cf5cc9bd381802d02b1150aa" kindref="member">convert</ref>(lhs),<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1afbbb5771cf5cc9bd381802d02b1150aa" kindref="member">convert</ref>(rhs));</highlight></codeline>
<codeline lineno="209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>OP_BETWEEN:</highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>BetweenExpression<sp/>between<sp/>=<sp/>(BetweenExpression)<sp/>rhs;</highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1Expressions" kindref="compound">Expressions</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1Expressions_1ab5f3130e4b4bc72d48c2c120cabf2193" kindref="member">and</ref>(</highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1afbbb5771cf5cc9bd381802d02b1150aa" kindref="member">convert</ref>(OpType.OP_GE,<sp/>(Column)<sp/>lhs,<sp/>(Const)<sp/>between.getLower()),</highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1afbbb5771cf5cc9bd381802d02b1150aa" kindref="member">convert</ref>(OpType.OP_LE,<sp/>(Column)<sp/>lhs,<sp/>(Const)<sp/>between.getUpper()));</highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>OP_IN:</highlight></codeline>
<codeline lineno="215"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>((InExpression)<sp/>rhs)</highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.getValues().stream()</highlight></codeline>
<codeline lineno="217"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.map(value<sp/>-&gt;<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1afbbb5771cf5cc9bd381802d02b1150aa" kindref="member">convert</ref>(OpType.OP_EQ,<sp/>(Column)<sp/>lhs,<sp/>(Const)<sp/>value))</highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.reduce(<ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1Expressions" kindref="compound">Expressions</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1Expressions_1a90f0b9b650f65f436e0e239516e58dc2" kindref="member">alwaysFalse</ref>(),<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1Expressions_1acea175d2d1b03fb3a5b1f12bc730a7e9" kindref="member">Expressions::or</ref>);</highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(lhs<sp/>instanceof<sp/>Column<sp/>&amp;&amp;<sp/>rhs<sp/>instanceof<sp/>Const)<sp/>{</highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1afbbb5771cf5cc9bd381802d02b1150aa" kindref="member">convert</ref>(op,<sp/>(Column)<sp/>lhs,<sp/>(Const)<sp/>rhs);</highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(lhs<sp/>instanceof<sp/>Const<sp/>&amp;&amp;<sp/>rhs<sp/>instanceof<sp/>Column)<sp/>{</highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>FrontendException(</highlight><highlight class="stringliteral">&quot;Invalid<sp/>expression<sp/>ordering<sp/>&quot;</highlight><highlight class="normal"><sp/>+<sp/>expression);</highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="226"><highlight class="normal"></highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(expression<sp/>instanceof<sp/>UnaryExpression)<sp/>{</highlight></codeline>
<codeline lineno="228"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1expressions_1_1Expression" kindref="compound">Expression</ref><sp/>unary<sp/>=<sp/>((UnaryExpression)<sp/>expression).getExpression();</highlight></codeline>
<codeline lineno="229"><highlight class="normal"></highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(op)<sp/>{</highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>OP_NOT:</highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1Expressions" kindref="compound">Expressions</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1Expressions_1aceaec05c02f87afdc891345e60923725" kindref="member">not</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1afbbb5771cf5cc9bd381802d02b1150aa" kindref="member">convert</ref>(unary));</highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>OP_NULL:</highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1Expressions" kindref="compound">Expressions</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1Expressions_1a1c70a49db3e89d8daaf054f72c257d53" kindref="member">isNull</ref>(((Column)<sp/>unary).getName());</highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>FrontendException(</highlight><highlight class="stringliteral">&quot;Unsupported<sp/>unary<sp/>operator&quot;</highlight><highlight class="normal"><sp/>+<sp/>op);</highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="239"><highlight class="normal"></highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>FrontendException(</highlight><highlight class="stringliteral">&quot;Failed<sp/>to<sp/>pushdown<sp/>expression<sp/>&quot;</highlight><highlight class="normal"><sp/>+<sp/>expression);</highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="242"><highlight class="normal"></highlight></codeline>
<codeline lineno="243" refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a631db0ca79c8fc2a8050633f02023e21" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1expressions" kindref="compound">expressions</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1expressions_1_1Expression" kindref="compound">Expression</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a631db0ca79c8fc2a8050633f02023e21" kindref="member">convert</ref>(OpType<sp/>op,<sp/>Column<sp/>col,<sp/>Const<sp/>constant)<sp/>{</highlight></codeline>
<codeline lineno="244"><highlight class="normal"><sp/><sp/><sp/><sp/>String<sp/>name<sp/>=<sp/>col.getName();</highlight></codeline>
<codeline lineno="245"><highlight class="normal"><sp/><sp/><sp/><sp/>Object<sp/>value<sp/>=<sp/>constant.getValue();</highlight></codeline>
<codeline lineno="246"><highlight class="normal"></highlight></codeline>
<codeline lineno="247"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(op)<sp/>{</highlight></codeline>
<codeline lineno="248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>OP_GE:</highlight></codeline>
<codeline lineno="249"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1Expressions" kindref="compound">Expressions</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1Expressions_1ab801f587d9cce3c2443864eb77995314" kindref="member">greaterThanOrEqual</ref>(name,<sp/>value);</highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>OP_GT:</highlight></codeline>
<codeline lineno="251"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1Expressions" kindref="compound">Expressions</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1Expressions_1a75fd45cc3494539f4da1943483029e15" kindref="member">greaterThan</ref>(name,<sp/>value);</highlight></codeline>
<codeline lineno="252"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>OP_LE:</highlight></codeline>
<codeline lineno="253"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1Expressions" kindref="compound">Expressions</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1Expressions_1ab5349114c5d1a3457493181f6daa650e" kindref="member">lessThanOrEqual</ref>(name,<sp/>value);</highlight></codeline>
<codeline lineno="254"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>OP_LT:</highlight></codeline>
<codeline lineno="255"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1Expressions" kindref="compound">Expressions</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1Expressions_1a30a0eede7e53344a7e9da68883727d41" kindref="member">lessThan</ref>(name,<sp/>value);</highlight></codeline>
<codeline lineno="256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>OP_EQ:</highlight></codeline>
<codeline lineno="257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1util_1_1NaNUtil" kindref="compound">NaNUtil</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1util_1_1NaNUtil_1a856887d8b21cc0f25b7fb2dd3c17b65b" kindref="member">isNaN</ref>(value)<sp/>?<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1Expressions" kindref="compound">Expressions</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1Expressions_1a1df593abe1a750c5f9f872c8513562e8" kindref="member">isNaN</ref>(name)<sp/>:<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1Expressions" kindref="compound">Expressions</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1Expressions_1a60c7b1b0d4d1365a213aea19bd233e08" kindref="member">equal</ref>(name,<sp/>value);</highlight></codeline>
<codeline lineno="258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>OP_NE:</highlight></codeline>
<codeline lineno="259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1util_1_1NaNUtil" kindref="compound">NaNUtil</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1util_1_1NaNUtil_1a856887d8b21cc0f25b7fb2dd3c17b65b" kindref="member">isNaN</ref>(value)<sp/>?<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1Expressions" kindref="compound">Expressions</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1Expressions_1a51ee93ecdcac1290ecb7b97d9dc388b7" kindref="member">notNaN</ref>(name)<sp/>:<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1Expressions" kindref="compound">Expressions</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1Expressions_1a2cd50c49dd3be0caa7a3a5bb5b5f1259" kindref="member">notEqual</ref>(name,<sp/>value);</highlight></codeline>
<codeline lineno="260"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="261"><highlight class="normal"></highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>RuntimeException(</highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>String.format(</highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;[%s]:<sp/>Failed<sp/>to<sp/>pushdown<sp/>expression:<sp/>%s<sp/>%s<sp/>%s&quot;</highlight><highlight class="normal">,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a9ce62b1c3dc655963c557545d65015ee" kindref="member">signature</ref>,<sp/>col,<sp/>op,<sp/>constant));</highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="266"><highlight class="normal"></highlight></codeline>
<codeline lineno="267"><highlight class="normal"><sp/><sp/>@Override</highlight></codeline>
<codeline lineno="268" refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a95eeb6a620605ec1e9ae5bb4f1100064" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>List&lt;OperatorSet&gt;<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a95eeb6a620605ec1e9ae5bb4f1100064" kindref="member">getFeatures</ref>()<sp/>{</highlight></codeline>
<codeline lineno="269"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>Collections.singletonList(OperatorSet.PROJECTION);</highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="271"><highlight class="normal"></highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/>@Override</highlight></codeline>
<codeline lineno="273" refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a878c39092e056d0e6fa91fdf12c24a4f" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>RequiredFieldResponse<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a878c39092e056d0e6fa91fdf12c24a4f" kindref="member">pushProjection</ref>(RequiredFieldList<sp/>requiredFieldList)<sp/>{</highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1ab1661113ec43d43819cd8e0b9c1ed7b0" kindref="member">LOG</ref>.info(</highlight><highlight class="stringliteral">&quot;[{}]:<sp/>pushProjection()<sp/>-&gt;<sp/>{}&quot;</highlight><highlight class="normal">,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a9ce62b1c3dc655963c557545d65015ee" kindref="member">signature</ref>,<sp/>requiredFieldList);</highlight></codeline>
<codeline lineno="275"><highlight class="normal"></highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>List&lt;String&gt;<sp/>projection<sp/>=</highlight></codeline>
<codeline lineno="278"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>requiredFieldList.getFields().stream()</highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.map(RequiredField::getAlias)</highlight></codeline>
<codeline lineno="280"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.collect(Collectors.toList());</highlight></codeline>
<codeline lineno="281"><highlight class="normal"></highlight></codeline>
<codeline lineno="282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1ad34c42f76c7cbfa11d9c371d8a2be13a" kindref="member">storeInUDFContext</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergPigInputFormat" kindref="compound">IcebergPigInputFormat</ref>.ICEBERG_PROJECTED_FIELDS,<sp/>(Serializable)<sp/>projection);</highlight></codeline>
<codeline lineno="283"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">catch</highlight><highlight class="normal"><sp/>(IOException<sp/>e)<sp/>{</highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>RuntimeException(e);</highlight></codeline>
<codeline lineno="285"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="286"><highlight class="normal"></highlight></codeline>
<codeline lineno="287"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>RequiredFieldResponse(</highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="288"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="289"><highlight class="normal"></highlight></codeline>
<codeline lineno="290"><highlight class="normal"><sp/><sp/>@Override</highlight></codeline>
<codeline lineno="291" refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1ad5e9bf8de54a99f14515bf90e1c7b218" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1ad5e9bf8de54a99f14515bf90e1c7b218" kindref="member">setUDFContextSignature</ref>(String<sp/>newSignature)<sp/>{</highlight></codeline>
<codeline lineno="292"><highlight class="normal"><sp/><sp/><sp/><sp/>this.signature<sp/>=<sp/>newSignature;</highlight></codeline>
<codeline lineno="293"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="294"><highlight class="normal"></highlight></codeline>
<codeline lineno="295" refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1ad34c42f76c7cbfa11d9c371d8a2be13a" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1ad34c42f76c7cbfa11d9c371d8a2be13a" kindref="member">storeInUDFContext</ref>(String<sp/>key,<sp/>Serializable<sp/>value)<sp/></highlight><highlight class="keywordflow">throws</highlight><highlight class="normal"><sp/>IOException<sp/>{</highlight></codeline>
<codeline lineno="296"><highlight class="normal"><sp/><sp/><sp/><sp/>Properties<sp/>properties<sp/>=</highlight></codeline>
<codeline lineno="297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UDFContext.getUDFContext().getUDFProperties(this.getClass(),<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>String[]<sp/>{<ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a9ce62b1c3dc655963c557545d65015ee" kindref="member">signature</ref>});</highlight></codeline>
<codeline lineno="298"><highlight class="normal"></highlight></codeline>
<codeline lineno="299"><highlight class="normal"><sp/><sp/><sp/><sp/>properties.setProperty(key,<sp/>ObjectSerializer.serialize(value));</highlight></codeline>
<codeline lineno="300"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="301"><highlight class="normal"></highlight></codeline>
<codeline lineno="302" refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1ae1feb5c75fafe922e9f8437f77c25d58" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1ae1feb5c75fafe922e9f8437f77c25d58" kindref="member">copyUDFContextToScopedConfiguration</ref>(Configuration<sp/>conf,<sp/>String<sp/>key)<sp/>{</highlight></codeline>
<codeline lineno="303"><highlight class="normal"><sp/><sp/><sp/><sp/>String<sp/>value<sp/>=</highlight></codeline>
<codeline lineno="304"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UDFContext.getUDFContext()</highlight></codeline>
<codeline lineno="305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.getUDFProperties(this.getClass(),<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>String[]<sp/>{<ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a9ce62b1c3dc655963c557545d65015ee" kindref="member">signature</ref>})</highlight></codeline>
<codeline lineno="306"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.getProperty(key);</highlight></codeline>
<codeline lineno="307"><highlight class="normal"></highlight></codeline>
<codeline lineno="308"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(value<sp/>!=<sp/></highlight><highlight class="keyword">null</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="309"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>conf.set(key<sp/>+<sp/></highlight><highlight class="charliteral">&apos;.&apos;</highlight><highlight class="normal"><sp/>+<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a9ce62b1c3dc655963c557545d65015ee" kindref="member">signature</ref>,<sp/>value);</highlight></codeline>
<codeline lineno="310"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="311"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="312"><highlight class="normal"></highlight></codeline>
<codeline lineno="313"><highlight class="normal"><sp/><sp/>@Override</highlight></codeline>
<codeline lineno="314" refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1ad27b46110a3311be8ca80601b3af870a" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>String<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1ad27b46110a3311be8ca80601b3af870a" kindref="member">relativeToAbsolutePath</ref>(String<sp/>location,<sp/>Path<sp/>curDir)<sp/></highlight><highlight class="keywordflow">throws</highlight><highlight class="normal"><sp/>IOException<sp/>{</highlight></codeline>
<codeline lineno="315"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>location;</highlight></codeline>
<codeline lineno="316"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="317"><highlight class="normal"></highlight></codeline>
<codeline lineno="318" refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a5437340e04099e9f22bbad698384fd81" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Table" kindref="compound">Table</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a5437340e04099e9f22bbad698384fd81" kindref="member">load</ref>(String<sp/>location,<sp/>Job<sp/>job)<sp/></highlight><highlight class="keywordflow">throws</highlight><highlight class="normal"><sp/>IOException<sp/>{</highlight></codeline>
<codeline lineno="319"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a7fb383533387c561a6ddc48d05717011" kindref="member">iceberg</ref><sp/>==<sp/></highlight><highlight class="keyword">null</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Class&lt;?&gt;<sp/>tablesImpl<sp/>=</highlight></codeline>
<codeline lineno="321"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>job.getConfiguration().getClass(<ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1af00868a2f8d6a73e66c67ab161a70636" kindref="member">PIG_ICEBERG_TABLES_IMPL</ref>,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1hadoop_1_1HadoopTables" kindref="compound">HadoopTables</ref>.class);</highlight></codeline>
<codeline lineno="322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1ab1661113ec43d43819cd8e0b9c1ed7b0" kindref="member">LOG</ref>.info(</highlight><highlight class="stringliteral">&quot;Initializing<sp/>iceberg<sp/>tables<sp/>implementation:<sp/>{}&quot;</highlight><highlight class="normal">,<sp/>tablesImpl);</highlight></codeline>
<codeline lineno="323"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a7fb383533387c561a6ddc48d05717011" kindref="member">iceberg</ref><sp/>=<sp/>(<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Tables" kindref="compound">Tables</ref>)<sp/>ReflectionUtils.newInstance(tablesImpl,<sp/>job.getConfiguration());</highlight></codeline>
<codeline lineno="324"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="325"><highlight class="normal"></highlight></codeline>
<codeline lineno="326"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Table" kindref="compound">Table</ref><sp/>result<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a05dc7177f076721dacd0df0c54080c8b" kindref="member">tables</ref>.get(location);</highlight></codeline>
<codeline lineno="327"><highlight class="normal"></highlight></codeline>
<codeline lineno="328"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(result<sp/>==<sp/></highlight><highlight class="keyword">null</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="329"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="330"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1ab1661113ec43d43819cd8e0b9c1ed7b0" kindref="member">LOG</ref>.info(</highlight><highlight class="stringliteral">&quot;[{}]:<sp/>Loading<sp/>table<sp/>for<sp/>location:<sp/>{}&quot;</highlight><highlight class="normal">,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a9ce62b1c3dc655963c557545d65015ee" kindref="member">signature</ref>,<sp/>location);</highlight></codeline>
<codeline lineno="331"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a7fb383533387c561a6ddc48d05717011" kindref="member">iceberg</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Tables_1a556853567479690382ff3ff68c29c0f3" kindref="member">load</ref>(location);</highlight></codeline>
<codeline lineno="332"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1pig_1_1IcebergStorage_1a05dc7177f076721dacd0df0c54080c8b" kindref="member">tables</ref>.put(location,<sp/>result);</highlight></codeline>
<codeline lineno="333"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">catch</highlight><highlight class="normal"><sp/>(Exception<sp/>e)<sp/>{</highlight></codeline>
<codeline lineno="334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>FrontendException(</highlight><highlight class="stringliteral">&quot;Failed<sp/>to<sp/>instantiate<sp/>tables<sp/>implementation&quot;</highlight><highlight class="normal">,<sp/>e);</highlight></codeline>
<codeline lineno="335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="336"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="337"><highlight class="normal"></highlight></codeline>
<codeline lineno="338"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result;</highlight></codeline>
<codeline lineno="339"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="340"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="pig/src/main/java/org/apache/iceberg/pig/IcebergStorage.java"/>
  </compounddef>
</doxygen>
