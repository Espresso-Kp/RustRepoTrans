<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.17">
  <compounddef id="IcebergInputFormat_8java" kind="file" language="Java">
    <compoundname>IcebergInputFormat.java</compoundname>
    <innerclass refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat" prot="public">org::apache::iceberg::mr::mapreduce::IcebergInputFormat</innerclass>
    <innerclass refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader" prot="private">org::apache::iceberg::mr::mapreduce::IcebergInputFormat::IcebergRecordReader</innerclass>
    <innernamespace refid="namespaceorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce">org::apache::iceberg::mr::mapreduce</innernamespace>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">/*</highlight></codeline>
<codeline lineno="2"><highlight class="comment"><sp/>*<sp/>Licensed<sp/>to<sp/>the<sp/>Apache<sp/>Software<sp/>Foundation<sp/>(ASF)<sp/>under<sp/>one</highlight></codeline>
<codeline lineno="3"><highlight class="comment"><sp/>*<sp/>or<sp/>more<sp/>contributor<sp/>license<sp/>agreements.<sp/><sp/>See<sp/>the<sp/>NOTICE<sp/>file</highlight></codeline>
<codeline lineno="4"><highlight class="comment"><sp/>*<sp/>distributed<sp/>with<sp/>this<sp/>work<sp/>for<sp/>additional<sp/>information</highlight></codeline>
<codeline lineno="5"><highlight class="comment"><sp/>*<sp/>regarding<sp/>copyright<sp/>ownership.<sp/><sp/>The<sp/>ASF<sp/>licenses<sp/>this<sp/>file</highlight></codeline>
<codeline lineno="6"><highlight class="comment"><sp/>*<sp/>to<sp/>you<sp/>under<sp/>the<sp/>Apache<sp/>License,<sp/>Version<sp/>2.0<sp/>(the</highlight></codeline>
<codeline lineno="7"><highlight class="comment"><sp/>*<sp/>&quot;License&quot;);<sp/>you<sp/>may<sp/>not<sp/>use<sp/>this<sp/>file<sp/>except<sp/>in<sp/>compliance</highlight></codeline>
<codeline lineno="8"><highlight class="comment"><sp/>*<sp/>with<sp/>the<sp/>License.<sp/><sp/>You<sp/>may<sp/>obtain<sp/>a<sp/>copy<sp/>of<sp/>the<sp/>License<sp/>at</highlight></codeline>
<codeline lineno="9"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="10"><highlight class="comment"><sp/>*<sp/><sp/><sp/>http://www.apache.org/licenses/LICENSE-2.0</highlight></codeline>
<codeline lineno="11"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="12"><highlight class="comment"><sp/>*<sp/>Unless<sp/>required<sp/>by<sp/>applicable<sp/>law<sp/>or<sp/>agreed<sp/>to<sp/>in<sp/>writing,</highlight></codeline>
<codeline lineno="13"><highlight class="comment"><sp/>*<sp/>software<sp/>distributed<sp/>under<sp/>the<sp/>License<sp/>is<sp/>distributed<sp/>on<sp/>an</highlight></codeline>
<codeline lineno="14"><highlight class="comment"><sp/>*<sp/>&quot;AS<sp/>IS&quot;<sp/>BASIS,<sp/>WITHOUT<sp/>WARRANTIES<sp/>OR<sp/>CONDITIONS<sp/>OF<sp/>ANY</highlight></codeline>
<codeline lineno="15"><highlight class="comment"><sp/>*<sp/>KIND,<sp/>either<sp/>express<sp/>or<sp/>implied.<sp/><sp/>See<sp/>the<sp/>License<sp/>for<sp/>the</highlight></codeline>
<codeline lineno="16"><highlight class="comment"><sp/>*<sp/>specific<sp/>language<sp/>governing<sp/>permissions<sp/>and<sp/>limitations</highlight></codeline>
<codeline lineno="17"><highlight class="comment"><sp/>*<sp/>under<sp/>the<sp/>License.</highlight></codeline>
<codeline lineno="18"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="19" refid="namespaceorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">package<sp/></highlight><highlight class="normal">org.apache.iceberg.mr.mapreduce;</highlight></codeline>
<codeline lineno="20"><highlight class="normal"></highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>java.io.IOException;</highlight></codeline>
<codeline lineno="22"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>java.io.UncheckedIOException;</highlight></codeline>
<codeline lineno="23"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>java.util.Collections;</highlight></codeline>
<codeline lineno="24"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>java.util.Iterator;</highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>java.util.List;</highlight></codeline>
<codeline lineno="26"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>java.util.Map;</highlight></codeline>
<codeline lineno="27"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>java.util.Optional;</highlight></codeline>
<codeline lineno="28"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>java.util.Set;</highlight></codeline>
<codeline lineno="29"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>java.util.function.BiFunction;</highlight></codeline>
<codeline lineno="30"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1hadoop" kindref="compound">hadoop</ref>.conf.Configuration;</highlight></codeline>
<codeline lineno="31"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1hadoop" kindref="compound">hadoop</ref>.mapreduce.InputFormat;</highlight></codeline>
<codeline lineno="32"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1hadoop" kindref="compound">hadoop</ref>.mapreduce.InputSplit;</highlight></codeline>
<codeline lineno="33"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1hadoop" kindref="compound">hadoop</ref>.mapreduce.Job;</highlight></codeline>
<codeline lineno="34"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1hadoop" kindref="compound">hadoop</ref>.mapreduce.JobContext;</highlight></codeline>
<codeline lineno="35"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1hadoop" kindref="compound">hadoop</ref>.mapreduce.RecordReader;</highlight></codeline>
<codeline lineno="36"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1hadoop" kindref="compound">hadoop</ref>.mapreduce.TaskAttemptContext;</highlight></codeline>
<codeline lineno="37"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1CombinedScanTask" kindref="compound">CombinedScanTask</ref>;</highlight></codeline>
<codeline lineno="38"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1DataFile" kindref="compound">DataFile</ref>;</highlight></codeline>
<codeline lineno="39"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1DataTableScan" kindref="compound">DataTableScan</ref>;</highlight></codeline>
<codeline lineno="40"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1FileScanTask" kindref="compound">FileScanTask</ref>;</highlight></codeline>
<codeline lineno="41"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1MetadataColumns" kindref="compound">MetadataColumns</ref>;</highlight></codeline>
<codeline lineno="42"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1PartitionSpec" kindref="compound">PartitionSpec</ref>;</highlight></codeline>
<codeline lineno="43"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1Schema" kindref="compound">Schema</ref>;</highlight></codeline>
<codeline lineno="44"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1SchemaParser" kindref="compound">SchemaParser</ref>;</highlight></codeline>
<codeline lineno="45"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1SerializableTable" kindref="compound">SerializableTable</ref>;</highlight></codeline>
<codeline lineno="46"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1StructLike" kindref="compound">StructLike</ref>;</highlight></codeline>
<codeline lineno="47"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Table" kindref="compound">Table</ref>;</highlight></codeline>
<codeline lineno="48"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1TableProperties" kindref="compound">TableProperties</ref>;</highlight></codeline>
<codeline lineno="49"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1TableScan" kindref="compound">TableScan</ref>;</highlight></codeline>
<codeline lineno="50"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1avro" kindref="compound">avro</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1avro_1_1Avro" kindref="compound">Avro</ref>;</highlight></codeline>
<codeline lineno="51"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1common" kindref="compound">common</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1common_1_1DynMethods" kindref="compound">DynMethods</ref>;</highlight></codeline>
<codeline lineno="52"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1data" kindref="compound">data</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1data_1_1DeleteFilter" kindref="compound">DeleteFilter</ref>;</highlight></codeline>
<codeline lineno="53"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1data" kindref="compound">data</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1data_1_1GenericDeleteFilter" kindref="compound">GenericDeleteFilter</ref>;</highlight></codeline>
<codeline lineno="54"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1data" kindref="compound">data</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1data_1_1IdentityPartitionConverters" kindref="compound">IdentityPartitionConverters</ref>;</highlight></codeline>
<codeline lineno="55"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1data" kindref="compound">data</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1data_1_1InternalRecordWrapper" kindref="compound">InternalRecordWrapper</ref>;</highlight></codeline>
<codeline lineno="56"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1data" kindref="compound">data</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1data_1_1avro" kindref="compound">avro</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1data_1_1avro_1_1DataReader" kindref="compound">DataReader</ref>;</highlight></codeline>
<codeline lineno="57"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1data" kindref="compound">data</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1data_1_1orc" kindref="compound">orc</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1data_1_1orc_1_1GenericOrcReader" kindref="compound">GenericOrcReader</ref>;</highlight></codeline>
<codeline lineno="58"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1data" kindref="compound">data</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1data_1_1parquet" kindref="compound">parquet</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1data_1_1parquet_1_1GenericParquetReaders" kindref="compound">GenericParquetReaders</ref>;</highlight></codeline>
<codeline lineno="59"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1encryption" kindref="compound">encryption</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1encryption_1_1EncryptedFiles" kindref="compound">EncryptedFiles</ref>;</highlight></codeline>
<codeline lineno="60"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1encryption" kindref="compound">encryption</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1encryption_1_1EncryptionManager" kindref="compound">EncryptionManager</ref>;</highlight></codeline>
<codeline lineno="61"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1expressions" kindref="compound">expressions</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1Evaluator" kindref="compound">Evaluator</ref>;</highlight></codeline>
<codeline lineno="62"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1expressions" kindref="compound">expressions</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1expressions_1_1Expression" kindref="compound">Expression</ref>;</highlight></codeline>
<codeline lineno="63"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1expressions" kindref="compound">expressions</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1Expressions" kindref="compound">Expressions</ref>;</highlight></codeline>
<codeline lineno="64"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1hive" kindref="compound">hive</ref>.<ref refid="enumorg_1_1apache_1_1iceberg_1_1hive_1_1HiveVersion" kindref="compound">HiveVersion</ref>;</highlight></codeline>
<codeline lineno="65"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1io" kindref="compound">io</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1io_1_1CloseableIterable" kindref="compound">CloseableIterable</ref>;</highlight></codeline>
<codeline lineno="66"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1io" kindref="compound">io</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1io_1_1CloseableIterator" kindref="compound">CloseableIterator</ref>;</highlight></codeline>
<codeline lineno="67"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1io" kindref="compound">io</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1io_1_1FileIO" kindref="compound">FileIO</ref>;</highlight></codeline>
<codeline lineno="68"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1io" kindref="compound">io</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1io_1_1InputFile" kindref="compound">InputFile</ref>;</highlight></codeline>
<codeline lineno="69"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1mapping" kindref="compound">mapping</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1mapping_1_1NameMappingParser" kindref="compound">NameMappingParser</ref>;</highlight></codeline>
<codeline lineno="70"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1mr" kindref="compound">mr</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1Catalogs" kindref="compound">Catalogs</ref>;</highlight></codeline>
<codeline lineno="71"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1mr" kindref="compound">mr</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig" kindref="compound">InputFormatConfig</ref>;</highlight></codeline>
<codeline lineno="72"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1mr" kindref="compound">mr</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1mr_1_1hive" kindref="compound">hive</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1hive_1_1HiveIcebergStorageHandler" kindref="compound">HiveIcebergStorageHandler</ref>;</highlight></codeline>
<codeline lineno="73"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1orc" kindref="compound">orc</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1orc_1_1ORC" kindref="compound">ORC</ref>;</highlight></codeline>
<codeline lineno="74"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1parquet" kindref="compound">parquet</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1parquet_1_1Parquet" kindref="compound">Parquet</ref>;</highlight></codeline>
<codeline lineno="75"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.relocated.com.google.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1common" kindref="compound">common</ref>.collect.Lists;</highlight></codeline>
<codeline lineno="76"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.relocated.com.google.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1common" kindref="compound">common</ref>.collect.<ref refid="classorg_1_1apache_1_1iceberg_1_1relocated_1_1com_1_1google_1_1common_1_1collect_1_1Sets" kindref="compound">Sets</ref>;</highlight></codeline>
<codeline lineno="77"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1types" kindref="compound">types</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1types_1_1Type" kindref="compound">Type</ref>;</highlight></codeline>
<codeline lineno="78"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1types" kindref="compound">types</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1types_1_1TypeUtil" kindref="compound">TypeUtil</ref>;</highlight></codeline>
<codeline lineno="79"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1util" kindref="compound">util</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1util_1_1PartitionUtil" kindref="compound">PartitionUtil</ref>;</highlight></codeline>
<codeline lineno="80"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1util" kindref="compound">util</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1util_1_1SerializationUtil" kindref="compound">SerializationUtil</ref>;</highlight></codeline>
<codeline lineno="81"><highlight class="normal"></highlight></codeline>
<codeline lineno="88" refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat" refkind="compound"><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat" kindref="compound">IcebergInputFormat</ref>&lt;T&gt;<sp/></highlight><highlight class="keyword">extends</highlight><highlight class="normal"><sp/>InputFormat&lt;Void,<sp/>T&gt;<sp/>{</highlight></codeline>
<codeline lineno="95" refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1aa5aff22164ef59e0880724bcac5f2191" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig" kindref="compound">InputFormatConfig</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig_1_1ConfigBuilder" kindref="compound">ConfigBuilder</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1aa5aff22164ef59e0880724bcac5f2191" kindref="member">configure</ref>(Job<sp/>job)<sp/>{</highlight></codeline>
<codeline lineno="96"><highlight class="normal"><sp/><sp/><sp/><sp/>job.setInputFormatClass(<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat" kindref="compound">IcebergInputFormat</ref>.class);</highlight></codeline>
<codeline lineno="97"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig" kindref="compound">InputFormatConfig</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig_1_1ConfigBuilder" kindref="compound">ConfigBuilder</ref>(job.getConfiguration());</highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="99"><highlight class="normal"></highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/>@Override</highlight></codeline>
<codeline lineno="101" refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1abdcf844b7e04eb03bc011eadbbfef4bc" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>List&lt;InputSplit&gt;<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1abdcf844b7e04eb03bc011eadbbfef4bc" kindref="member">getSplits</ref>(JobContext<sp/>context)<sp/>{</highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/><sp/><sp/>Configuration<sp/>conf<sp/>=<sp/>context.getConfiguration();</highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Table" kindref="compound">Table</ref><sp/>table<sp/>=</highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Optional.ofNullable(</highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1hive_1_1HiveIcebergStorageHandler" kindref="compound">HiveIcebergStorageHandler</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1hive_1_1HiveIcebergStorageHandler_1ab44b3d99fb5882349502251e029b65f3" kindref="member">table</ref>(conf,<sp/>conf.get(<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig" kindref="compound">InputFormatConfig</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig_1ac129736b8058a20f5e8888c01516cf2f" kindref="member">TABLE_IDENTIFIER</ref>)))</highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.orElseGet(()<sp/>-&gt;<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1Catalogs" kindref="compound">Catalogs</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1Catalogs_1a7ee0ddff377ee935d6a879d5df1acb04" kindref="member">loadTable</ref>(conf));</highlight></codeline>
<codeline lineno="107"><highlight class="normal"></highlight></codeline>
<codeline lineno="108"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1TableScan" kindref="compound">TableScan</ref><sp/>scan<sp/>=</highlight></codeline>
<codeline lineno="109"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>table</highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Table_1a1d059631f06e0bf08f1be5e6e921fc23" kindref="member">newScan</ref>()</highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Scan_1a295d5298571b1486a64a2ba9754edf16" kindref="member">caseSensitive</ref>(</highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>conf.getBoolean(</highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig" kindref="compound">InputFormatConfig</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig_1a44da6372d1448e7773ec8d4a56c6c1bf" kindref="member">CASE_SENSITIVE</ref>,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig" kindref="compound">InputFormatConfig</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig_1acc57aff05936877c9c9fa52f548778b5" kindref="member">CASE_SENSITIVE_DEFAULT</ref>));</highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>snapshotId<sp/>=<sp/>conf.getLong(<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig" kindref="compound">InputFormatConfig</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig_1aac352b220c85c9ec872323185bdb4d6d" kindref="member">SNAPSHOT_ID</ref>,<sp/>-1);</highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(snapshotId<sp/>!=<sp/>-1)<sp/>{</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>scan<sp/>=<sp/>scan.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1TableScan_1a48bcb69c9aa85d603dbbf56f9b219c58" kindref="member">useSnapshot</ref>(snapshotId);</highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>asOfTime<sp/>=<sp/>conf.getLong(<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig" kindref="compound">InputFormatConfig</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig_1a3775a586168eee69465d33e303e98725" kindref="member">AS_OF_TIMESTAMP</ref>,<sp/>-1);</highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(asOfTime<sp/>!=<sp/>-1)<sp/>{</highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>scan<sp/>=<sp/>scan.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1TableScan_1a5ee6e32c8bcb62ca8588e5d5ee1a572e" kindref="member">asOfTime</ref>(asOfTime);</highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>splitSize<sp/>=<sp/>conf.getLong(<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig" kindref="compound">InputFormatConfig</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig_1a77f06d545ad0a9e9936e0814e34896cf" kindref="member">SPLIT_SIZE</ref>,<sp/>0);</highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(splitSize<sp/>&gt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>scan<sp/>=<sp/>scan.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Scan_1a5c64e1894f98cc97f364b83e32500f67" kindref="member">option</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1TableProperties" kindref="compound">TableProperties</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1TableProperties_1a3f78f92bcac6110cdce28d38ec2d3218" kindref="member">SPLIT_SIZE</ref>,<sp/>String.valueOf(splitSize));</highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/><sp/><sp/>String<sp/>schemaStr<sp/>=<sp/>conf.get(<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig" kindref="compound">InputFormatConfig</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig_1ac660ce907c5989165656c712ea23bd3c" kindref="member">READ_SCHEMA</ref>);</highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(schemaStr<sp/>!=<sp/></highlight><highlight class="keyword">null</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>scan.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Scan_1a0153b22dc6381654a870bfdec0448fab" kindref="member">project</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1SchemaParser" kindref="compound">SchemaParser</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1SchemaParser_1a1cfea0dbd74c8b90c7ef06d5df67c293" kindref="member">fromJson</ref>(schemaStr));</highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/>String[]<sp/>selectedColumns<sp/>=<sp/>conf.getStrings(<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig" kindref="compound">InputFormatConfig</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig_1aa296df7f27d4013f3d387a760b3abc3b" kindref="member">SELECTED_COLUMNS</ref>);</highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(selectedColumns<sp/>!=<sp/></highlight><highlight class="keyword">null</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>scan.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Scan_1a4aee25bb5fbca5312220355f0ac69b94" kindref="member">select</ref>(selectedColumns);</highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="134"><highlight class="normal"></highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>TODO<sp/>add<sp/>a<sp/>filter<sp/>parser<sp/>to<sp/>get<sp/>rid<sp/>of<sp/>Serialization</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1expressions_1_1Expression" kindref="compound">Expression</ref><sp/>filter<sp/>=</highlight></codeline>
<codeline lineno="137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1util_1_1SerializationUtil" kindref="compound">SerializationUtil</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1util_1_1SerializationUtil_1a863f615344265264f8ad0fdbdad446c7" kindref="member">deserializeFromBase64</ref>(conf.get(<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig" kindref="compound">InputFormatConfig</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig_1a23a1b70158891da1bfdb4f15437cc550" kindref="member">FILTER_EXPRESSION</ref>));</highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(filter<sp/>!=<sp/></highlight><highlight class="keyword">null</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>scan<sp/>=<sp/>scan.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Scan_1afa54ee3e31aa55e0519d8af3e5a18f27" kindref="member">filter</ref>(filter);</highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="141"><highlight class="normal"></highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><sp/><sp/>List&lt;InputSplit&gt;<sp/>splits<sp/>=<sp/>Lists.newArrayList();</highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">boolean</highlight><highlight class="normal"><sp/>applyResidual<sp/>=<sp/>!conf.getBoolean(<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig" kindref="compound">InputFormatConfig</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig_1a6bbd2adff46bc725ad08dc9e19385a80" kindref="member">SKIP_RESIDUAL_FILTERING</ref>,<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="144"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig" kindref="compound">InputFormatConfig</ref>.<ref refid="enumorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig_1_1InMemoryDataModel" kindref="compound">InMemoryDataModel</ref><sp/>model<sp/>=</highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>conf.getEnum(</highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig" kindref="compound">InputFormatConfig</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig_1a4f034ed66c9da874771657f02327ebf6" kindref="member">IN_MEMORY_DATA_MODEL</ref>,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig" kindref="compound">InputFormatConfig</ref>.<ref refid="enumorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig_1_1InMemoryDataModel" kindref="compound">InMemoryDataModel</ref>.<ref refid="enumorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig_1_1InMemoryDataModel_1ad1742d8d065f216fc2c7c2b49c7b2b83" kindref="member">GENERIC</ref>);</highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal"><sp/>(<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1io_1_1CloseableIterable" kindref="compound">CloseableIterable&lt;CombinedScanTask&gt;</ref><sp/>tasksIterable<sp/>=<sp/>scan.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Scan_1a7a9a9aac9313893034f5daa9d7544ad2" kindref="member">planTasks</ref>())<sp/>{</highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Table" kindref="compound">Table</ref><sp/>serializableTable<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1SerializableTable" kindref="compound">SerializableTable</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1SerializableTable_1ae8117c53577233fd5ffde28e46a0bcf2" kindref="member">copyOf</ref>(table);</highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>tasksIterable.forEach(</highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>task<sp/>-&gt;<sp/>{</highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(applyResidual</highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;&amp;<sp/>(model<sp/>==<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig" kindref="compound">InputFormatConfig</ref>.<ref refid="enumorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig_1_1InMemoryDataModel" kindref="compound">InMemoryDataModel</ref>.<ref refid="enumorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig_1_1InMemoryDataModel_1ae16005c7b145dd447a2ea23e55174b60" kindref="member">HIVE</ref></highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>||<sp/>model<sp/>==<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig" kindref="compound">InputFormatConfig</ref>.<ref refid="enumorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig_1_1InMemoryDataModel" kindref="compound">InMemoryDataModel</ref>.<ref refid="enumorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig_1_1InMemoryDataModel_1af2148e14e4a9c8de2664efa510c3a01d" kindref="member">PIG</ref>))<sp/>{</highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>TODO:<sp/>We<sp/>do<sp/>not<sp/>support<sp/>residual<sp/>evaluation<sp/>for<sp/>HIVE<sp/>and<sp/>PIG<sp/>in<sp/>memory<sp/>data<sp/>model</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>yet</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>checkResiduals(task);</highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>splits.add(</highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergSplit" kindref="compound">IcebergSplit</ref>(serializableTable,<sp/>conf,<sp/>task));</highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>});</highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">catch</highlight><highlight class="normal"><sp/>(IOException<sp/>e)<sp/>{</highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>UncheckedIOException(String.format(</highlight><highlight class="stringliteral">&quot;Failed<sp/>to<sp/>close<sp/>table<sp/>scan:<sp/>%s&quot;</highlight><highlight class="normal">,<sp/>scan),<sp/>e);</highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="163"><highlight class="normal"></highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>if<sp/>enabled,<sp/>do<sp/>not<sp/>serialize<sp/>FileIO<sp/>hadoop<sp/>config<sp/>to<sp/>decrease<sp/>split<sp/>size</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>However,<sp/>do<sp/>not<sp/>skip<sp/>serialization<sp/>for<sp/>metatable<sp/>queries,<sp/>because<sp/>some<sp/>metadata<sp/>tasks<sp/>cache</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>the<sp/>IO<sp/>object<sp/>and<sp/>we</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>wouldn&apos;t<sp/>be<sp/>able<sp/>to<sp/>inject<sp/>the<sp/>config<sp/>into<sp/>these<sp/>tasks<sp/>on<sp/>the<sp/>deserializer-side,<sp/>unlike<sp/>for</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>standard<sp/>queries</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(scan<sp/>instanceof<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1DataTableScan" kindref="compound">DataTableScan</ref>)<sp/>{</highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1hive_1_1HiveIcebergStorageHandler" kindref="compound">HiveIcebergStorageHandler</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1hive_1_1HiveIcebergStorageHandler_1a975d302fe0d9780a4818011209a9a1f5" kindref="member">checkAndSkipIoConfigSerialization</ref>(conf,<sp/>table);</highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="172"><highlight class="normal"></highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>splits;</highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="175"><highlight class="normal"></highlight></codeline>
<codeline lineno="176" refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1a77387bc81853f49025b4a485d750fbd1" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1a77387bc81853f49025b4a485d750fbd1" kindref="member">checkResiduals</ref>(<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1CombinedScanTask" kindref="compound">CombinedScanTask</ref><sp/>task)<sp/>{</highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/>task.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1CombinedScanTask_1a93006459ebde2b2dd782ca7a2368a7af" kindref="member">files</ref>()</highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.forEach(</highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fileScanTask<sp/>-&gt;<sp/>{</highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1expressions_1_1Expression" kindref="compound">Expression</ref><sp/>residual<sp/>=<sp/>fileScanTask.residual();</highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(residual<sp/>!=<sp/></highlight><highlight class="keyword">null</highlight><highlight class="normal"><sp/>&amp;&amp;<sp/>!residual.equals(<ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1Expressions" kindref="compound">Expressions</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1Expressions_1a53d1494a86985c74259aa1f8982e55c2" kindref="member">alwaysTrue</ref>()))<sp/>{</highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>throw<sp/>new<sp/>UnsupportedOperationException(</highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>String.format(</highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Filter<sp/>expression<sp/>%s<sp/>is<sp/>not<sp/>completely<sp/>satisfied.<sp/>Additional<sp/>rows<sp/>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+<sp/></highlight><highlight class="stringliteral">&quot;can<sp/>be<sp/>returned<sp/>not<sp/>satisfied<sp/>by<sp/>the<sp/>filter<sp/>expression&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>residual));</highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>});</highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="190"><highlight class="normal"></highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/>@Override</highlight></codeline>
<codeline lineno="192" refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1a1a17af27eef095fc706d3b1075751e73" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>RecordReader&lt;Void,<sp/>T&gt;<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1a1a17af27eef095fc706d3b1075751e73" kindref="member">createRecordReader</ref>(InputSplit<sp/>split,<sp/>TaskAttemptContext<sp/>context)<sp/>{</highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader" kindref="compound">IcebergRecordReader&lt;&gt;</ref>();</highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="195"><highlight class="normal"></highlight></codeline>
<codeline lineno="196" refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader" refkind="compound"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader" kindref="compound">IcebergRecordReader</ref>&lt;T&gt;<sp/></highlight><highlight class="keyword">extends</highlight><highlight class="normal"><sp/>RecordReader&lt;Void,<sp/>T&gt;<sp/>{</highlight></codeline>
<codeline lineno="197"><highlight class="normal"></highlight></codeline>
<codeline lineno="198" refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a4aafaf67bb9f68371de94df5c420e25c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/>String<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a4aafaf67bb9f68371de94df5c420e25c" kindref="member">HIVE_VECTORIZED_READER_CLASS</ref><sp/>=</highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;org.apache.iceberg.mr.hive.vector.HiveVectorizedReader&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="200" refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1adef9e08a6bf483d1c33462e3a3bf166b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1common_1_1DynMethods" kindref="compound">DynMethods</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1common_1_1DynMethods_1_1StaticMethod" kindref="compound">StaticMethod</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1adef9e08a6bf483d1c33462e3a3bf166b" kindref="member">HIVE_VECTORIZED_READER_BUILDER</ref>;</highlight></codeline>
<codeline lineno="201"><highlight class="normal"></highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="enumorg_1_1apache_1_1iceberg_1_1hive_1_1HiveVersion" kindref="compound">HiveVersion</ref>.<ref refid="enumorg_1_1apache_1_1iceberg_1_1hive_1_1HiveVersion_1aee5485bc45b3c964e0d33c5aaeab20f1" kindref="member">min</ref>(<ref refid="enumorg_1_1apache_1_1iceberg_1_1hive_1_1HiveVersion" kindref="compound">HiveVersion</ref>.<ref refid="enumorg_1_1apache_1_1iceberg_1_1hive_1_1HiveVersion_1a52d88cb7388568934d0e724a593412bc" kindref="member">HIVE_3</ref>))<sp/>{</highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1adef9e08a6bf483d1c33462e3a3bf166b" kindref="member">HIVE_VECTORIZED_READER_BUILDER</ref><sp/>=</highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1common_1_1DynMethods" kindref="compound">DynMethods</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1common_1_1DynMethods_1a471fda710982eb4064cd4e9e9d1be68d" kindref="member">builder</ref>(</highlight><highlight class="stringliteral">&quot;reader&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.<ref refid="classorg_1_1apache_1_1iceberg_1_1common_1_1DynMethods_1_1Builder_1a84d69e44436685d6756a214ef8fc9862" kindref="member">impl</ref>(</highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a4aafaf67bb9f68371de94df5c420e25c" kindref="member">HIVE_VECTORIZED_READER_CLASS</ref>,</highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1io_1_1InputFile" kindref="compound">InputFile</ref>.class,</highlight></codeline>
<codeline lineno="209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1FileScanTask" kindref="compound">FileScanTask</ref>.class,</highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Map.class,</highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TaskAttemptContext.class)</highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.<ref refid="classorg_1_1apache_1_1iceberg_1_1common_1_1DynMethods_1_1Builder_1aeb7058e18b7f52f4b5be5dd253ac72a1" kindref="member">buildStatic</ref>();</highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1adef9e08a6bf483d1c33462e3a3bf166b" kindref="member">HIVE_VECTORIZED_READER_BUILDER</ref><sp/>=<sp/></highlight><highlight class="keyword">null</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="215"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="217"><highlight class="normal"></highlight></codeline>
<codeline lineno="218" refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a2ea10ac3099b01589fadf94e40aed0be" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/>TaskAttemptContext<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a2ea10ac3099b01589fadf94e40aed0be" kindref="member">context</ref>;</highlight></codeline>
<codeline lineno="219" refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1ad9827c86694a71be9b52c1acabbaa056" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1Schema" kindref="compound">Schema</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1ad9827c86694a71be9b52c1acabbaa056" kindref="member">tableSchema</ref>;</highlight></codeline>
<codeline lineno="220" refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1aad7a5a6d1ed633dcfad286fdbc8966f2" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1Schema" kindref="compound">Schema</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1aad7a5a6d1ed633dcfad286fdbc8966f2" kindref="member">expectedSchema</ref>;</highlight></codeline>
<codeline lineno="221" refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a105758531eb1302fa58eb687ad095138" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/>String<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a105758531eb1302fa58eb687ad095138" kindref="member">nameMapping</ref>;</highlight></codeline>
<codeline lineno="222" refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a81bae73eb26c1d1bff88376f38919511" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">boolean</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a81bae73eb26c1d1bff88376f38919511" kindref="member">reuseContainers</ref>;</highlight></codeline>
<codeline lineno="223" refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1ad1bc9ce77b2a24e785f3251f4e5ff6cc" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">boolean</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1ad1bc9ce77b2a24e785f3251f4e5ff6cc" kindref="member">caseSensitive</ref>;</highlight></codeline>
<codeline lineno="224" refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1ae4f9363ecd1573c310b58d8ee7af85b9" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig" kindref="compound">InputFormatConfig</ref>.<ref refid="enumorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig_1_1InMemoryDataModel" kindref="compound">InMemoryDataModel</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1ae4f9363ecd1573c310b58d8ee7af85b9" kindref="member">inMemoryDataModel</ref>;</highlight></codeline>
<codeline lineno="225" refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a623c04e81d0cd653d8f18a71b2972953" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/>Iterator&lt;FileScanTask&gt;<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a623c04e81d0cd653d8f18a71b2972953" kindref="member">tasks</ref>;</highlight></codeline>
<codeline lineno="226" refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1affe1cd6d143c3f76e453b9bfcd89da7a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/>T<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1affe1cd6d143c3f76e453b9bfcd89da7a" kindref="member">current</ref>;</highlight></codeline>
<codeline lineno="227" refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a839b13e86da804dabf045ef8b0c8668a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1io_1_1CloseableIterator" kindref="compound">CloseableIterator&lt;T&gt;</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a839b13e86da804dabf045ef8b0c8668a" kindref="member">currentIterator</ref>;</highlight></codeline>
<codeline lineno="228" refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a3d0f012713e3eabed832411df38e6dd9" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1io_1_1FileIO" kindref="compound">FileIO</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a3d0f012713e3eabed832411df38e6dd9" kindref="member">io</ref>;</highlight></codeline>
<codeline lineno="229" refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a8e55f84704ec67578d0b51ae6f804e5d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1encryption_1_1EncryptionManager" kindref="compound">EncryptionManager</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a8e55f84704ec67578d0b51ae6f804e5d" kindref="member">encryptionManager</ref>;</highlight></codeline>
<codeline lineno="230"><highlight class="normal"></highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/>@Override</highlight></codeline>
<codeline lineno="232" refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1aab48379b0c134bdf140bab167e2f8e51" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1aab48379b0c134bdf140bab167e2f8e51" kindref="member">initialize</ref>(InputSplit<sp/>split,<sp/>TaskAttemptContext<sp/>newContext)<sp/>{</highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Configuration<sp/>conf<sp/>=<sp/>newContext.getConfiguration();</highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>For<sp/>now<sp/>IcebergInputFormat<sp/>does<sp/>its<sp/>own<sp/>split<sp/>planning<sp/>and<sp/>does<sp/>not<sp/>accept<sp/>FileSplit</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>instances</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1CombinedScanTask" kindref="compound">CombinedScanTask</ref><sp/>task<sp/>=<sp/>((<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergSplit" kindref="compound">IcebergSplit</ref>)<sp/>split).task();</highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this.context<sp/>=<sp/>newContext;</highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Table" kindref="compound">Table</ref><sp/>table<sp/>=<sp/>((<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergSplit" kindref="compound">IcebergSplit</ref>)<sp/>split).table();</highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1hive_1_1HiveIcebergStorageHandler" kindref="compound">HiveIcebergStorageHandler</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1hive_1_1HiveIcebergStorageHandler_1ac15a86346017e05fc06ed50502cbe7a2" kindref="member">checkAndSetIoConfig</ref>(conf,<sp/>table);</highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this.io<sp/>=<sp/>table.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Table_1aae6b533eb4c5f1d348a092dfce3c789b" kindref="member">io</ref>();</highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this.encryptionManager<sp/>=<sp/>table.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Table_1aa936700e5d6aade74f96c4cf2ad67948" kindref="member">encryption</ref>();</highlight></codeline>
<codeline lineno="242"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this.tasks<sp/>=<sp/>task.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1CombinedScanTask_1a93006459ebde2b2dd782ca7a2368a7af" kindref="member">files</ref>().iterator();</highlight></codeline>
<codeline lineno="243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this.tableSchema<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig" kindref="compound">InputFormatConfig</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig_1a893cf92e596ce8dc2c83e9b370ee962b" kindref="member">tableSchema</ref>(conf);</highlight></codeline>
<codeline lineno="244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this.nameMapping<sp/>=<sp/>table.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Table_1a6dc0d000ddb7a7285fc7fdc6383922d5" kindref="member">properties</ref>().get(<ref refid="classorg_1_1apache_1_1iceberg_1_1TableProperties" kindref="compound">TableProperties</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1TableProperties_1ac1e3fbfa7d26cd55c41d1d51c6bbe0b7" kindref="member">DEFAULT_NAME_MAPPING</ref>);</highlight></codeline>
<codeline lineno="245"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this.caseSensitive<sp/>=</highlight></codeline>
<codeline lineno="246"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>conf.getBoolean(</highlight></codeline>
<codeline lineno="247"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig" kindref="compound">InputFormatConfig</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig_1a44da6372d1448e7773ec8d4a56c6c1bf" kindref="member">CASE_SENSITIVE</ref>,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig" kindref="compound">InputFormatConfig</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig_1acc57aff05936877c9c9fa52f548778b5" kindref="member">CASE_SENSITIVE_DEFAULT</ref>);</highlight></codeline>
<codeline lineno="248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this.expectedSchema<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a7f823efb8526013feafbb4481f3eaa34" kindref="member">readSchema</ref>(conf,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1ad9827c86694a71be9b52c1acabbaa056" kindref="member">tableSchema</ref>,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1ad1bc9ce77b2a24e785f3251f4e5ff6cc" kindref="member">caseSensitive</ref>);</highlight></codeline>
<codeline lineno="249"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this.reuseContainers<sp/>=<sp/>conf.getBoolean(<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig" kindref="compound">InputFormatConfig</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig_1a2ac27b9865ad42869e0dd7cbfafe2f24" kindref="member">REUSE_CONTAINERS</ref>,<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this.<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1ae4f9363ecd1573c310b58d8ee7af85b9" kindref="member">inMemoryDataModel</ref><sp/>=</highlight></codeline>
<codeline lineno="251"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>conf.getEnum(</highlight></codeline>
<codeline lineno="252"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig" kindref="compound">InputFormatConfig</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig_1a4f034ed66c9da874771657f02327ebf6" kindref="member">IN_MEMORY_DATA_MODEL</ref>,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig" kindref="compound">InputFormatConfig</ref>.<ref refid="enumorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig_1_1InMemoryDataModel" kindref="compound">InMemoryDataModel</ref>.<ref refid="enumorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig_1_1InMemoryDataModel_1ad1742d8d065f216fc2c7c2b49c7b2b83" kindref="member">GENERIC</ref>);</highlight></codeline>
<codeline lineno="253"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this.currentIterator<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a65c3e62b84aac449ad2688a550642458" kindref="member">open</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a623c04e81d0cd653d8f18a71b2972953" kindref="member">tasks</ref>.next(),<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1aad7a5a6d1ed633dcfad286fdbc8966f2" kindref="member">expectedSchema</ref>).iterator();</highlight></codeline>
<codeline lineno="254"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="255"><highlight class="normal"></highlight></codeline>
<codeline lineno="256"><highlight class="normal"><sp/><sp/><sp/><sp/>@Override</highlight></codeline>
<codeline lineno="257" refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a1893e707d4fdb4f889455372fe33b98d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">boolean</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a1893e707d4fdb4f889455372fe33b98d" kindref="member">nextKeyValue</ref>()<sp/>throws<sp/>IOException<sp/>{</highlight></codeline>
<codeline lineno="258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keyword">true</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a839b13e86da804dabf045ef8b0c8668a" kindref="member">currentIterator</ref>.hasNext())<sp/>{</highlight></codeline>
<codeline lineno="260"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1affe1cd6d143c3f76e453b9bfcd89da7a" kindref="member">current</ref><sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a839b13e86da804dabf045ef8b0c8668a" kindref="member">currentIterator</ref>.next();</highlight></codeline>
<codeline lineno="261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a623c04e81d0cd653d8f18a71b2972953" kindref="member">tasks</ref>.hasNext())<sp/>{</highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a839b13e86da804dabf045ef8b0c8668a" kindref="member">currentIterator</ref>.close();</highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a839b13e86da804dabf045ef8b0c8668a" kindref="member">currentIterator</ref><sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a65c3e62b84aac449ad2688a550642458" kindref="member">open</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a623c04e81d0cd653d8f18a71b2972953" kindref="member">tasks</ref>.next(),<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1aad7a5a6d1ed633dcfad286fdbc8966f2" kindref="member">expectedSchema</ref>).iterator();</highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a839b13e86da804dabf045ef8b0c8668a" kindref="member">currentIterator</ref>.close();</highlight></codeline>
<codeline lineno="267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="269"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="271"><highlight class="normal"></highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/><sp/><sp/>@Override</highlight></codeline>
<codeline lineno="273" refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a8dab650b77ac15f5c00cd77dfcc0ca3f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>Void<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a8dab650b77ac15f5c00cd77dfcc0ca3f" kindref="member">getCurrentKey</ref>()<sp/>{</highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">null</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="276"><highlight class="normal"></highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/><sp/><sp/>@Override</highlight></codeline>
<codeline lineno="278" refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a4d9c731c470872ae69c0e4d603fea528" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>T<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a4d9c731c470872ae69c0e4d603fea528" kindref="member">getCurrentValue</ref>()<sp/>{</highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1affe1cd6d143c3f76e453b9bfcd89da7a" kindref="member">current</ref>;</highlight></codeline>
<codeline lineno="280"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="281"><highlight class="normal"></highlight></codeline>
<codeline lineno="282"><highlight class="normal"><sp/><sp/><sp/><sp/>@Override</highlight></codeline>
<codeline lineno="283" refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1ab7651980d2abb1fc30900dc9b6c21c8d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1ab7651980d2abb1fc30900dc9b6c21c8d" kindref="member">getProgress</ref>()<sp/>{</highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>TODO:<sp/>We<sp/>could<sp/>give<sp/>a<sp/>more<sp/>accurate<sp/>progress<sp/>based<sp/>on<sp/>records<sp/>read<sp/>from<sp/>the<sp/>file.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Context.getProgress<sp/>does<sp/>not</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>have<sp/>enough<sp/>information<sp/>to<sp/>give<sp/>an<sp/>accurate<sp/>progress<sp/>value.<sp/>This<sp/>isn&apos;t<sp/>that<sp/>easy,<sp/>since<sp/>we</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="287"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>don&apos;t<sp/>know<sp/>how<sp/>much</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>of<sp/>the<sp/>input<sp/>split<sp/>has<sp/>been<sp/>processed<sp/>and<sp/>we<sp/>are<sp/>pushing<sp/>filters<sp/>into<sp/>Parquet<sp/>and<sp/>ORC.<sp/>But</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="289"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>we<sp/>do<sp/>know<sp/>when<sp/>a</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="290"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>file<sp/>is<sp/>opened<sp/>and<sp/>could<sp/>count<sp/>the<sp/>number<sp/>of<sp/>rows<sp/>returned,<sp/>so<sp/>we<sp/>can<sp/>estimate.<sp/>And<sp/>we</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>could<sp/>also<sp/>add<sp/>a<sp/>row</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="292"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>count<sp/>to<sp/>the<sp/>readers<sp/>so<sp/>that<sp/>we<sp/>can<sp/>get<sp/>an<sp/>accurate<sp/>count<sp/>of<sp/>rows<sp/>that<sp/>have<sp/>been<sp/>either</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="293"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>returned<sp/>or<sp/>filtered</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="294"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>out.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="295"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a2ea10ac3099b01589fadf94e40aed0be" kindref="member">context</ref>.getProgress();</highlight></codeline>
<codeline lineno="296"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="297"><highlight class="normal"></highlight></codeline>
<codeline lineno="298"><highlight class="normal"><sp/><sp/><sp/><sp/>@Override</highlight></codeline>
<codeline lineno="299" refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a2356b21f05887c6c0ab642897edeca18" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a2356b21f05887c6c0ab642897edeca18" kindref="member">close</ref>()<sp/>throws<sp/>IOException<sp/>{</highlight></codeline>
<codeline lineno="300"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a839b13e86da804dabf045ef8b0c8668a" kindref="member">currentIterator</ref>.close();</highlight></codeline>
<codeline lineno="301"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="302"><highlight class="normal"></highlight></codeline>
<codeline lineno="303" refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1ac57dd8a8274d59ab8aa8ef35f8b757eb" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1io_1_1CloseableIterable" kindref="compound">CloseableIterable&lt;T&gt;</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1ac57dd8a8274d59ab8aa8ef35f8b757eb" kindref="member">openTask</ref>(<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1FileScanTask" kindref="compound">FileScanTask</ref><sp/>currentTask,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1Schema" kindref="compound">Schema</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a7f823efb8526013feafbb4481f3eaa34" kindref="member">readSchema</ref>)<sp/>{</highlight></codeline>
<codeline lineno="304"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1DataFile" kindref="compound">DataFile</ref><sp/>file<sp/>=<sp/>currentTask.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1ContentScanTask_1aa15f447b4d93d067dad725838d22411c" kindref="member">file</ref>();</highlight></codeline>
<codeline lineno="305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1io_1_1InputFile" kindref="compound">InputFile</ref><sp/>inputFile<sp/>=</highlight></codeline>
<codeline lineno="306"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a8e55f84704ec67578d0b51ae6f804e5d" kindref="member">encryptionManager</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1encryption_1_1EncryptionManager_1ad86b68dbe2e56c67091441fe0558ac24" kindref="member">decrypt</ref>(</highlight></codeline>
<codeline lineno="307"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1encryption_1_1EncryptedFiles" kindref="compound">EncryptedFiles</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1encryption_1_1EncryptedFiles_1a7b589bfd015436de5cffee826dbe4ef2" kindref="member">encryptedInput</ref>(</highlight></codeline>
<codeline lineno="308"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a3d0f012713e3eabed832411df38e6dd9" kindref="member">io</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1io_1_1FileIO_1a54bd6931df3543c33aa9490c26e4e181" kindref="member">newInputFile</ref>(file.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1ContentFile_1afac86a9413536885d2075c54046d6500" kindref="member">path</ref>().toString()),<sp/>file.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1ContentFile_1ae98b645b0096efb243ad6633ac678578" kindref="member">keyMetadata</ref>()));</highlight></codeline>
<codeline lineno="309"><highlight class="normal"></highlight></codeline>
<codeline lineno="310"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1io_1_1CloseableIterable" kindref="compound">CloseableIterable&lt;T&gt;</ref><sp/>iterable;</highlight></codeline>
<codeline lineno="311"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(file.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1ContentFile_1aa770203f7cbefc3cb0b020f863454e30" kindref="member">format</ref>())<sp/>{</highlight></codeline>
<codeline lineno="312"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>AVRO:</highlight></codeline>
<codeline lineno="313"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>iterable<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a329f4161ff9d7bcce60d04981150563a" kindref="member">newAvroIterable</ref>(inputFile,<sp/>currentTask,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a7f823efb8526013feafbb4481f3eaa34" kindref="member">readSchema</ref>);</highlight></codeline>
<codeline lineno="314"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="315"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1orc_1_1ORC" kindref="compound">ORC</ref>:</highlight></codeline>
<codeline lineno="316"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>iterable<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a2068171d40fbc1191f6f08454dab860a" kindref="member">newOrcIterable</ref>(inputFile,<sp/>currentTask,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a7f823efb8526013feafbb4481f3eaa34" kindref="member">readSchema</ref>);</highlight></codeline>
<codeline lineno="317"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>PARQUET:</highlight></codeline>
<codeline lineno="319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>iterable<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1acf12e72ec41a6818bf5ef95d5ed76b86" kindref="member">newParquetIterable</ref>(inputFile,<sp/>currentTask,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a7f823efb8526013feafbb4481f3eaa34" kindref="member">readSchema</ref>);</highlight></codeline>
<codeline lineno="320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="321"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>UnsupportedOperationException(</highlight></codeline>
<codeline lineno="323"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>String.format(</highlight><highlight class="stringliteral">&quot;Cannot<sp/>read<sp/>%s<sp/>file:<sp/>%s&quot;</highlight><highlight class="normal">,<sp/>file.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1ContentFile_1aa770203f7cbefc3cb0b020f863454e30" kindref="member">format</ref>().name(),<sp/>file.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1ContentFile_1afac86a9413536885d2075c54046d6500" kindref="member">path</ref>()));</highlight></codeline>
<codeline lineno="324"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="325"><highlight class="normal"></highlight></codeline>
<codeline lineno="326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>iterable;</highlight></codeline>
<codeline lineno="327"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="328"><highlight class="normal"></highlight></codeline>
<codeline lineno="329"><highlight class="normal"><sp/><sp/><sp/><sp/>@SuppressWarnings(</highlight><highlight class="stringliteral">&quot;unchecked&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="330" refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a65c3e62b84aac449ad2688a550642458" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>private<sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1io_1_1CloseableIterable" kindref="compound">CloseableIterable</ref>&lt;T&gt;<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a65c3e62b84aac449ad2688a550642458" kindref="member">open</ref>(<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1FileScanTask" kindref="compound">FileScanTask</ref><sp/>currentTask,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1Schema" kindref="compound">Schema</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a7f823efb8526013feafbb4481f3eaa34" kindref="member">readSchema</ref>)<sp/>{</highlight></codeline>
<codeline lineno="331"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1ae4f9363ecd1573c310b58d8ee7af85b9" kindref="member">inMemoryDataModel</ref>)<sp/>{</highlight></codeline>
<codeline lineno="332"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>PIG:</highlight></codeline>
<codeline lineno="333"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>TODO:<sp/>Support<sp/>Pig<sp/>and<sp/>Hive<sp/>object<sp/>models<sp/>for<sp/>IcebergInputFormat</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>UnsupportedOperationException(</highlight><highlight class="stringliteral">&quot;Pig<sp/>and<sp/>Hive<sp/>object<sp/>models<sp/>are<sp/>not<sp/>supported.&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>HIVE:</highlight></codeline>
<codeline lineno="336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1ac57dd8a8274d59ab8aa8ef35f8b757eb" kindref="member">openTask</ref>(currentTask,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a7f823efb8526013feafbb4481f3eaa34" kindref="member">readSchema</ref>);</highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>GENERIC:</highlight></codeline>
<codeline lineno="338"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1data_1_1DeleteFilter" kindref="compound">DeleteFilter</ref><sp/>deletes<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1data_1_1GenericDeleteFilter" kindref="compound">GenericDeleteFilter</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a3d0f012713e3eabed832411df38e6dd9" kindref="member">io</ref>,<sp/>currentTask,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1ad9827c86694a71be9b52c1acabbaa056" kindref="member">tableSchema</ref>,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a7f823efb8526013feafbb4481f3eaa34" kindref="member">readSchema</ref>);</highlight></codeline>
<codeline lineno="339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1Schema" kindref="compound">Schema</ref><sp/>requiredSchema<sp/>=<sp/>deletes.<ref refid="classorg_1_1apache_1_1iceberg_1_1data_1_1DeleteFilter_1ab77dad997449a4d2c57684bec93e35e6" kindref="member">requiredSchema</ref>();</highlight></codeline>
<codeline lineno="340"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>deletes.<ref refid="classorg_1_1apache_1_1iceberg_1_1data_1_1DeleteFilter_1a4430ef5088e525068c547f577b77c91a" kindref="member">filter</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1ac57dd8a8274d59ab8aa8ef35f8b757eb" kindref="member">openTask</ref>(currentTask,<sp/>requiredSchema));</highlight></codeline>
<codeline lineno="341"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="342"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>UnsupportedOperationException(</highlight><highlight class="stringliteral">&quot;Unsupported<sp/>memory<sp/>model&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="344"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="345"><highlight class="normal"></highlight></codeline>
<codeline lineno="346" refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a713dc8aa741e258cb9fe81b92f1d4f12" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1io_1_1CloseableIterable" kindref="compound">CloseableIterable&lt;T&gt;</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a713dc8aa741e258cb9fe81b92f1d4f12" kindref="member">applyResidualFiltering</ref>(</highlight></codeline>
<codeline lineno="347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1io_1_1CloseableIterable" kindref="compound">CloseableIterable&lt;T&gt;</ref><sp/>iter,<sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1expressions_1_1Expression" kindref="compound">Expression</ref><sp/>residual,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1Schema" kindref="compound">Schema</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a7f823efb8526013feafbb4481f3eaa34" kindref="member">readSchema</ref>)<sp/>{</highlight></codeline>
<codeline lineno="348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">boolean</highlight><highlight class="normal"><sp/>applyResidual<sp/>=</highlight></codeline>
<codeline lineno="349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>!<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a2ea10ac3099b01589fadf94e40aed0be" kindref="member">context</ref>.getConfiguration().getBoolean(<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig" kindref="compound">InputFormatConfig</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig_1a6bbd2adff46bc725ad08dc9e19385a80" kindref="member">SKIP_RESIDUAL_FILTERING</ref>,<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="350"><highlight class="normal"></highlight></codeline>
<codeline lineno="351"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(applyResidual<sp/>&amp;&amp;<sp/>residual<sp/>!=<sp/></highlight><highlight class="keyword">null</highlight><highlight class="normal"><sp/>&amp;&amp;<sp/>residual<sp/>!=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1Expressions" kindref="compound">Expressions</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1Expressions_1a53d1494a86985c74259aa1f8982e55c2" kindref="member">alwaysTrue</ref>())<sp/>{</highlight></codeline>
<codeline lineno="352"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Date<sp/>and<sp/>timestamp<sp/>values<sp/>are<sp/>not<sp/>the<sp/>correct<sp/>type<sp/>for<sp/>Evaluator.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="353"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Wrapping<sp/>to<sp/>return<sp/>the<sp/>expected<sp/>type.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="354"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1data_1_1InternalRecordWrapper" kindref="compound">InternalRecordWrapper</ref><sp/>wrapper<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1data_1_1InternalRecordWrapper" kindref="compound">InternalRecordWrapper</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a7f823efb8526013feafbb4481f3eaa34" kindref="member">readSchema</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1Schema_1a6f726c07b15a68fc5cb6e1b1e185876c" kindref="member">asStruct</ref>());</highlight></codeline>
<codeline lineno="355"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1Evaluator" kindref="compound">Evaluator</ref><sp/>filter<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1Evaluator" kindref="compound">Evaluator</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a7f823efb8526013feafbb4481f3eaa34" kindref="member">readSchema</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1Schema_1a6f726c07b15a68fc5cb6e1b1e185876c" kindref="member">asStruct</ref>(),<sp/>residual,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1ad1bc9ce77b2a24e785f3251f4e5ff6cc" kindref="member">caseSensitive</ref>);</highlight></codeline>
<codeline lineno="356"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1io_1_1CloseableIterable" kindref="compound">CloseableIterable</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1io_1_1CloseableIterable_1af0c1d3147c28f2dc62bce032b04b4642" kindref="member">filter</ref>(</highlight></codeline>
<codeline lineno="357"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>iter,<sp/>record<sp/>-&gt;<sp/>filter.<ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1Evaluator_1a01c202fd06afa9c26aedd2d165044a2f" kindref="member">eval</ref>(wrapper.<ref refid="classorg_1_1apache_1_1iceberg_1_1data_1_1InternalRecordWrapper_1aa918c5264cfca327d2588367d3878181" kindref="member">wrap</ref>((<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1StructLike" kindref="compound">StructLike</ref>)<sp/>record)));</highlight></codeline>
<codeline lineno="358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>iter;</highlight></codeline>
<codeline lineno="360"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="361"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="362"><highlight class="normal"></highlight></codeline>
<codeline lineno="363" refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a329f4161ff9d7bcce60d04981150563a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1io_1_1CloseableIterable" kindref="compound">CloseableIterable&lt;T&gt;</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a329f4161ff9d7bcce60d04981150563a" kindref="member">newAvroIterable</ref>(</highlight></codeline>
<codeline lineno="364"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1io_1_1InputFile" kindref="compound">InputFile</ref><sp/>inputFile,<sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1FileScanTask" kindref="compound">FileScanTask</ref><sp/>task,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1Schema" kindref="compound">Schema</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a7f823efb8526013feafbb4481f3eaa34" kindref="member">readSchema</ref>)<sp/>{</highlight></codeline>
<codeline lineno="365"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1avro_1_1Avro" kindref="compound">Avro</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1avro_1_1Avro_1_1ReadBuilder" kindref="compound">ReadBuilder</ref><sp/>avroReadBuilder<sp/>=</highlight></codeline>
<codeline lineno="366"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1avro_1_1Avro" kindref="compound">Avro</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1avro_1_1Avro_1a9e6d65397bc3f258a3e8b00432e9abe9" kindref="member">read</ref>(inputFile).<ref refid="classorg_1_1apache_1_1iceberg_1_1avro_1_1Avro_1_1ReadBuilder_1ae6df932b4e718ded1aef45cf2cec95bc" kindref="member">project</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a7f823efb8526013feafbb4481f3eaa34" kindref="member">readSchema</ref>).<ref refid="classorg_1_1apache_1_1iceberg_1_1avro_1_1Avro_1_1ReadBuilder_1a1f73fc61c1e3aa861c922f0e41ee9365" kindref="member">split</ref>(task.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1ContentScanTask_1a7e54ed62ec2bba438912f04b17e62e6b" kindref="member">start</ref>(),<sp/>task.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1ContentScanTask_1a6daf95d6bf158b0fc709102af76b0fb2" kindref="member">length</ref>());</highlight></codeline>
<codeline lineno="367"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a81bae73eb26c1d1bff88376f38919511" kindref="member">reuseContainers</ref>)<sp/>{</highlight></codeline>
<codeline lineno="368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>avroReadBuilder.<ref refid="classorg_1_1apache_1_1iceberg_1_1avro_1_1Avro_1_1ReadBuilder_1ae54d808c5f9ae910c19fb7496718bda9" kindref="member">reuseContainers</ref>();</highlight></codeline>
<codeline lineno="369"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="370"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a105758531eb1302fa58eb687ad095138" kindref="member">nameMapping</ref><sp/>!=<sp/></highlight><highlight class="keyword">null</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="371"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>avroReadBuilder.withNameMapping(<ref refid="classorg_1_1apache_1_1iceberg_1_1mapping_1_1NameMappingParser" kindref="compound">NameMappingParser</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1mapping_1_1NameMappingParser_1afeea97b0984ec884ef122edf92f018c2" kindref="member">fromJson</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a105758531eb1302fa58eb687ad095138" kindref="member">nameMapping</ref>));</highlight></codeline>
<codeline lineno="372"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="373"><highlight class="normal"></highlight></codeline>
<codeline lineno="374"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1ae4f9363ecd1573c310b58d8ee7af85b9" kindref="member">inMemoryDataModel</ref>)<sp/>{</highlight></codeline>
<codeline lineno="375"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>PIG:</highlight></codeline>
<codeline lineno="376"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>HIVE:</highlight></codeline>
<codeline lineno="377"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>TODO<sp/>implement<sp/>value<sp/>readers<sp/>for<sp/>Pig<sp/>and<sp/>Hive</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="378"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>UnsupportedOperationException(</highlight></codeline>
<codeline lineno="379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Avro<sp/>support<sp/>not<sp/>yet<sp/>supported<sp/>for<sp/>Pig<sp/>and<sp/>Hive&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>GENERIC:</highlight></codeline>
<codeline lineno="381"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>avroReadBuilder.createReaderFunc(</highlight></codeline>
<codeline lineno="382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(expIcebergSchema,<sp/>expAvroSchema)<sp/>-&gt;</highlight></codeline>
<codeline lineno="383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1data_1_1avro_1_1DataReader" kindref="compound">DataReader</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1data_1_1avro_1_1DataReader_1a41a037ffe1c3e9acefabba9a6167c55e" kindref="member">create</ref>(</highlight></codeline>
<codeline lineno="384"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>expIcebergSchema,</highlight></codeline>
<codeline lineno="385"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>expAvroSchema,</highlight></codeline>
<codeline lineno="386"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a5f97b19975c937f67413f9990b009f87" kindref="member">constantsMap</ref>(task,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1data_1_1IdentityPartitionConverters_1a0e18d252f24cd3d6bddc63efb07a977c" kindref="member">IdentityPartitionConverters::convertConstant</ref>)));</highlight></codeline>
<codeline lineno="387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="388"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a713dc8aa741e258cb9fe81b92f1d4f12" kindref="member">applyResidualFiltering</ref>(avroReadBuilder.build(),<sp/>task.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1ContentScanTask_1a4ae34a267f46388574e381ff3be55a1a" kindref="member">residual</ref>(),<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a7f823efb8526013feafbb4481f3eaa34" kindref="member">readSchema</ref>);</highlight></codeline>
<codeline lineno="389"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="390"><highlight class="normal"></highlight></codeline>
<codeline lineno="391" refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1acf12e72ec41a6818bf5ef95d5ed76b86" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1io_1_1CloseableIterable" kindref="compound">CloseableIterable&lt;T&gt;</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1acf12e72ec41a6818bf5ef95d5ed76b86" kindref="member">newParquetIterable</ref>(</highlight></codeline>
<codeline lineno="392"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1io_1_1InputFile" kindref="compound">InputFile</ref><sp/>inputFile,<sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1FileScanTask" kindref="compound">FileScanTask</ref><sp/>task,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1Schema" kindref="compound">Schema</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a7f823efb8526013feafbb4481f3eaa34" kindref="member">readSchema</ref>)<sp/>{</highlight></codeline>
<codeline lineno="393"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Map&lt;Integer,<sp/>?&gt;<sp/>idToConstant<sp/>=</highlight></codeline>
<codeline lineno="394"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a5f97b19975c937f67413f9990b009f87" kindref="member">constantsMap</ref>(task,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1data_1_1IdentityPartitionConverters_1a0e18d252f24cd3d6bddc63efb07a977c" kindref="member">IdentityPartitionConverters::convertConstant</ref>);</highlight></codeline>
<codeline lineno="395"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1io_1_1CloseableIterable" kindref="compound">CloseableIterable&lt;T&gt;</ref><sp/>parquetIterator<sp/>=<sp/></highlight><highlight class="keyword">null</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="396"><highlight class="normal"></highlight></codeline>
<codeline lineno="397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1ae4f9363ecd1573c310b58d8ee7af85b9" kindref="member">inMemoryDataModel</ref>)<sp/>{</highlight></codeline>
<codeline lineno="398"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>PIG:</highlight></codeline>
<codeline lineno="399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>UnsupportedOperationException(</highlight><highlight class="stringliteral">&quot;Parquet<sp/>support<sp/>not<sp/>yet<sp/>supported<sp/>for<sp/>Pig&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>HIVE:</highlight></codeline>
<codeline lineno="401"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="enumorg_1_1apache_1_1iceberg_1_1hive_1_1HiveVersion" kindref="compound">HiveVersion</ref>.<ref refid="enumorg_1_1apache_1_1iceberg_1_1hive_1_1HiveVersion_1aee5485bc45b3c964e0d33c5aaeab20f1" kindref="member">min</ref>(<ref refid="enumorg_1_1apache_1_1iceberg_1_1hive_1_1HiveVersion" kindref="compound">HiveVersion</ref>.<ref refid="enumorg_1_1apache_1_1iceberg_1_1hive_1_1HiveVersion_1a52d88cb7388568934d0e724a593412bc" kindref="member">HIVE_3</ref>))<sp/>{</highlight></codeline>
<codeline lineno="402"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>parquetIterator<sp/>=</highlight></codeline>
<codeline lineno="403"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1adef9e08a6bf483d1c33462e3a3bf166b" kindref="member">HIVE_VECTORIZED_READER_BUILDER</ref>.invoke(inputFile,<sp/>task,<sp/>idToConstant,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a2ea10ac3099b01589fadf94e40aed0be" kindref="member">context</ref>);</highlight></codeline>
<codeline lineno="404"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="405"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>UnsupportedOperationException(</highlight></codeline>
<codeline lineno="406"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Vectorized<sp/>read<sp/>is<sp/>unsupported<sp/>for<sp/>Hive<sp/>2<sp/>integration.&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="407"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="408"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="409"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>GENERIC:</highlight></codeline>
<codeline lineno="410"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1parquet_1_1Parquet" kindref="compound">Parquet</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1parquet_1_1Parquet_1_1ReadBuilder" kindref="compound">ReadBuilder</ref><sp/>parquetReadBuilder<sp/>=</highlight></codeline>
<codeline lineno="411"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1parquet_1_1Parquet" kindref="compound">Parquet</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1parquet_1_1Parquet_1ac0214f32d0db284f0694a1a037c3ed11" kindref="member">read</ref>(inputFile)</highlight></codeline>
<codeline lineno="412"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.<ref refid="classorg_1_1apache_1_1iceberg_1_1parquet_1_1Parquet_1_1ReadBuilder_1ac0e8c1dc351be9622a0692d0fb82fef4" kindref="member">project</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a7f823efb8526013feafbb4481f3eaa34" kindref="member">readSchema</ref>)</highlight></codeline>
<codeline lineno="413"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.<ref refid="classorg_1_1apache_1_1iceberg_1_1parquet_1_1Parquet_1_1ReadBuilder_1a574401000044ceb8b5eab2f8cf562ecd" kindref="member">filter</ref>(task.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1ContentScanTask_1a4ae34a267f46388574e381ff3be55a1a" kindref="member">residual</ref>())</highlight></codeline>
<codeline lineno="414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.caseSensitive(<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1ad1bc9ce77b2a24e785f3251f4e5ff6cc" kindref="member">caseSensitive</ref>)</highlight></codeline>
<codeline lineno="415"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.split(task.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1ContentScanTask_1a7e54ed62ec2bba438912f04b17e62e6b" kindref="member">start</ref>(),<sp/>task.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1ContentScanTask_1a6daf95d6bf158b0fc709102af76b0fb2" kindref="member">length</ref>());</highlight></codeline>
<codeline lineno="416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a81bae73eb26c1d1bff88376f38919511" kindref="member">reuseContainers</ref>)<sp/>{</highlight></codeline>
<codeline lineno="417"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>parquetReadBuilder.reuseContainers();</highlight></codeline>
<codeline lineno="418"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="419"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a105758531eb1302fa58eb687ad095138" kindref="member">nameMapping</ref><sp/>!=<sp/></highlight><highlight class="keyword">null</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="420"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>parquetReadBuilder.withNameMapping(<ref refid="classorg_1_1apache_1_1iceberg_1_1mapping_1_1NameMappingParser" kindref="compound">NameMappingParser</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1mapping_1_1NameMappingParser_1afeea97b0984ec884ef122edf92f018c2" kindref="member">fromJson</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a105758531eb1302fa58eb687ad095138" kindref="member">nameMapping</ref>));</highlight></codeline>
<codeline lineno="421"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="422"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>parquetReadBuilder.createReaderFunc(</highlight></codeline>
<codeline lineno="423"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fileSchema<sp/>-&gt;</highlight></codeline>
<codeline lineno="424"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1data_1_1parquet_1_1GenericParquetReaders" kindref="compound">GenericParquetReaders</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1data_1_1parquet_1_1GenericParquetReaders_1a0fa59f6c68804bfb00986d440d215647" kindref="member">buildReader</ref>(</highlight></codeline>
<codeline lineno="425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a7f823efb8526013feafbb4481f3eaa34" kindref="member">readSchema</ref>,</highlight></codeline>
<codeline lineno="426"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fileSchema,</highlight></codeline>
<codeline lineno="427"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a5f97b19975c937f67413f9990b009f87" kindref="member">constantsMap</ref>(task,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1data_1_1IdentityPartitionConverters_1a0e18d252f24cd3d6bddc63efb07a977c" kindref="member">IdentityPartitionConverters::convertConstant</ref>)));</highlight></codeline>
<codeline lineno="428"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>parquetIterator<sp/>=<sp/>parquetReadBuilder.build();</highlight></codeline>
<codeline lineno="429"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="430"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a713dc8aa741e258cb9fe81b92f1d4f12" kindref="member">applyResidualFiltering</ref>(parquetIterator,<sp/>task.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1ContentScanTask_1a4ae34a267f46388574e381ff3be55a1a" kindref="member">residual</ref>(),<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a7f823efb8526013feafbb4481f3eaa34" kindref="member">readSchema</ref>);</highlight></codeline>
<codeline lineno="431"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="432"><highlight class="normal"></highlight></codeline>
<codeline lineno="433" refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a2068171d40fbc1191f6f08454dab860a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1io_1_1CloseableIterable" kindref="compound">CloseableIterable&lt;T&gt;</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a2068171d40fbc1191f6f08454dab860a" kindref="member">newOrcIterable</ref>(</highlight></codeline>
<codeline lineno="434"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1io_1_1InputFile" kindref="compound">InputFile</ref><sp/>inputFile,<sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1FileScanTask" kindref="compound">FileScanTask</ref><sp/>task,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1Schema" kindref="compound">Schema</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a7f823efb8526013feafbb4481f3eaa34" kindref="member">readSchema</ref>)<sp/>{</highlight></codeline>
<codeline lineno="435"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Map&lt;Integer,<sp/>?&gt;<sp/>idToConstant<sp/>=</highlight></codeline>
<codeline lineno="436"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a5f97b19975c937f67413f9990b009f87" kindref="member">constantsMap</ref>(task,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1data_1_1IdentityPartitionConverters_1a0e18d252f24cd3d6bddc63efb07a977c" kindref="member">IdentityPartitionConverters::convertConstant</ref>);</highlight></codeline>
<codeline lineno="437"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1Schema" kindref="compound">Schema</ref><sp/>readSchemaWithoutConstantAndMetadataFields<sp/>=</highlight></codeline>
<codeline lineno="438"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1types_1_1TypeUtil" kindref="compound">TypeUtil</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1types_1_1TypeUtil_1a6d1f98fe744f7754c75d00c4c15cf8f6" kindref="member">selectNot</ref>(</highlight></codeline>
<codeline lineno="439"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a7f823efb8526013feafbb4481f3eaa34" kindref="member">readSchema</ref>,<sp/>Sets.union(idToConstant.keySet(),<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1MetadataColumns" kindref="compound">MetadataColumns</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1MetadataColumns_1a133d5915cb1d9fd251e62ad4dad2bc1c" kindref="member">metadataFieldIds</ref>()));</highlight></codeline>
<codeline lineno="440"><highlight class="normal"></highlight></codeline>
<codeline lineno="441"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1io_1_1CloseableIterable" kindref="compound">CloseableIterable&lt;T&gt;</ref><sp/>orcIterator<sp/>=<sp/></highlight><highlight class="keyword">null</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="442"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>ORC<sp/>does<sp/>not<sp/>support<sp/>reuse<sp/>containers<sp/>yet</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="443"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1ae4f9363ecd1573c310b58d8ee7af85b9" kindref="member">inMemoryDataModel</ref>)<sp/>{</highlight></codeline>
<codeline lineno="444"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>PIG:</highlight></codeline>
<codeline lineno="445"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>TODO:<sp/>implement<sp/>value<sp/>readers<sp/>for<sp/>Pig</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="446"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>UnsupportedOperationException(</highlight><highlight class="stringliteral">&quot;ORC<sp/>support<sp/>not<sp/>yet<sp/>supported<sp/>for<sp/>Pig&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="447"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>HIVE:</highlight></codeline>
<codeline lineno="448"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="enumorg_1_1apache_1_1iceberg_1_1hive_1_1HiveVersion" kindref="compound">HiveVersion</ref>.<ref refid="enumorg_1_1apache_1_1iceberg_1_1hive_1_1HiveVersion_1aee5485bc45b3c964e0d33c5aaeab20f1" kindref="member">min</ref>(<ref refid="enumorg_1_1apache_1_1iceberg_1_1hive_1_1HiveVersion" kindref="compound">HiveVersion</ref>.<ref refid="enumorg_1_1apache_1_1iceberg_1_1hive_1_1HiveVersion_1a52d88cb7388568934d0e724a593412bc" kindref="member">HIVE_3</ref>))<sp/>{</highlight></codeline>
<codeline lineno="449"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>orcIterator<sp/>=</highlight></codeline>
<codeline lineno="450"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1adef9e08a6bf483d1c33462e3a3bf166b" kindref="member">HIVE_VECTORIZED_READER_BUILDER</ref>.invoke(inputFile,<sp/>task,<sp/>idToConstant,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a2ea10ac3099b01589fadf94e40aed0be" kindref="member">context</ref>);</highlight></codeline>
<codeline lineno="451"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="452"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>UnsupportedOperationException(</highlight></codeline>
<codeline lineno="453"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Vectorized<sp/>read<sp/>is<sp/>unsupported<sp/>for<sp/>Hive<sp/>2<sp/>integration.&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="454"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="455"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="456"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>GENERIC:</highlight></codeline>
<codeline lineno="457"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1orc_1_1ORC" kindref="compound">ORC</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1orc_1_1ORC_1_1ReadBuilder" kindref="compound">ReadBuilder</ref><sp/>orcReadBuilder<sp/>=</highlight></codeline>
<codeline lineno="458"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1orc_1_1ORC" kindref="compound">ORC</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1orc_1_1ORC_1a251e8cd25820d05ddc8710bc462d3ca1" kindref="member">read</ref>(inputFile)</highlight></codeline>
<codeline lineno="459"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.<ref refid="classorg_1_1apache_1_1iceberg_1_1orc_1_1ORC_1_1ReadBuilder_1ae800ef40c07b7b2b19c3d5e504ca187d" kindref="member">project</ref>(readSchemaWithoutConstantAndMetadataFields)</highlight></codeline>
<codeline lineno="460"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.<ref refid="classorg_1_1apache_1_1iceberg_1_1orc_1_1ORC_1_1ReadBuilder_1a1e4b224864ff430836b60fcbfa8a84b1" kindref="member">filter</ref>(task.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1ContentScanTask_1a4ae34a267f46388574e381ff3be55a1a" kindref="member">residual</ref>())</highlight></codeline>
<codeline lineno="461"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.caseSensitive(<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1ad1bc9ce77b2a24e785f3251f4e5ff6cc" kindref="member">caseSensitive</ref>)</highlight></codeline>
<codeline lineno="462"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.split(task.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1ContentScanTask_1a7e54ed62ec2bba438912f04b17e62e6b" kindref="member">start</ref>(),<sp/>task.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1ContentScanTask_1a6daf95d6bf158b0fc709102af76b0fb2" kindref="member">length</ref>());</highlight></codeline>
<codeline lineno="463"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>orcReadBuilder.createReaderFunc(</highlight></codeline>
<codeline lineno="464"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fileSchema<sp/>-&gt;<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1data_1_1orc_1_1GenericOrcReader" kindref="compound">GenericOrcReader</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1data_1_1orc_1_1GenericOrcReader_1a9d276527099e837a4e5e3736b3c27122" kindref="member">buildReader</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a7f823efb8526013feafbb4481f3eaa34" kindref="member">readSchema</ref>,<sp/>fileSchema,<sp/>idToConstant));</highlight></codeline>
<codeline lineno="465"><highlight class="normal"></highlight></codeline>
<codeline lineno="466"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a105758531eb1302fa58eb687ad095138" kindref="member">nameMapping</ref><sp/>!=<sp/></highlight><highlight class="keyword">null</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="467"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>orcReadBuilder.withNameMapping(<ref refid="classorg_1_1apache_1_1iceberg_1_1mapping_1_1NameMappingParser" kindref="compound">NameMappingParser</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1mapping_1_1NameMappingParser_1afeea97b0984ec884ef122edf92f018c2" kindref="member">fromJson</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a105758531eb1302fa58eb687ad095138" kindref="member">nameMapping</ref>));</highlight></codeline>
<codeline lineno="468"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="469"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>orcIterator<sp/>=<sp/>orcReadBuilder.build();</highlight></codeline>
<codeline lineno="470"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="471"><highlight class="normal"></highlight></codeline>
<codeline lineno="472"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a713dc8aa741e258cb9fe81b92f1d4f12" kindref="member">applyResidualFiltering</ref>(orcIterator,<sp/>task.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1ContentScanTask_1a4ae34a267f46388574e381ff3be55a1a" kindref="member">residual</ref>(),<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a7f823efb8526013feafbb4481f3eaa34" kindref="member">readSchema</ref>);</highlight></codeline>
<codeline lineno="473"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="474"><highlight class="normal"></highlight></codeline>
<codeline lineno="475" refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a5f97b19975c937f67413f9990b009f87" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/>Map&lt;Integer,<sp/>?&gt;<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a5f97b19975c937f67413f9990b009f87" kindref="member">constantsMap</ref>(</highlight></codeline>
<codeline lineno="476"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1FileScanTask" kindref="compound">FileScanTask</ref><sp/>task,<sp/>BiFunction&lt;Type,<sp/>Object,<sp/>Object&gt;<sp/>converter)<sp/>{</highlight></codeline>
<codeline lineno="477"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1PartitionSpec" kindref="compound">PartitionSpec</ref><sp/>spec<sp/>=<sp/>task.spec();</highlight></codeline>
<codeline lineno="478"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Set&lt;Integer&gt;<sp/>idColumns<sp/>=<sp/>spec.<ref refid="classorg_1_1apache_1_1iceberg_1_1PartitionSpec_1af97b45374c593fa329efe24de43918d3" kindref="member">identitySourceIds</ref>();</highlight></codeline>
<codeline lineno="479"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1Schema" kindref="compound">Schema</ref><sp/>partitionSchema<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1types_1_1TypeUtil" kindref="compound">TypeUtil</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1types_1_1TypeUtil_1a0c854e31bbd8d06e9419101da7543ecd" kindref="member">select</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1aad7a5a6d1ed633dcfad286fdbc8966f2" kindref="member">expectedSchema</ref>,<sp/>idColumns);</highlight></codeline>
<codeline lineno="480"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">boolean</highlight><highlight class="normal"><sp/>projectsIdentityPartitionColumns<sp/>=<sp/>!partitionSchema.<ref refid="classorg_1_1apache_1_1iceberg_1_1Schema_1a503ecd80a74c35c4b05435bb6afc9415" kindref="member">columns</ref>().isEmpty();</highlight></codeline>
<codeline lineno="481"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(projectsIdentityPartitionColumns)<sp/>{</highlight></codeline>
<codeline lineno="482"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1util_1_1PartitionUtil" kindref="compound">PartitionUtil</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1util_1_1PartitionUtil_1a47ff6014506d970fc054a62513c2bcd9" kindref="member">constantsMap</ref>(task,<sp/>converter);</highlight></codeline>
<codeline lineno="483"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="484"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>Collections.emptyMap();</highlight></codeline>
<codeline lineno="485"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="486"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="487"><highlight class="normal"></highlight></codeline>
<codeline lineno="488" refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a7f823efb8526013feafbb4481f3eaa34" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1Schema" kindref="compound">Schema</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a7f823efb8526013feafbb4481f3eaa34" kindref="member">readSchema</ref>(</highlight></codeline>
<codeline lineno="489"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Configuration<sp/>conf,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1Schema" kindref="compound">Schema</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1ad9827c86694a71be9b52c1acabbaa056" kindref="member">tableSchema</ref>,<sp/></highlight><highlight class="keywordtype">boolean</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1ad1bc9ce77b2a24e785f3251f4e5ff6cc" kindref="member">caseSensitive</ref>)<sp/>{</highlight></codeline>
<codeline lineno="490"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1Schema" kindref="compound">Schema</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a7f823efb8526013feafbb4481f3eaa34" kindref="member">readSchema</ref><sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig" kindref="compound">InputFormatConfig</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig_1a72e4b94e0e2dcdfc031b6c950d87d8e1" kindref="member">readSchema</ref>(conf);</highlight></codeline>
<codeline lineno="491"><highlight class="normal"></highlight></codeline>
<codeline lineno="492"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a7f823efb8526013feafbb4481f3eaa34" kindref="member">readSchema</ref><sp/>!=<sp/></highlight><highlight class="keyword">null</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="493"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1a7f823efb8526013feafbb4481f3eaa34" kindref="member">readSchema</ref>;</highlight></codeline>
<codeline lineno="494"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="495"><highlight class="normal"></highlight></codeline>
<codeline lineno="496"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>String[]<sp/>selectedColumns<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig" kindref="compound">InputFormatConfig</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1InputFormatConfig_1aab787117773dab7d8dd83d9cdebceddf" kindref="member">selectedColumns</ref>(conf);</highlight></codeline>
<codeline lineno="497"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(selectedColumns<sp/>==<sp/></highlight><highlight class="keyword">null</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="498"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1ad9827c86694a71be9b52c1acabbaa056" kindref="member">tableSchema</ref>;</highlight></codeline>
<codeline lineno="499"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="500"><highlight class="normal"></highlight></codeline>
<codeline lineno="501"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1ad1bc9ce77b2a24e785f3251f4e5ff6cc" kindref="member">caseSensitive</ref></highlight></codeline>
<codeline lineno="502"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>?<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1ad9827c86694a71be9b52c1acabbaa056" kindref="member">tableSchema</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1Schema_1a13e0f0b3d610479b4e2e500c11fa6e5d" kindref="member">select</ref>(selectedColumns)</highlight></codeline>
<codeline lineno="503"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1mr_1_1mapreduce_1_1IcebergInputFormat_1_1IcebergRecordReader_1ad9827c86694a71be9b52c1acabbaa056" kindref="member">tableSchema</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1Schema_1a5834cce2d552e0e24d5d8294133fb881" kindref="member">caseInsensitiveSelect</ref>(selectedColumns);</highlight></codeline>
<codeline lineno="504"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="505"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="506"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="mr/src/main/java/org/apache/iceberg/mr/mapreduce/IcebergInputFormat.java"/>
  </compounddef>
</doxygen>
