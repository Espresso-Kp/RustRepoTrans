<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.17">
  <compounddef id="SizeBasedFileRewriter_8java" kind="file" language="Java">
    <compoundname>SizeBasedFileRewriter.java</compoundname>
    <innerclass refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter" prot="public">org::apache::iceberg::actions::SizeBasedFileRewriter</innerclass>
    <innernamespace refid="namespaceorg_1_1apache_1_1iceberg_1_1actions">org::apache::iceberg::actions</innernamespace>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">/*</highlight></codeline>
<codeline lineno="2"><highlight class="comment"><sp/>*<sp/>Licensed<sp/>to<sp/>the<sp/>Apache<sp/>Software<sp/>Foundation<sp/>(ASF)<sp/>under<sp/>one</highlight></codeline>
<codeline lineno="3"><highlight class="comment"><sp/>*<sp/>or<sp/>more<sp/>contributor<sp/>license<sp/>agreements.<sp/><sp/>See<sp/>the<sp/>NOTICE<sp/>file</highlight></codeline>
<codeline lineno="4"><highlight class="comment"><sp/>*<sp/>distributed<sp/>with<sp/>this<sp/>work<sp/>for<sp/>additional<sp/>information</highlight></codeline>
<codeline lineno="5"><highlight class="comment"><sp/>*<sp/>regarding<sp/>copyright<sp/>ownership.<sp/><sp/>The<sp/>ASF<sp/>licenses<sp/>this<sp/>file</highlight></codeline>
<codeline lineno="6"><highlight class="comment"><sp/>*<sp/>to<sp/>you<sp/>under<sp/>the<sp/>Apache<sp/>License,<sp/>Version<sp/>2.0<sp/>(the</highlight></codeline>
<codeline lineno="7"><highlight class="comment"><sp/>*<sp/>&quot;License&quot;);<sp/>you<sp/>may<sp/>not<sp/>use<sp/>this<sp/>file<sp/>except<sp/>in<sp/>compliance</highlight></codeline>
<codeline lineno="8"><highlight class="comment"><sp/>*<sp/>with<sp/>the<sp/>License.<sp/><sp/>You<sp/>may<sp/>obtain<sp/>a<sp/>copy<sp/>of<sp/>the<sp/>License<sp/>at</highlight></codeline>
<codeline lineno="9"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="10"><highlight class="comment"><sp/>*<sp/><sp/><sp/>http://www.apache.org/licenses/LICENSE-2.0</highlight></codeline>
<codeline lineno="11"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="12"><highlight class="comment"><sp/>*<sp/>Unless<sp/>required<sp/>by<sp/>applicable<sp/>law<sp/>or<sp/>agreed<sp/>to<sp/>in<sp/>writing,</highlight></codeline>
<codeline lineno="13"><highlight class="comment"><sp/>*<sp/>software<sp/>distributed<sp/>under<sp/>the<sp/>License<sp/>is<sp/>distributed<sp/>on<sp/>an</highlight></codeline>
<codeline lineno="14"><highlight class="comment"><sp/>*<sp/>&quot;AS<sp/>IS&quot;<sp/>BASIS,<sp/>WITHOUT<sp/>WARRANTIES<sp/>OR<sp/>CONDITIONS<sp/>OF<sp/>ANY</highlight></codeline>
<codeline lineno="15"><highlight class="comment"><sp/>*<sp/>KIND,<sp/>either<sp/>express<sp/>or<sp/>implied.<sp/><sp/>See<sp/>the<sp/>License<sp/>for<sp/>the</highlight></codeline>
<codeline lineno="16"><highlight class="comment"><sp/>*<sp/>specific<sp/>language<sp/>governing<sp/>permissions<sp/>and<sp/>limitations</highlight></codeline>
<codeline lineno="17"><highlight class="comment"><sp/>*<sp/>under<sp/>the<sp/>License.</highlight></codeline>
<codeline lineno="18"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="19"><highlight class="normal"></highlight><highlight class="keyword">package<sp/></highlight><highlight class="normal">org.apache.iceberg.actions;</highlight></codeline>
<codeline lineno="20"><highlight class="normal"></highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>java.math.RoundingMode;</highlight></codeline>
<codeline lineno="22"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>java.util.List;</highlight></codeline>
<codeline lineno="23"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>java.util.Map;</highlight></codeline>
<codeline lineno="24"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>java.util.Set;</highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1ContentFile" kindref="compound">ContentFile</ref>;</highlight></codeline>
<codeline lineno="26"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1ContentScanTask" kindref="compound">ContentScanTask</ref>;</highlight></codeline>
<codeline lineno="27"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1PartitionSpec" kindref="compound">PartitionSpec</ref>;</highlight></codeline>
<codeline lineno="28"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Table" kindref="compound">Table</ref>;</highlight></codeline>
<codeline lineno="29"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.relocated.com.google.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1common" kindref="compound">common</ref>.base.<ref refid="classorg_1_1apache_1_1iceberg_1_1relocated_1_1com_1_1google_1_1common_1_1base_1_1Preconditions" kindref="compound">Preconditions</ref>;</highlight></codeline>
<codeline lineno="30"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.relocated.com.google.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1common" kindref="compound">common</ref>.collect.ImmutableSet;</highlight></codeline>
<codeline lineno="31"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.relocated.com.google.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1common" kindref="compound">common</ref>.collect.<ref refid="classorg_1_1apache_1_1iceberg_1_1relocated_1_1com_1_1google_1_1common_1_1collect_1_1Maps" kindref="compound">Maps</ref>;</highlight></codeline>
<codeline lineno="32"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.relocated.com.google.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1common" kindref="compound">common</ref>.math.LongMath;</highlight></codeline>
<codeline lineno="33"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1util" kindref="compound">util</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1util_1_1BinPacking" kindref="compound">BinPacking</ref>;</highlight></codeline>
<codeline lineno="34"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1util" kindref="compound">util</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1util_1_1PropertyUtil" kindref="compound">PropertyUtil</ref>;</highlight></codeline>
<codeline lineno="35"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.slf4j.Logger;</highlight></codeline>
<codeline lineno="36"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.slf4j.LoggerFactory;</highlight></codeline>
<codeline lineno="37"><highlight class="normal"></highlight></codeline>
<codeline lineno="51" refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter" refkind="compound"><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">abstract</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter" kindref="compound">SizeBasedFileRewriter</ref>&lt;T<sp/></highlight><highlight class="keyword">extends</highlight><highlight class="normal"><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1ContentScanTask" kindref="compound">ContentScanTask</ref>&lt;F&gt;,<sp/>F<sp/>extends<sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1ContentFile" kindref="compound">ContentFile</ref>&lt;F&gt;&gt;</highlight></codeline>
<codeline lineno="52"><highlight class="normal"><sp/><sp/><sp/><sp/>implements<sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1actions_1_1FileRewriter" kindref="compound">FileRewriter</ref>&lt;T,<sp/>F&gt;<sp/>{</highlight></codeline>
<codeline lineno="53"><highlight class="normal"></highlight></codeline>
<codeline lineno="54" refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1af9c05e8c32319b63e846f76e24beafe3" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/>Logger<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1af9c05e8c32319b63e846f76e24beafe3" kindref="member">LOG</ref><sp/>=<sp/>LoggerFactory.getLogger(<ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter" kindref="compound">SizeBasedFileRewriter</ref>.class);</highlight></codeline>
<codeline lineno="55"><highlight class="normal"></highlight></codeline>
<codeline lineno="57" refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1aab04bf81c3abcc6f18a0da334f5c6e39" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/>String<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1aab04bf81c3abcc6f18a0da334f5c6e39" kindref="member">TARGET_FILE_SIZE_BYTES</ref><sp/>=<sp/></highlight><highlight class="stringliteral">&quot;target-file-size-bytes&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="58"><highlight class="normal"></highlight></codeline>
<codeline lineno="65" refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a3f3cf26ef7f474d6d004508408b8befe" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/>String<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a3f3cf26ef7f474d6d004508408b8befe" kindref="member">MIN_FILE_SIZE_BYTES</ref><sp/>=<sp/></highlight><highlight class="stringliteral">&quot;min-file-size-bytes&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="66"><highlight class="normal"></highlight></codeline>
<codeline lineno="67" refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1aa7c0e05985db76fccf853031240efab4" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1aa7c0e05985db76fccf853031240efab4" kindref="member">MIN_FILE_SIZE_DEFAULT_RATIO</ref><sp/>=<sp/>0.75;</highlight></codeline>
<codeline lineno="68"><highlight class="normal"></highlight></codeline>
<codeline lineno="75" refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a9410fbbd5f47fbaad62a474a84bd308c" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/>String<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a9410fbbd5f47fbaad62a474a84bd308c" kindref="member">MAX_FILE_SIZE_BYTES</ref><sp/>=<sp/></highlight><highlight class="stringliteral">&quot;max-file-size-bytes&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="76"><highlight class="normal"></highlight></codeline>
<codeline lineno="77" refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1ae3d09c925f5a12c32ccfa4a6aaf53986" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1ae3d09c925f5a12c32ccfa4a6aaf53986" kindref="member">MAX_FILE_SIZE_DEFAULT_RATIO</ref><sp/>=<sp/>1.80;</highlight></codeline>
<codeline lineno="78"><highlight class="normal"></highlight></codeline>
<codeline lineno="85" refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1aaa006b368397ad09b40ac5381939343b" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/>String<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1aaa006b368397ad09b40ac5381939343b" kindref="member">MIN_INPUT_FILES</ref><sp/>=<sp/></highlight><highlight class="stringliteral">&quot;min-input-files&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="86"><highlight class="normal"></highlight></codeline>
<codeline lineno="87" refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a63ed3f460dbc8e89878de9a8cd5260ed" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a63ed3f460dbc8e89878de9a8cd5260ed" kindref="member">MIN_INPUT_FILES_DEFAULT</ref><sp/>=<sp/>5;</highlight></codeline>
<codeline lineno="88"><highlight class="normal"></highlight></codeline>
<codeline lineno="90" refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a2e2947b376e73d2bb86e83a544fce411" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/>String<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a2e2947b376e73d2bb86e83a544fce411" kindref="member">REWRITE_ALL</ref><sp/>=<sp/></highlight><highlight class="stringliteral">&quot;rewrite-all&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="91"><highlight class="normal"></highlight></codeline>
<codeline lineno="92" refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1aee01234f63b23baa93d631de7a2d2fa4" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">boolean</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1aee01234f63b23baa93d631de7a2d2fa4" kindref="member">REWRITE_ALL_DEFAULT</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="93"><highlight class="normal"></highlight></codeline>
<codeline lineno="101" refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1ae8e3a7245f2db52b3bfe5094b10d98ed" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/>String<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1ae8e3a7245f2db52b3bfe5094b10d98ed" kindref="member">MAX_FILE_GROUP_SIZE_BYTES</ref><sp/>=<sp/></highlight><highlight class="stringliteral">&quot;max-file-group-size-bytes&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="102"><highlight class="normal"></highlight></codeline>
<codeline lineno="103" refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a0dd56ae4a673b02768bf30785949d624" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a0dd56ae4a673b02768bf30785949d624" kindref="member">MAX_FILE_GROUP_SIZE_BYTES_DEFAULT</ref><sp/>=<sp/>100L<sp/>*<sp/>1024<sp/>*<sp/>1024<sp/>*<sp/>1024;<sp/></highlight><highlight class="comment">//<sp/>100<sp/>GB</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="104"><highlight class="normal"></highlight></codeline>
<codeline lineno="105" refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a9621b68dc7a12133f5488abc2d5a7bcd" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a9621b68dc7a12133f5488abc2d5a7bcd" kindref="member">SPLIT_OVERHEAD</ref><sp/>=<sp/>5<sp/>*<sp/>1024;</highlight></codeline>
<codeline lineno="106"><highlight class="normal"></highlight></codeline>
<codeline lineno="107" refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1ad3d9f83ecb95102b2cc23328c02215cd" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Table" kindref="compound">Table</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1ad3d9f83ecb95102b2cc23328c02215cd" kindref="member">table</ref>;</highlight></codeline>
<codeline lineno="108" refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a3cd4b7e33816aeb7655af79cd7dea286" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a3cd4b7e33816aeb7655af79cd7dea286" kindref="member">targetFileSize</ref>;</highlight></codeline>
<codeline lineno="109" refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a97b38c0e90c4c5d64c89fc612d770386" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a97b38c0e90c4c5d64c89fc612d770386" kindref="member">minFileSize</ref>;</highlight></codeline>
<codeline lineno="110" refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a873991443cff01f8074353fc24338e89" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a873991443cff01f8074353fc24338e89" kindref="member">maxFileSize</ref>;</highlight></codeline>
<codeline lineno="111" refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1af32528bb3aa98d6ba900cf2c4193ca4b" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1af32528bb3aa98d6ba900cf2c4193ca4b" kindref="member">minInputFiles</ref>;</highlight></codeline>
<codeline lineno="112" refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1aa490f8e141677dffeaac284ac7854798" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">boolean</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1aa490f8e141677dffeaac284ac7854798" kindref="member">rewriteAll</ref>;</highlight></codeline>
<codeline lineno="113" refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a8575010c63968c23a413c86202f40056" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a8575010c63968c23a413c86202f40056" kindref="member">maxGroupSize</ref>;</highlight></codeline>
<codeline lineno="114"><highlight class="normal"></highlight></codeline>
<codeline lineno="115" refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a83b9e192b6ea222bf89b57d0b55b8b59" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a83b9e192b6ea222bf89b57d0b55b8b59" kindref="member">outputSpecId</ref>;</highlight></codeline>
<codeline lineno="116"><highlight class="normal"></highlight></codeline>
<codeline lineno="117" refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a0ce0cdfe5ed9a4b55704c68bc2a3da7b" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">protected</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a0ce0cdfe5ed9a4b55704c68bc2a3da7b" kindref="member">SizeBasedFileRewriter</ref>(<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Table" kindref="compound">Table</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1ad3d9f83ecb95102b2cc23328c02215cd" kindref="member">table</ref>)<sp/>{</highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/>this.table<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1ad3d9f83ecb95102b2cc23328c02215cd" kindref="member">table</ref>;</highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="120"><highlight class="normal"></highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">protected</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">abstract</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a23c3d626e3e316079ec869959b3e7bab" kindref="member">defaultTargetFileSize</ref>();</highlight></codeline>
<codeline lineno="122"><highlight class="normal"></highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">protected</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">abstract</highlight><highlight class="normal"><sp/>Iterable&lt;T&gt;<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a2cc3f7083078d766758a6aebd2ded455" kindref="member">filterFiles</ref>(Iterable&lt;T&gt;<sp/>tasks);</highlight></codeline>
<codeline lineno="124"><highlight class="normal"></highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">protected</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">abstract</highlight><highlight class="normal"><sp/>Iterable&lt;List&lt;T&gt;&gt;<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a6efd9e736f2cac0af9625d6281bc9fe5" kindref="member">filterFileGroups</ref>(List&lt;List&lt;T&gt;&gt;<sp/>groups);</highlight></codeline>
<codeline lineno="126"><highlight class="normal"></highlight></codeline>
<codeline lineno="127" refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1ab8d30d308c3968f910b98a75e048c7d4" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">protected</highlight><highlight class="normal"><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Table" kindref="compound">Table</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1ab8d30d308c3968f910b98a75e048c7d4" kindref="member">table</ref>()<sp/>{</highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1ad3d9f83ecb95102b2cc23328c02215cd" kindref="member">table</ref>;</highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="130"><highlight class="normal"></highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/>@Override</highlight></codeline>
<codeline lineno="132" refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1abc01328101c82c91f473ef04914284ec" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>Set&lt;String&gt;<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1abc01328101c82c91f473ef04914284ec" kindref="member">validOptions</ref>()<sp/>{</highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ImmutableSet.of(</highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1aab04bf81c3abcc6f18a0da334f5c6e39" kindref="member">TARGET_FILE_SIZE_BYTES</ref>,</highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a3f3cf26ef7f474d6d004508408b8befe" kindref="member">MIN_FILE_SIZE_BYTES</ref>,</highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a9410fbbd5f47fbaad62a474a84bd308c" kindref="member">MAX_FILE_SIZE_BYTES</ref>,</highlight></codeline>
<codeline lineno="137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1aaa006b368397ad09b40ac5381939343b" kindref="member">MIN_INPUT_FILES</ref>,</highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a2e2947b376e73d2bb86e83a544fce411" kindref="member">REWRITE_ALL</ref>,</highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1ae8e3a7245f2db52b3bfe5094b10d98ed" kindref="member">MAX_FILE_GROUP_SIZE_BYTES</ref>);</highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="141"><highlight class="normal"></highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/>@Override</highlight></codeline>
<codeline lineno="143" refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1ade87ca3f0a53158e667ca863fec2c989" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1ade87ca3f0a53158e667ca863fec2c989" kindref="member">init</ref>(Map&lt;String,<sp/>String&gt;<sp/>options)<sp/>{</highlight></codeline>
<codeline lineno="144"><highlight class="normal"><sp/><sp/><sp/><sp/>Map&lt;String,<sp/>Long&gt;<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1ac262f7b4c4592b1c35f581c4890253ef" kindref="member">sizeThresholds</ref><sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1ac262f7b4c4592b1c35f581c4890253ef" kindref="member">sizeThresholds</ref>(options);</highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/><sp/><sp/>this.targetFileSize<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1ac262f7b4c4592b1c35f581c4890253ef" kindref="member">sizeThresholds</ref>.get(<ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1aab04bf81c3abcc6f18a0da334f5c6e39" kindref="member">TARGET_FILE_SIZE_BYTES</ref>);</highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/>this.minFileSize<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1ac262f7b4c4592b1c35f581c4890253ef" kindref="member">sizeThresholds</ref>.get(<ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a3f3cf26ef7f474d6d004508408b8befe" kindref="member">MIN_FILE_SIZE_BYTES</ref>);</highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/>this.maxFileSize<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1ac262f7b4c4592b1c35f581c4890253ef" kindref="member">sizeThresholds</ref>.get(<ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a9410fbbd5f47fbaad62a474a84bd308c" kindref="member">MAX_FILE_SIZE_BYTES</ref>);</highlight></codeline>
<codeline lineno="148"><highlight class="normal"></highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/><sp/><sp/>this.minInputFiles<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1af32528bb3aa98d6ba900cf2c4193ca4b" kindref="member">minInputFiles</ref>(options);</highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/>this.rewriteAll<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1aa490f8e141677dffeaac284ac7854798" kindref="member">rewriteAll</ref>(options);</highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/><sp/><sp/>this.maxGroupSize<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a8575010c63968c23a413c86202f40056" kindref="member">maxGroupSize</ref>(options);</highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/>this.outputSpecId<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a83b9e192b6ea222bf89b57d0b55b8b59" kindref="member">outputSpecId</ref>(options);</highlight></codeline>
<codeline lineno="153"><highlight class="normal"></highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1aa490f8e141677dffeaac284ac7854798" kindref="member">rewriteAll</ref>)<sp/>{</highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1af9c05e8c32319b63e846f76e24beafe3" kindref="member">LOG</ref>.info(</highlight><highlight class="stringliteral">&quot;Configured<sp/>to<sp/>rewrite<sp/>all<sp/>provided<sp/>files<sp/>in<sp/>table<sp/>{}&quot;</highlight><highlight class="normal">,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1ad3d9f83ecb95102b2cc23328c02215cd" kindref="member">table</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Table_1ac3bd999ff367dc8f622ca14e9b85277e" kindref="member">name</ref>());</highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="158"><highlight class="normal"></highlight></codeline>
<codeline lineno="159" refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a6fa9ccfbc8726286b088373bed27d169" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">protected</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">boolean</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a6fa9ccfbc8726286b088373bed27d169" kindref="member">wronglySized</ref>(T<sp/>task)<sp/>{</highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>task.length()<sp/>&lt;<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a97b38c0e90c4c5d64c89fc612d770386" kindref="member">minFileSize</ref><sp/>||<sp/>task.length()<sp/>&gt;<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a873991443cff01f8074353fc24338e89" kindref="member">maxFileSize</ref>;</highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="162"><highlight class="normal"></highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/>@Override</highlight></codeline>
<codeline lineno="164" refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1acee44ad9df0ad12a94941c0606b054c6" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>Iterable&lt;List&lt;T&gt;&gt;<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1acee44ad9df0ad12a94941c0606b054c6" kindref="member">planFileGroups</ref>(Iterable&lt;T&gt;<sp/>tasks)<sp/>{</highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/>Iterable&lt;T&gt;<sp/>filteredTasks<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1aa490f8e141677dffeaac284ac7854798" kindref="member">rewriteAll</ref><sp/>?<sp/>tasks<sp/>:<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a2cc3f7083078d766758a6aebd2ded455" kindref="member">filterFiles</ref>(tasks);</highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1util_1_1BinPacking" kindref="compound">BinPacking</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1util_1_1BinPacking_1_1ListPacker" kindref="compound">ListPacker</ref>&lt;T&gt;<sp/>packer<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1util_1_1BinPacking" kindref="compound">BinPacking</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1util_1_1BinPacking_1_1ListPacker" kindref="compound">ListPacker</ref>&lt;&gt;(<ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a8575010c63968c23a413c86202f40056" kindref="member">maxGroupSize</ref>,<sp/>1,<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/><sp/><sp/>List&lt;List&lt;T&gt;&gt;<sp/>groups<sp/>=<sp/>packer.<ref refid="classorg_1_1apache_1_1iceberg_1_1util_1_1BinPacking_1_1ListPacker_1a0e0f69eb5c066870e9a2395357c15114" kindref="member">pack</ref>(filteredTasks,<sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1ContentScanTask_1a6daf95d6bf158b0fc709102af76b0fb2" kindref="member">ContentScanTask::length</ref>);</highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1aa490f8e141677dffeaac284ac7854798" kindref="member">rewriteAll</ref><sp/>?<sp/>groups<sp/>:<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a6efd9e736f2cac0af9625d6281bc9fe5" kindref="member">filterFileGroups</ref>(groups);</highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="170"><highlight class="normal"></highlight></codeline>
<codeline lineno="171" refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a28aa893b82a39957b152d612e07edf2f" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">protected</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">boolean</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a28aa893b82a39957b152d612e07edf2f" kindref="member">enoughInputFiles</ref>(List&lt;T&gt;<sp/>group)<sp/>{</highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>group.size()<sp/>&gt;<sp/>1<sp/>&amp;&amp;<sp/>group.size()<sp/>&gt;=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1af32528bb3aa98d6ba900cf2c4193ca4b" kindref="member">minInputFiles</ref>;</highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="174"><highlight class="normal"></highlight></codeline>
<codeline lineno="175" refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a10c645e606d5113a45cf7d3c63240ca6" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">protected</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">boolean</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a10c645e606d5113a45cf7d3c63240ca6" kindref="member">enoughContent</ref>(List&lt;T&gt;<sp/>group)<sp/>{</highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>group.size()<sp/>&gt;<sp/>1<sp/>&amp;&amp;<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a89b58b9e846847185042cd3b6933d9d5" kindref="member">inputSize</ref>(group)<sp/>&gt;<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a3cd4b7e33816aeb7655af79cd7dea286" kindref="member">targetFileSize</ref>;</highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="178"><highlight class="normal"></highlight></codeline>
<codeline lineno="179" refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a7700393952f2a6166962a46556305a38" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">protected</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">boolean</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a7700393952f2a6166962a46556305a38" kindref="member">tooMuchContent</ref>(List&lt;T&gt;<sp/>group)<sp/>{</highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a89b58b9e846847185042cd3b6933d9d5" kindref="member">inputSize</ref>(group)<sp/>&gt;<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a873991443cff01f8074353fc24338e89" kindref="member">maxFileSize</ref>;</highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="182"><highlight class="normal"></highlight></codeline>
<codeline lineno="183" refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a89b58b9e846847185042cd3b6933d9d5" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">protected</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a89b58b9e846847185042cd3b6933d9d5" kindref="member">inputSize</ref>(List&lt;T&gt;<sp/>group)<sp/>{</highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>group.stream().mapToLong(<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1ContentScanTask_1a6daf95d6bf158b0fc709102af76b0fb2" kindref="member">ContentScanTask::length</ref>).sum();</highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="186"><highlight class="normal"></highlight></codeline>
<codeline lineno="194" refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a35dafe0205ba79edc7fa09add80ef9cd" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">protected</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a35dafe0205ba79edc7fa09add80ef9cd" kindref="member">splitSize</ref>(</highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a89b58b9e846847185042cd3b6933d9d5" kindref="member">inputSize</ref>)<sp/>{</highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>estimatedSplitSize<sp/>=<sp/>(<ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a89b58b9e846847185042cd3b6933d9d5" kindref="member">inputSize</ref><sp/>/<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1ae2f5611343ac71a84b9c3a33da40a859" kindref="member">numOutputFiles</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a89b58b9e846847185042cd3b6933d9d5" kindref="member">inputSize</ref>))<sp/>+<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a9621b68dc7a12133f5488abc2d5a7bcd" kindref="member">SPLIT_OVERHEAD</ref>;</highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(estimatedSplitSize<sp/>&lt;<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a3cd4b7e33816aeb7655af79cd7dea286" kindref="member">targetFileSize</ref>)<sp/>{</highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a3cd4b7e33816aeb7655af79cd7dea286" kindref="member">targetFileSize</ref>;</highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(estimatedSplitSize<sp/>&gt;<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1acfe843c4167ba137cbb4dd9ab65dd972" kindref="member">writeMaxFileSize</ref>())<sp/>{</highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1acfe843c4167ba137cbb4dd9ab65dd972" kindref="member">writeMaxFileSize</ref>();</highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>estimatedSplitSize;</highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="204"><highlight class="normal"></highlight></codeline>
<codeline lineno="219" refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1ae2f5611343ac71a84b9c3a33da40a859" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">protected</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1ae2f5611343ac71a84b9c3a33da40a859" kindref="member">numOutputFiles</ref>(</highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a89b58b9e846847185042cd3b6933d9d5" kindref="member">inputSize</ref>)<sp/>{</highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a89b58b9e846847185042cd3b6933d9d5" kindref="member">inputSize</ref><sp/>&lt;<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a3cd4b7e33816aeb7655af79cd7dea286" kindref="member">targetFileSize</ref>)<sp/>{</highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;</highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="223"><highlight class="normal"></highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>numFilesWithRemainder<sp/>=<sp/>LongMath.divide(<ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a89b58b9e846847185042cd3b6933d9d5" kindref="member">inputSize</ref>,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a3cd4b7e33816aeb7655af79cd7dea286" kindref="member">targetFileSize</ref>,<sp/>RoundingMode.CEILING);</highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>numFilesWithoutRemainder<sp/>=<sp/>LongMath.divide(<ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a89b58b9e846847185042cd3b6933d9d5" kindref="member">inputSize</ref>,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a3cd4b7e33816aeb7655af79cd7dea286" kindref="member">targetFileSize</ref>,<sp/>RoundingMode.FLOOR);</highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>avgFileSizeWithoutRemainder<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a89b58b9e846847185042cd3b6933d9d5" kindref="member">inputSize</ref><sp/>/<sp/>numFilesWithoutRemainder;</highlight></codeline>
<codeline lineno="227"><highlight class="normal"></highlight></codeline>
<codeline lineno="228"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(LongMath.mod(<ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a89b58b9e846847185042cd3b6933d9d5" kindref="member">inputSize</ref>,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a3cd4b7e33816aeb7655af79cd7dea286" kindref="member">targetFileSize</ref>)<sp/>&gt;<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a97b38c0e90c4c5d64c89fc612d770386" kindref="member">minFileSize</ref>)<sp/>{</highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>the<sp/>remainder<sp/>file<sp/>is<sp/>of<sp/>a<sp/>valid<sp/>size<sp/>for<sp/>this<sp/>rewrite<sp/>so<sp/>keep<sp/>it</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>numFilesWithRemainder;</highlight></codeline>
<codeline lineno="231"><highlight class="normal"></highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(avgFileSizeWithoutRemainder<sp/>&lt;<sp/>Math.min(1.1<sp/>*<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a3cd4b7e33816aeb7655af79cd7dea286" kindref="member">targetFileSize</ref>,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1acfe843c4167ba137cbb4dd9ab65dd972" kindref="member">writeMaxFileSize</ref>()))<sp/>{</highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>if<sp/>the<sp/>reminder<sp/>is<sp/>distributed<sp/>amongst<sp/>other<sp/>files,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>the<sp/>average<sp/>file<sp/>size<sp/>will<sp/>be<sp/>no<sp/>more<sp/>than<sp/>10%<sp/>bigger<sp/>than<sp/>the<sp/>target<sp/>file<sp/>size</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>so<sp/>round<sp/>down<sp/>and<sp/>distribute<sp/>remainder<sp/>amongst<sp/>other<sp/>files</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>numFilesWithoutRemainder;</highlight></codeline>
<codeline lineno="237"><highlight class="normal"></highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>keep<sp/>the<sp/>remainder<sp/>file<sp/>as<sp/>it<sp/>is<sp/>not<sp/>OK<sp/>to<sp/>distribute<sp/>it<sp/>amongst<sp/>other<sp/>files</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>numFilesWithRemainder;</highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="242"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="243"><highlight class="normal"></highlight></codeline>
<codeline lineno="261" refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1acfe843c4167ba137cbb4dd9ab65dd972" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">protected</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1acfe843c4167ba137cbb4dd9ab65dd972" kindref="member">writeMaxFileSize</ref>()<sp/>{</highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">long</highlight><highlight class="normal">)<sp/>(<ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a3cd4b7e33816aeb7655af79cd7dea286" kindref="member">targetFileSize</ref><sp/>+<sp/>((<ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a873991443cff01f8074353fc24338e89" kindref="member">maxFileSize</ref><sp/>-<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a3cd4b7e33816aeb7655af79cd7dea286" kindref="member">targetFileSize</ref>)<sp/>*<sp/>0.5));</highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="264"><highlight class="normal"></highlight></codeline>
<codeline lineno="265" refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a5b4dc8bd3d6d15d03c678ab73dbc255e" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">protected</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1PartitionSpec" kindref="compound">PartitionSpec</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a5b4dc8bd3d6d15d03c678ab73dbc255e" kindref="member">outputSpec</ref>()<sp/>{</highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1ad3d9f83ecb95102b2cc23328c02215cd" kindref="member">table</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Table_1a8ad2549622317d3388535399b6b7fd05" kindref="member">specs</ref>().get(<ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a83b9e192b6ea222bf89b57d0b55b8b59" kindref="member">outputSpecId</ref>);</highlight></codeline>
<codeline lineno="267"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="268"><highlight class="normal"></highlight></codeline>
<codeline lineno="269" refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1ac9982de31dd85273f12b6e4efec4f0a7" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">protected</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1ac9982de31dd85273f12b6e4efec4f0a7" kindref="member">outputSpecId</ref>()<sp/>{</highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a83b9e192b6ea222bf89b57d0b55b8b59" kindref="member">outputSpecId</ref>;</highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="272"><highlight class="normal"></highlight></codeline>
<codeline lineno="273" refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a59c402edcd0389c82320cbd1d84336e7" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a59c402edcd0389c82320cbd1d84336e7" kindref="member">outputSpecId</ref>(Map&lt;String,<sp/>String&gt;<sp/>options)<sp/>{</highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>specId<sp/>=</highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1util_1_1PropertyUtil" kindref="compound">PropertyUtil</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1util_1_1PropertyUtil_1a67a6b8cb30cce34999ca41378b22077a" kindref="member">propertyAsInt</ref>(options,<sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1actions_1_1RewriteDataFiles" kindref="compound">RewriteDataFiles</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1actions_1_1RewriteDataFiles_1a4a7e332a5b1033af1901e56f601b1c6a" kindref="member">OUTPUT_SPEC_ID</ref>,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1ad3d9f83ecb95102b2cc23328c02215cd" kindref="member">table</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Table_1a896bd81a171a850db849109694a5b9ce" kindref="member">spec</ref>().<ref refid="classorg_1_1apache_1_1iceberg_1_1PartitionSpec_1a717532406f4cf60207b057607b89c0ec" kindref="member">specId</ref>());</highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/><sp/><sp/>Preconditions.checkArgument(</highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1ad3d9f83ecb95102b2cc23328c02215cd" kindref="member">table</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Table_1a8ad2549622317d3388535399b6b7fd05" kindref="member">specs</ref>().containsKey(specId),</highlight></codeline>
<codeline lineno="278"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Cannot<sp/>use<sp/>output<sp/>spec<sp/>id<sp/>%s<sp/>because<sp/>the<sp/>table<sp/>does<sp/>not<sp/>contain<sp/>a<sp/>reference<sp/>to<sp/>this<sp/>spec-id.&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>specId);</highlight></codeline>
<codeline lineno="280"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>specId;</highlight></codeline>
<codeline lineno="281"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="282"><highlight class="normal"></highlight></codeline>
<codeline lineno="283" refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1ac262f7b4c4592b1c35f581c4890253ef" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/>Map&lt;String,<sp/>Long&gt;<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1ac262f7b4c4592b1c35f581c4890253ef" kindref="member">sizeThresholds</ref>(Map&lt;String,<sp/>String&gt;<sp/>options)<sp/>{</highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>target<sp/>=</highlight></codeline>
<codeline lineno="285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1util_1_1PropertyUtil" kindref="compound">PropertyUtil</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1util_1_1PropertyUtil_1a3aa85645457d631be688a88d88007f72" kindref="member">propertyAsLong</ref>(options,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1aab04bf81c3abcc6f18a0da334f5c6e39" kindref="member">TARGET_FILE_SIZE_BYTES</ref>,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a23c3d626e3e316079ec869959b3e7bab" kindref="member">defaultTargetFileSize</ref>());</highlight></codeline>
<codeline lineno="286"><highlight class="normal"></highlight></codeline>
<codeline lineno="287"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>defaultMin<sp/>=<sp/>(long)<sp/>(target<sp/>*<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1aa7c0e05985db76fccf853031240efab4" kindref="member">MIN_FILE_SIZE_DEFAULT_RATIO</ref>);</highlight></codeline>
<codeline lineno="288"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>min<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1util_1_1PropertyUtil" kindref="compound">PropertyUtil</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1util_1_1PropertyUtil_1a3aa85645457d631be688a88d88007f72" kindref="member">propertyAsLong</ref>(options,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a3f3cf26ef7f474d6d004508408b8befe" kindref="member">MIN_FILE_SIZE_BYTES</ref>,<sp/>defaultMin);</highlight></codeline>
<codeline lineno="289"><highlight class="normal"></highlight></codeline>
<codeline lineno="290"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>defaultMax<sp/>=<sp/>(long)<sp/>(target<sp/>*<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1ae3d09c925f5a12c32ccfa4a6aaf53986" kindref="member">MAX_FILE_SIZE_DEFAULT_RATIO</ref>);</highlight></codeline>
<codeline lineno="291"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>max<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1util_1_1PropertyUtil" kindref="compound">PropertyUtil</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1util_1_1PropertyUtil_1a3aa85645457d631be688a88d88007f72" kindref="member">propertyAsLong</ref>(options,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a9410fbbd5f47fbaad62a474a84bd308c" kindref="member">MAX_FILE_SIZE_BYTES</ref>,<sp/>defaultMax);</highlight></codeline>
<codeline lineno="292"><highlight class="normal"></highlight></codeline>
<codeline lineno="293"><highlight class="normal"><sp/><sp/><sp/><sp/>Preconditions.checkArgument(</highlight></codeline>
<codeline lineno="294"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>target<sp/>&gt;<sp/>0,<sp/></highlight><highlight class="stringliteral">&quot;&apos;%s&apos;<sp/>is<sp/>set<sp/>to<sp/>%s<sp/>but<sp/>must<sp/>be<sp/>&gt;<sp/>0&quot;</highlight><highlight class="normal">,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1aab04bf81c3abcc6f18a0da334f5c6e39" kindref="member">TARGET_FILE_SIZE_BYTES</ref>,<sp/>target);</highlight></codeline>
<codeline lineno="295"><highlight class="normal"></highlight></codeline>
<codeline lineno="296"><highlight class="normal"><sp/><sp/><sp/><sp/>Preconditions.checkArgument(</highlight></codeline>
<codeline lineno="297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>min<sp/>&gt;=<sp/>0,<sp/></highlight><highlight class="stringliteral">&quot;&apos;%s&apos;<sp/>is<sp/>set<sp/>to<sp/>%s<sp/>but<sp/>must<sp/>be<sp/>&gt;=<sp/>0&quot;</highlight><highlight class="normal">,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a3f3cf26ef7f474d6d004508408b8befe" kindref="member">MIN_FILE_SIZE_BYTES</ref>,<sp/>min);</highlight></codeline>
<codeline lineno="298"><highlight class="normal"></highlight></codeline>
<codeline lineno="299"><highlight class="normal"><sp/><sp/><sp/><sp/>Preconditions.checkArgument(</highlight></codeline>
<codeline lineno="300"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>target<sp/>&gt;<sp/>min,</highlight></codeline>
<codeline lineno="301"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&apos;%s&apos;<sp/>(%s)<sp/>must<sp/>be<sp/>&gt;<sp/>&apos;%s&apos;<sp/>(%s),<sp/>all<sp/>new<sp/>files<sp/>will<sp/>be<sp/>smaller<sp/>than<sp/>the<sp/>min<sp/>threshold&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="302"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1aab04bf81c3abcc6f18a0da334f5c6e39" kindref="member">TARGET_FILE_SIZE_BYTES</ref>,</highlight></codeline>
<codeline lineno="303"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>target,</highlight></codeline>
<codeline lineno="304"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a3f3cf26ef7f474d6d004508408b8befe" kindref="member">MIN_FILE_SIZE_BYTES</ref>,</highlight></codeline>
<codeline lineno="305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>min);</highlight></codeline>
<codeline lineno="306"><highlight class="normal"></highlight></codeline>
<codeline lineno="307"><highlight class="normal"><sp/><sp/><sp/><sp/>Preconditions.checkArgument(</highlight></codeline>
<codeline lineno="308"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>target<sp/>&lt;<sp/>max,</highlight></codeline>
<codeline lineno="309"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&apos;%s&apos;<sp/>(%s)<sp/>must<sp/>be<sp/>&lt;<sp/>&apos;%s&apos;<sp/>(%s),<sp/>all<sp/>new<sp/>files<sp/>will<sp/>be<sp/>larger<sp/>than<sp/>the<sp/>max<sp/>threshold&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="310"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1aab04bf81c3abcc6f18a0da334f5c6e39" kindref="member">TARGET_FILE_SIZE_BYTES</ref>,</highlight></codeline>
<codeline lineno="311"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>target,</highlight></codeline>
<codeline lineno="312"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a9410fbbd5f47fbaad62a474a84bd308c" kindref="member">MAX_FILE_SIZE_BYTES</ref>,</highlight></codeline>
<codeline lineno="313"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>max);</highlight></codeline>
<codeline lineno="314"><highlight class="normal"></highlight></codeline>
<codeline lineno="315"><highlight class="normal"><sp/><sp/><sp/><sp/>Map&lt;String,<sp/>Long&gt;<sp/>values<sp/>=<sp/>Maps.newHashMap();</highlight></codeline>
<codeline lineno="316"><highlight class="normal"></highlight></codeline>
<codeline lineno="317"><highlight class="normal"><sp/><sp/><sp/><sp/>values.put(<ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1aab04bf81c3abcc6f18a0da334f5c6e39" kindref="member">TARGET_FILE_SIZE_BYTES</ref>,<sp/>target);</highlight></codeline>
<codeline lineno="318"><highlight class="normal"><sp/><sp/><sp/><sp/>values.put(<ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a3f3cf26ef7f474d6d004508408b8befe" kindref="member">MIN_FILE_SIZE_BYTES</ref>,<sp/>min);</highlight></codeline>
<codeline lineno="319"><highlight class="normal"><sp/><sp/><sp/><sp/>values.put(<ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a9410fbbd5f47fbaad62a474a84bd308c" kindref="member">MAX_FILE_SIZE_BYTES</ref>,<sp/>max);</highlight></codeline>
<codeline lineno="320"><highlight class="normal"></highlight></codeline>
<codeline lineno="321"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>values;</highlight></codeline>
<codeline lineno="322"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="323"><highlight class="normal"></highlight></codeline>
<codeline lineno="324" refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1ad6e05edc3b368b24f1393751b79a3262" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1ad6e05edc3b368b24f1393751b79a3262" kindref="member">minInputFiles</ref>(Map&lt;String,<sp/>String&gt;<sp/>options)<sp/>{</highlight></codeline>
<codeline lineno="325"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>value<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1util_1_1PropertyUtil" kindref="compound">PropertyUtil</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1util_1_1PropertyUtil_1a67a6b8cb30cce34999ca41378b22077a" kindref="member">propertyAsInt</ref>(options,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1aaa006b368397ad09b40ac5381939343b" kindref="member">MIN_INPUT_FILES</ref>,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a63ed3f460dbc8e89878de9a8cd5260ed" kindref="member">MIN_INPUT_FILES_DEFAULT</ref>);</highlight></codeline>
<codeline lineno="326"><highlight class="normal"><sp/><sp/><sp/><sp/>Preconditions.checkArgument(</highlight></codeline>
<codeline lineno="327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>value<sp/>&gt;<sp/>0,<sp/></highlight><highlight class="stringliteral">&quot;&apos;%s&apos;<sp/>is<sp/>set<sp/>to<sp/>%s<sp/>but<sp/>must<sp/>be<sp/>&gt;<sp/>0&quot;</highlight><highlight class="normal">,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1aaa006b368397ad09b40ac5381939343b" kindref="member">MIN_INPUT_FILES</ref>,<sp/>value);</highlight></codeline>
<codeline lineno="328"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>value;</highlight></codeline>
<codeline lineno="329"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="330"><highlight class="normal"></highlight></codeline>
<codeline lineno="331" refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a75ff274e18f09bf34d5e58bba5f1aff3" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a75ff274e18f09bf34d5e58bba5f1aff3" kindref="member">maxGroupSize</ref>(Map&lt;String,<sp/>String&gt;<sp/>options)<sp/>{</highlight></codeline>
<codeline lineno="332"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>value<sp/>=</highlight></codeline>
<codeline lineno="333"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1util_1_1PropertyUtil" kindref="compound">PropertyUtil</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1util_1_1PropertyUtil_1a3aa85645457d631be688a88d88007f72" kindref="member">propertyAsLong</ref>(</highlight></codeline>
<codeline lineno="334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>options,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1ae8e3a7245f2db52b3bfe5094b10d98ed" kindref="member">MAX_FILE_GROUP_SIZE_BYTES</ref>,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a0dd56ae4a673b02768bf30785949d624" kindref="member">MAX_FILE_GROUP_SIZE_BYTES_DEFAULT</ref>);</highlight></codeline>
<codeline lineno="335"><highlight class="normal"><sp/><sp/><sp/><sp/>Preconditions.checkArgument(</highlight></codeline>
<codeline lineno="336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>value<sp/>&gt;<sp/>0,<sp/></highlight><highlight class="stringliteral">&quot;&apos;%s&apos;<sp/>is<sp/>set<sp/>to<sp/>%s<sp/>but<sp/>must<sp/>be<sp/>&gt;<sp/>0&quot;</highlight><highlight class="normal">,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1ae8e3a7245f2db52b3bfe5094b10d98ed" kindref="member">MAX_FILE_GROUP_SIZE_BYTES</ref>,<sp/>value);</highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>value;</highlight></codeline>
<codeline lineno="338"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="339"><highlight class="normal"></highlight></codeline>
<codeline lineno="340" refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1af18aaef9c8a7fcce084b705201e2aff5" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">boolean</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1af18aaef9c8a7fcce084b705201e2aff5" kindref="member">rewriteAll</ref>(Map&lt;String,<sp/>String&gt;<sp/>options)<sp/>{</highlight></codeline>
<codeline lineno="341"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1util_1_1PropertyUtil" kindref="compound">PropertyUtil</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1util_1_1PropertyUtil_1a815bb60acfdf24932c858baa8afe18f2" kindref="member">propertyAsBoolean</ref>(options,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1a2e2947b376e73d2bb86e83a544fce411" kindref="member">REWRITE_ALL</ref>,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1actions_1_1SizeBasedFileRewriter_1aee01234f63b23baa93d631de7a2d2fa4" kindref="member">REWRITE_ALL_DEFAULT</ref>);</highlight></codeline>
<codeline lineno="342"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="343"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="core/src/main/java/org/apache/iceberg/actions/SizeBasedFileRewriter.java"/>
  </compounddef>
</doxygen>
