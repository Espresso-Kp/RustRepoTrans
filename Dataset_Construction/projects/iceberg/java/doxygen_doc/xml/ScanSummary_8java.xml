<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.17">
  <compounddef id="ScanSummary_8java" kind="file" language="Java">
    <compoundname>ScanSummary.java</compoundname>
    <innerclass refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary" prot="public">org::apache::iceberg::ScanSummary</innerclass>
    <innerclass refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder" prot="public">org::apache::iceberg::ScanSummary::Builder</innerclass>
    <innerclass refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1PartitionMetrics" prot="public">org::apache::iceberg::ScanSummary::PartitionMetrics</innerclass>
    <innerclass refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1TopN" prot="private">org::apache::iceberg::ScanSummary::TopN</innerclass>
    <innernamespace refid="namespaceorg_1_1apache_1_1iceberg">org::apache::iceberg</innernamespace>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">/*</highlight></codeline>
<codeline lineno="2"><highlight class="comment"><sp/>*<sp/>Licensed<sp/>to<sp/>the<sp/>Apache<sp/>Software<sp/>Foundation<sp/>(ASF)<sp/>under<sp/>one</highlight></codeline>
<codeline lineno="3"><highlight class="comment"><sp/>*<sp/>or<sp/>more<sp/>contributor<sp/>license<sp/>agreements.<sp/><sp/>See<sp/>the<sp/>NOTICE<sp/>file</highlight></codeline>
<codeline lineno="4"><highlight class="comment"><sp/>*<sp/>distributed<sp/>with<sp/>this<sp/>work<sp/>for<sp/>additional<sp/>information</highlight></codeline>
<codeline lineno="5"><highlight class="comment"><sp/>*<sp/>regarding<sp/>copyright<sp/>ownership.<sp/><sp/>The<sp/>ASF<sp/>licenses<sp/>this<sp/>file</highlight></codeline>
<codeline lineno="6"><highlight class="comment"><sp/>*<sp/>to<sp/>you<sp/>under<sp/>the<sp/>Apache<sp/>License,<sp/>Version<sp/>2.0<sp/>(the</highlight></codeline>
<codeline lineno="7"><highlight class="comment"><sp/>*<sp/>&quot;License&quot;);<sp/>you<sp/>may<sp/>not<sp/>use<sp/>this<sp/>file<sp/>except<sp/>in<sp/>compliance</highlight></codeline>
<codeline lineno="8"><highlight class="comment"><sp/>*<sp/>with<sp/>the<sp/>License.<sp/><sp/>You<sp/>may<sp/>obtain<sp/>a<sp/>copy<sp/>of<sp/>the<sp/>License<sp/>at</highlight></codeline>
<codeline lineno="9"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="10"><highlight class="comment"><sp/>*<sp/><sp/><sp/>http://www.apache.org/licenses/LICENSE-2.0</highlight></codeline>
<codeline lineno="11"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="12"><highlight class="comment"><sp/>*<sp/>Unless<sp/>required<sp/>by<sp/>applicable<sp/>law<sp/>or<sp/>agreed<sp/>to<sp/>in<sp/>writing,</highlight></codeline>
<codeline lineno="13"><highlight class="comment"><sp/>*<sp/>software<sp/>distributed<sp/>under<sp/>the<sp/>License<sp/>is<sp/>distributed<sp/>on<sp/>an</highlight></codeline>
<codeline lineno="14"><highlight class="comment"><sp/>*<sp/>&quot;AS<sp/>IS&quot;<sp/>BASIS,<sp/>WITHOUT<sp/>WARRANTIES<sp/>OR<sp/>CONDITIONS<sp/>OF<sp/>ANY</highlight></codeline>
<codeline lineno="15"><highlight class="comment"><sp/>*<sp/>KIND,<sp/>either<sp/>express<sp/>or<sp/>implied.<sp/><sp/>See<sp/>the<sp/>License<sp/>for<sp/>the</highlight></codeline>
<codeline lineno="16"><highlight class="comment"><sp/>*<sp/>specific<sp/>language<sp/>governing<sp/>permissions<sp/>and<sp/>limitations</highlight></codeline>
<codeline lineno="17"><highlight class="comment"><sp/>*<sp/>under<sp/>the<sp/>License.</highlight></codeline>
<codeline lineno="18"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="19"><highlight class="normal"></highlight><highlight class="keyword">package<sp/></highlight><highlight class="normal">org.apache.iceberg;</highlight></codeline>
<codeline lineno="20"><highlight class="normal"></highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>java.io.IOException;</highlight></codeline>
<codeline lineno="22"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>java.util.Comparator;</highlight></codeline>
<codeline lineno="23"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>java.util.List;</highlight></codeline>
<codeline lineno="24"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>java.util.Map;</highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>java.util.NavigableMap;</highlight></codeline>
<codeline lineno="26"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>java.util.Set;</highlight></codeline>
<codeline lineno="27"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>java.util.function.Function;</highlight></codeline>
<codeline lineno="28"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1exceptions" kindref="compound">exceptions</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1exceptions_1_1RuntimeIOException" kindref="compound">RuntimeIOException</ref>;</highlight></codeline>
<codeline lineno="29"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1expressions" kindref="compound">expressions</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1And" kindref="compound">And</ref>;</highlight></codeline>
<codeline lineno="30"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1expressions" kindref="compound">expressions</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1expressions_1_1Expression" kindref="compound">Expression</ref>;</highlight></codeline>
<codeline lineno="31"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1expressions" kindref="compound">expressions</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1expressions_1_1Expression" kindref="compound">Expression</ref>.<ref refid="enumorg_1_1apache_1_1iceberg_1_1expressions_1_1Expression_1_1Operation" kindref="compound">Operation</ref>;</highlight></codeline>
<codeline lineno="32"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1expressions" kindref="compound">expressions</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1Expressions" kindref="compound">Expressions</ref>;</highlight></codeline>
<codeline lineno="33"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1expressions" kindref="compound">expressions</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1expressions_1_1Literal" kindref="compound">Literal</ref>;</highlight></codeline>
<codeline lineno="34"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1expressions" kindref="compound">expressions</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1NamedReference" kindref="compound">NamedReference</ref>;</highlight></codeline>
<codeline lineno="35"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1expressions" kindref="compound">expressions</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1UnboundPredicate" kindref="compound">UnboundPredicate</ref>;</highlight></codeline>
<codeline lineno="36"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1io" kindref="compound">io</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1io_1_1CloseableIterable" kindref="compound">CloseableIterable</ref>;</highlight></codeline>
<codeline lineno="37"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.relocated.com.google.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1common" kindref="compound">common</ref>.base.<ref refid="classorg_1_1apache_1_1iceberg_1_1relocated_1_1com_1_1google_1_1common_1_1base_1_1Joiner" kindref="compound">Joiner</ref>;</highlight></codeline>
<codeline lineno="38"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.relocated.com.google.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1common" kindref="compound">common</ref>.collect.ImmutableList;</highlight></codeline>
<codeline lineno="39"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.relocated.com.google.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1common" kindref="compound">common</ref>.collect.ImmutableMap;</highlight></codeline>
<codeline lineno="40"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.relocated.com.google.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1common" kindref="compound">common</ref>.collect.ImmutableSortedMap;</highlight></codeline>
<codeline lineno="41"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.relocated.com.google.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1common" kindref="compound">common</ref>.collect.Iterables;</highlight></codeline>
<codeline lineno="42"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.relocated.com.google.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1common" kindref="compound">common</ref>.collect.Lists;</highlight></codeline>
<codeline lineno="43"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.relocated.com.google.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1common" kindref="compound">common</ref>.collect.<ref refid="classorg_1_1apache_1_1iceberg_1_1relocated_1_1com_1_1google_1_1common_1_1collect_1_1Maps" kindref="compound">Maps</ref>;</highlight></codeline>
<codeline lineno="44"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.relocated.com.google.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1common" kindref="compound">common</ref>.collect.<ref refid="classorg_1_1apache_1_1iceberg_1_1relocated_1_1com_1_1google_1_1common_1_1collect_1_1Sets" kindref="compound">Sets</ref>;</highlight></codeline>
<codeline lineno="45"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1types" kindref="compound">types</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1types_1_1Comparators" kindref="compound">Comparators</ref>;</highlight></codeline>
<codeline lineno="46"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1types" kindref="compound">types</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1types_1_1Types" kindref="compound">Types</ref>;</highlight></codeline>
<codeline lineno="47"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1util" kindref="compound">util</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1util_1_1DateTimeUtil" kindref="compound">DateTimeUtil</ref>;</highlight></codeline>
<codeline lineno="48"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1util" kindref="compound">util</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1util_1_1Pair" kindref="compound">Pair</ref>;</highlight></codeline>
<codeline lineno="49"><highlight class="normal"></highlight></codeline>
<codeline lineno="50" refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary" kindref="compound">ScanSummary</ref><sp/>{</highlight></codeline>
<codeline lineno="51" refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1ac28dcc8f439876c5742da570e5d5a85b" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1ac28dcc8f439876c5742da570e5d5a85b" kindref="member">ScanSummary</ref>()<sp/>{}</highlight></codeline>
<codeline lineno="52"><highlight class="normal"></highlight></codeline>
<codeline lineno="53" refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1a63ca015ad13b66d4c8329c97abde97df" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/>ImmutableList&lt;String&gt;<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1a63ca015ad13b66d4c8329c97abde97df" kindref="member">SCAN_SUMMARY_COLUMNS</ref><sp/>=</highlight></codeline>
<codeline lineno="54"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>ImmutableList.of(</highlight><highlight class="stringliteral">&quot;partition&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;record_count&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;file_size_in_bytes&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="55"><highlight class="normal"></highlight></codeline>
<codeline lineno="62" refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1aa0061d2a10f08c5cf0a996ad100b2661" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary" kindref="compound">ScanSummary</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder" kindref="compound">Builder</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1aa0061d2a10f08c5cf0a996ad100b2661" kindref="member">of</ref>(<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1TableScan" kindref="compound">TableScan</ref><sp/>scan)<sp/>{</highlight></codeline>
<codeline lineno="63"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder" kindref="compound">Builder</ref>(scan);</highlight></codeline>
<codeline lineno="64"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="65"><highlight class="normal"></highlight></codeline>
<codeline lineno="66" refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder" refkind="compound"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder" kindref="compound">Builder</ref><sp/>{</highlight></codeline>
<codeline lineno="67" refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1af0aba3fe13de6d0f9fed56ae2f7c9dec" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/>Set&lt;String&gt;<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1af0aba3fe13de6d0f9fed56ae2f7c9dec" kindref="member">TIMESTAMP_NAMES</ref><sp/>=</highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Sets.newHashSet(</highlight><highlight class="stringliteral">&quot;dateCreated&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;lastUpdated&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="69" refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1a942d80e232193f712579d3499c2b7f17" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1TableScan" kindref="compound">TableScan</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1a942d80e232193f712579d3499c2b7f17" kindref="member">scan</ref>;</highlight></codeline>
<codeline lineno="70" refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1adb5dbc5964d70db167b231f6a59b9fe3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Table" kindref="compound">Table</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1adb5dbc5964d70db167b231f6a59b9fe3" kindref="member">table</ref>;</highlight></codeline>
<codeline lineno="71" refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1a22a2b04c653f0410b7b3d3a8f2159d1e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1TableOperations" kindref="compound">TableOperations</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1a22a2b04c653f0410b7b3d3a8f2159d1e" kindref="member">ops</ref>;</highlight></codeline>
<codeline lineno="72" refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1a0e738ded11999a59a40c9326fbedda98" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/>Map&lt;Long,<sp/>Long&gt;<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1a0e738ded11999a59a40c9326fbedda98" kindref="member">snapshotTimestamps</ref>;</highlight></codeline>
<codeline lineno="73" refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1a1c3b334219dd7bad979bad8370ea631a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1a1c3b334219dd7bad979bad8370ea631a" kindref="member">limit</ref><sp/>=<sp/>Integer.MAX_VALUE;</highlight></codeline>
<codeline lineno="74" refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1afd3968cc1dd1b444d8fd5413ca4bcd28" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">boolean</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1afd3968cc1dd1b444d8fd5413ca4bcd28" kindref="member">throwIfLimited</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="75" refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1af2d6fa23205b03cc142e9b41ecc61e18" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/>List&lt;UnboundPredicate&lt;Long&gt;&gt;<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1af2d6fa23205b03cc142e9b41ecc61e18" kindref="member">timeFilters</ref><sp/>=<sp/>Lists.newArrayList();</highlight></codeline>
<codeline lineno="76"><highlight class="normal"></highlight></codeline>
<codeline lineno="77" refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1a7b0d7d00e2a283969e02a35f082761fb" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1a7b0d7d00e2a283969e02a35f082761fb" kindref="member">Builder</ref>(<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1TableScan" kindref="compound">TableScan</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1a942d80e232193f712579d3499c2b7f17" kindref="member">scan</ref>)<sp/>{</highlight></codeline>
<codeline lineno="78"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this.scan<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1a942d80e232193f712579d3499c2b7f17" kindref="member">scan</ref>;</highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this.table<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1a942d80e232193f712579d3499c2b7f17" kindref="member">scan</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1TableScan_1a8efe418c85919f1a6da69875b9cb46ab" kindref="member">table</ref>();</highlight></codeline>
<codeline lineno="80"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this.ops<sp/>=<sp/>((<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1HasTableOperations" kindref="compound">HasTableOperations</ref>)<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1adb5dbc5964d70db167b231f6a59b9fe3" kindref="member">table</ref>).operations();</highlight></codeline>
<codeline lineno="81"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>ImmutableMap.Builder&lt;Long,<sp/>Long&gt;<sp/>builder<sp/>=<sp/>ImmutableMap.builder();</highlight></codeline>
<codeline lineno="82"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Snapshot" kindref="compound">Snapshot</ref><sp/>snap<sp/>:<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1adb5dbc5964d70db167b231f6a59b9fe3" kindref="member">table</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Table_1a015116def899be1695e8f2c0c020d26c" kindref="member">snapshots</ref>())<sp/>{</highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>builder.put(snap.snapshotId(),<sp/>snap.timestampMillis());</highlight></codeline>
<codeline lineno="84"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="85"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this.snapshotTimestamps<sp/>=<sp/>builder.build();</highlight></codeline>
<codeline lineno="86"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="87"><highlight class="normal"></highlight></codeline>
<codeline lineno="88" refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1a55a3cf86e97ed52204466d3e1c77bdd8" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1a55a3cf86e97ed52204466d3e1c77bdd8" kindref="member">addTimestampFilter</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1UnboundPredicate" kindref="compound">UnboundPredicate&lt;Long&gt;</ref><sp/>filter)<sp/>{</highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1afd3968cc1dd1b444d8fd5413ca4bcd28" kindref="member">throwIfLimited</ref>();<sp/></highlight><highlight class="comment">//<sp/>ensure<sp/>all<sp/>partitions<sp/>can<sp/>be<sp/>returned</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1af2d6fa23205b03cc142e9b41ecc61e18" kindref="member">timeFilters</ref>.add(filter);</highlight></codeline>
<codeline lineno="91"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="92"><highlight class="normal"></highlight></codeline>
<codeline lineno="93" refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1aa9e58623de56ba0e4b865e6823737495" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder" kindref="compound">Builder</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1aa9e58623de56ba0e4b865e6823737495" kindref="member">after</ref>(String<sp/>timestamp)<sp/>{</highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1expressions_1_1Literal" kindref="compound">Literal&lt;Long&gt;</ref><sp/>tsLiteral<sp/>=<sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1expressions_1_1Literal" kindref="compound">Literal</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1expressions_1_1Literal_1a05a229efa4e8076260405ae018e0d13d" kindref="member">of</ref>(timestamp).to(<ref refid="classorg_1_1apache_1_1iceberg_1_1types_1_1Types" kindref="compound">Types</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1types_1_1Types_1_1TimestampType" kindref="compound">TimestampType</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1types_1_1Types_1_1TimestampType_1a293b2379219758e388b8d8bdda7df007" kindref="member">withoutZone</ref>());</highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1aa9e58623de56ba0e4b865e6823737495" kindref="member">after</ref>(tsLiteral.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1expressions_1_1Literal_1ac891cbe07d9e1eda3f815eafcdc2852e" kindref="member">value</ref>()<sp/>/<sp/>1000);</highlight></codeline>
<codeline lineno="96"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="97"><highlight class="normal"></highlight></codeline>
<codeline lineno="98" refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1a321f16eabbabcc5dff6a5bdd76368ed0" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder" kindref="compound">Builder</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1a321f16eabbabcc5dff6a5bdd76368ed0" kindref="member">after</ref>(</highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>timestampMillis)<sp/>{</highlight></codeline>
<codeline lineno="99"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1a55a3cf86e97ed52204466d3e1c77bdd8" kindref="member">addTimestampFilter</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1Expressions" kindref="compound">Expressions</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1Expressions_1ab801f587d9cce3c2443864eb77995314" kindref="member">greaterThanOrEqual</ref>(</highlight><highlight class="stringliteral">&quot;timestamp_ms&quot;</highlight><highlight class="normal">,<sp/>timestampMillis));</highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">this</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="102"><highlight class="normal"></highlight></codeline>
<codeline lineno="103" refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1acc9cc60841887b180d44c0c4fac41a10" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder" kindref="compound">Builder</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1acc9cc60841887b180d44c0c4fac41a10" kindref="member">before</ref>(String<sp/>timestamp)<sp/>{</highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1expressions_1_1Literal" kindref="compound">Literal&lt;Long&gt;</ref><sp/>tsLiteral<sp/>=<sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1expressions_1_1Literal" kindref="compound">Literal</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1expressions_1_1Literal_1a05a229efa4e8076260405ae018e0d13d" kindref="member">of</ref>(timestamp).to(<ref refid="classorg_1_1apache_1_1iceberg_1_1types_1_1Types" kindref="compound">Types</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1types_1_1Types_1_1TimestampType" kindref="compound">TimestampType</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1types_1_1Types_1_1TimestampType_1a293b2379219758e388b8d8bdda7df007" kindref="member">withoutZone</ref>());</highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1acc9cc60841887b180d44c0c4fac41a10" kindref="member">before</ref>(tsLiteral.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1expressions_1_1Literal_1ac891cbe07d9e1eda3f815eafcdc2852e" kindref="member">value</ref>()<sp/>/<sp/>1000);</highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="107"><highlight class="normal"></highlight></codeline>
<codeline lineno="108" refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1a779ce6a7e784c0954020fc77b38a116f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder" kindref="compound">Builder</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1a779ce6a7e784c0954020fc77b38a116f" kindref="member">before</ref>(</highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>timestampMillis)<sp/>{</highlight></codeline>
<codeline lineno="109"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1a55a3cf86e97ed52204466d3e1c77bdd8" kindref="member">addTimestampFilter</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1Expressions" kindref="compound">Expressions</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1Expressions_1ab5349114c5d1a3457493181f6daa650e" kindref="member">lessThanOrEqual</ref>(</highlight><highlight class="stringliteral">&quot;timestamp_ms&quot;</highlight><highlight class="normal">,<sp/>timestampMillis));</highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">this</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="112"><highlight class="normal"></highlight></codeline>
<codeline lineno="113" refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1ac913b32eee0857407aeb770a50b54de5" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder" kindref="compound">Builder</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1ac913b32eee0857407aeb770a50b54de5" kindref="member">throwIfLimited</ref>()<sp/>{</highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this.throwIfLimited<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">this</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="117"><highlight class="normal"></highlight></codeline>
<codeline lineno="118" refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1abeb4de9975be8a519a4a573993e3cdea" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder" kindref="compound">Builder</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1abeb4de9975be8a519a4a573993e3cdea" kindref="member">limit</ref>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>numPartitions)<sp/>{</highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this.limit<sp/>=<sp/>numPartitions;</highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">this</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="122"><highlight class="normal"></highlight></codeline>
<codeline lineno="123" refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1a1c06836affcd36dc491e07d01bf69952" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1a1c06836affcd36dc491e07d01bf69952" kindref="member">removeTimeFilters</ref>(List&lt;Expression&gt;<sp/>expressions,<sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1expressions_1_1Expression" kindref="compound">Expression</ref><sp/>expression)<sp/>{</highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(expression.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1expressions_1_1Expression_1a6fe5218843bfa0f5ca45deaa23a43a7d" kindref="member">op</ref>()<sp/>==<sp/><ref refid="enumorg_1_1apache_1_1iceberg_1_1expressions_1_1Expression_1_1Operation" kindref="compound">Operation</ref>.<ref refid="enumorg_1_1apache_1_1iceberg_1_1expressions_1_1Expression_1_1Operation_1adf1bdf5f905330fbb8301eb50a8023b9" kindref="member">AND</ref>)<sp/>{</highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1And" kindref="compound">And</ref><sp/>and<sp/>=<sp/>(<ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1And" kindref="compound">And</ref>)<sp/>expression;</highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1a1c06836affcd36dc491e07d01bf69952" kindref="member">removeTimeFilters</ref>(expressions,<sp/>and.<ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1And_1a4f938c606c1f1691bb7f972073ae52bf" kindref="member">left</ref>());</highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1a1c06836affcd36dc491e07d01bf69952" kindref="member">removeTimeFilters</ref>(expressions,<sp/>and.<ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1And_1a494a6dc0808eec0d62dae9d40dbc1138" kindref="member">right</ref>());</highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="129"><highlight class="normal"></highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(expression<sp/>instanceof<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1UnboundPredicate" kindref="compound">UnboundPredicate</ref>)<sp/>{</highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1UnboundPredicate" kindref="compound">UnboundPredicate</ref><sp/>pred<sp/>=<sp/>(<ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1UnboundPredicate" kindref="compound">UnboundPredicate</ref>)<sp/>expression;</highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pred.<ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1Predicate_1a03437aa0628de7f44ba9eb76abc892d8" kindref="member">term</ref>()<sp/>instanceof<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1NamedReference" kindref="compound">NamedReference</ref>)<sp/>{</highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1NamedReference" kindref="compound">NamedReference&lt;?&gt;</ref><sp/>ref<sp/>=<sp/>(<ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1NamedReference" kindref="compound">NamedReference&lt;?&gt;</ref>)<sp/>pred.<ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1Predicate_1a03437aa0628de7f44ba9eb76abc892d8" kindref="member">term</ref>();</highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1expressions_1_1Literal" kindref="compound">Literal&lt;?&gt;</ref><sp/>lit<sp/>=<sp/>pred.<ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1UnboundPredicate_1ae6c2ca45bc2c57250e3480de71e6048a" kindref="member">literal</ref>();</highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1af0aba3fe13de6d0f9fed56ae2f7c9dec" kindref="member">TIMESTAMP_NAMES</ref>.contains(ref.<ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1NamedReference_1a81814f1c6b079d067e9db37a13b0cbe1" kindref="member">name</ref>()))<sp/>{</highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1expressions_1_1Literal" kindref="compound">Literal&lt;Long&gt;</ref><sp/>tsLiteral<sp/>=<sp/>lit.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1expressions_1_1Literal_1a716f56c72020d5d5afea06bc99aa0ee1" kindref="member">to</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1types_1_1Types" kindref="compound">Types</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1types_1_1Types_1_1TimestampType" kindref="compound">TimestampType</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1types_1_1Types_1_1TimestampType_1a293b2379219758e388b8d8bdda7df007" kindref="member">withoutZone</ref>());</highlight></codeline>
<codeline lineno="137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>millis<sp/>=<sp/>toMillis(tsLiteral.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1expressions_1_1Literal_1ac891cbe07d9e1eda3f815eafcdc2852e" kindref="member">value</ref>());</highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1a55a3cf86e97ed52204466d3e1c77bdd8" kindref="member">addTimestampFilter</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1Expressions" kindref="compound">Expressions</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1Expressions_1aa6db9d450da0ee2b5d5bd92253b32481" kindref="member">predicate</ref>(pred.<ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1Predicate_1a84137bbeb70a6a804dc269c67b52870e" kindref="member">op</ref>(),<sp/></highlight><highlight class="stringliteral">&quot;timestamp_ms&quot;</highlight><highlight class="normal">,<sp/>millis));</highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="143"><highlight class="normal"></highlight></codeline>
<codeline lineno="144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>expressions.add(expression);</highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="146"><highlight class="normal"></highlight></codeline>
<codeline lineno="152" refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1a62bba661c6336d7f89842379d9294b59" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>Map&lt;String,<sp/>PartitionMetrics&gt;<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1a62bba661c6336d7f89842379d9294b59" kindref="member">build</ref>()<sp/>{</highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1adb5dbc5964d70db167b231f6a59b9fe3" kindref="member">table</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Table_1a5c4df259908bf1a7e85b7264de73f943" kindref="member">currentSnapshot</ref>()<sp/>==<sp/></highlight><highlight class="keyword">null</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ImmutableMap.of();<sp/></highlight><highlight class="comment">//<sp/>no<sp/>snapshots,<sp/>so<sp/>there<sp/>are<sp/>no<sp/>partitions</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="156"><highlight class="normal"></highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>List&lt;Expression&gt;<sp/>filters<sp/>=<sp/>Lists.newArrayList();</highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1a1c06836affcd36dc491e07d01bf69952" kindref="member">removeTimeFilters</ref>(filters,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1Expressions" kindref="compound">Expressions</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1Expressions_1a43179b9500637ed893228f243e0c0c2e" kindref="member">rewriteNot</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1a942d80e232193f712579d3499c2b7f17" kindref="member">scan</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Scan_1afa54ee3e31aa55e0519d8af3e5a18f27" kindref="member">filter</ref>()));</highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1expressions_1_1Expression" kindref="compound">Expression</ref><sp/>rowFilter<sp/>=<sp/>joinFilters(filters);</highlight></codeline>
<codeline lineno="160"><highlight class="normal"></highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Iterable&lt;ManifestFile&gt;<sp/>manifests<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1adb5dbc5964d70db167b231f6a59b9fe3" kindref="member">table</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Table_1a5c4df259908bf1a7e85b7264de73f943" kindref="member">currentSnapshot</ref>().<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Snapshot_1a795c95619a783f1b364609d7644d7020" kindref="member">dataManifests</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1a22a2b04c653f0410b7b3d3a8f2159d1e" kindref="member">ops</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1TableOperations_1a837621125cb806c9fe18fa8695d57e5a" kindref="member">io</ref>());</highlight></codeline>
<codeline lineno="162"><highlight class="normal"></highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">boolean</highlight><highlight class="normal"><sp/>filterByTimestamp<sp/>=<sp/>!<ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1af2d6fa23205b03cc142e9b41ecc61e18" kindref="member">timeFilters</ref>.isEmpty();</highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Set&lt;Long&gt;<sp/>snapshotsInTimeRange<sp/>=<sp/>Sets.newHashSet();</highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(filterByTimestamp)<sp/>{</highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1util_1_1Pair" kindref="compound">Pair&lt;Long, Long&gt;</ref><sp/>range<sp/>=<sp/>timestampRange(<ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1af2d6fa23205b03cc142e9b41ecc61e18" kindref="member">timeFilters</ref>);</highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>minTimestamp<sp/>=<sp/>range.<ref refid="classorg_1_1apache_1_1iceberg_1_1util_1_1Pair_1a6ab9c685498f3a5e7b681baa7d5562a3" kindref="member">first</ref>();</highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>maxTimestamp<sp/>=<sp/>range.<ref refid="classorg_1_1apache_1_1iceberg_1_1util_1_1Pair_1a35c0221413fa5de226b37a14b27c9db0" kindref="member">second</ref>();</highlight></codeline>
<codeline lineno="169"><highlight class="normal"></highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Snapshot" kindref="compound">Snapshot</ref><sp/>oldestSnapshot<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1adb5dbc5964d70db167b231f6a59b9fe3" kindref="member">table</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Table_1a5c4df259908bf1a7e85b7264de73f943" kindref="member">currentSnapshot</ref>();</highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(Map.Entry&lt;Long,<sp/>Long&gt;<sp/>entry<sp/>:<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1a0e738ded11999a59a40c9326fbedda98" kindref="member">snapshotTimestamps</ref>.entrySet())<sp/>{</highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>snapshotId<sp/>=<sp/>entry.getKey();</highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>timestamp<sp/>=<sp/>entry.getValue();</highlight></codeline>
<codeline lineno="174"><highlight class="normal"></highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(timestamp<sp/>&lt;<sp/>oldestSnapshot.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Snapshot_1a28a8af80f4df47f198dc99f4d509397b" kindref="member">timestampMillis</ref>())<sp/>{</highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>oldestSnapshot<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1a22a2b04c653f0410b7b3d3a8f2159d1e" kindref="member">ops</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1TableOperations_1a96a251e76611125a2903eb608c97aa67" kindref="member">current</ref>().<ref refid="classorg_1_1apache_1_1iceberg_1_1TableMetadata_1a9562ae79fd02e0d0a327e1b01e9ab5f5" kindref="member">snapshot</ref>(snapshotId);</highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="178"><highlight class="normal"></highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(timestamp<sp/>&gt;=<sp/>minTimestamp<sp/>&amp;&amp;<sp/>timestamp<sp/>&lt;=<sp/>maxTimestamp)<sp/>{</highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>snapshotsInTimeRange.add(snapshotId);</highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="183"><highlight class="normal"></highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>if<sp/>oldest<sp/>known<sp/>snapshot<sp/>is<sp/>in<sp/>the<sp/>range,<sp/>then<sp/>there<sp/>may<sp/>be<sp/>an<sp/>expired<sp/>snapshot<sp/>that<sp/>has</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>been<sp/>removed<sp/>that<sp/>matched<sp/>the<sp/>range.<sp/>because<sp/>the<sp/>timestamp<sp/>of<sp/>that<sp/>snapshot<sp/>is<sp/>unknown,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>it<sp/>can&apos;t<sp/>be<sp/>included<sp/>in<sp/>the<sp/>results<sp/>and<sp/>the<sp/>results<sp/>are<sp/>not<sp/>reliable.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(snapshotsInTimeRange.contains(oldestSnapshot.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Snapshot_1aad24e075e95dfc00842c2eea7081154a" kindref="member">snapshotId</ref>())</highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;&amp;<sp/>minTimestamp<sp/>&lt;<sp/>oldestSnapshot.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Snapshot_1a28a8af80f4df47f198dc99f4d509397b" kindref="member">timestampMillis</ref>())<sp/>{</highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>IllegalArgumentException(</highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Cannot<sp/>satisfy<sp/>time<sp/>filters:<sp/>time<sp/>range<sp/>may<sp/>include<sp/>expired<sp/>snapshots&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="192"><highlight class="normal"></highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>filter<sp/>down<sp/>to<sp/>the<sp/>set<sp/>of<sp/>manifest<sp/>files<sp/>that<sp/>were<sp/>added<sp/>after<sp/>the<sp/>start<sp/>of<sp/>the</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>time<sp/>range.<sp/>manifests<sp/>after<sp/>the<sp/>end<sp/>of<sp/>the<sp/>time<sp/>range<sp/>must<sp/>be<sp/>included<sp/>because</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>compaction<sp/>may<sp/>create<sp/>a<sp/>manifest<sp/>after<sp/>the<sp/>time<sp/>range<sp/>that<sp/>includes<sp/>files<sp/>added<sp/>in<sp/>the</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>range.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>manifests<sp/>=</highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Iterables.filter(</highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>manifests,</highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>manifest<sp/>-&gt;<sp/>{</highlight></codeline>
<codeline lineno="201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(manifest.snapshotId()<sp/>==<sp/></highlight><highlight class="keyword">null</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>true;<sp/></highlight><highlight class="comment">//<sp/>can&apos;t<sp/>tell<sp/>when<sp/>the<sp/>manifest<sp/>was<sp/>written,<sp/>so<sp/>it<sp/>may<sp/>contain</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>matches</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="205"><highlight class="normal"></highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Long<sp/>timestamp<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1a0e738ded11999a59a40c9326fbedda98" kindref="member">snapshotTimestamps</ref>.get(manifest.snapshotId());</highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>if<sp/>the<sp/>timestamp<sp/>is<sp/>null,<sp/>then<sp/>its<sp/>snapshot<sp/>has<sp/>expired.<sp/>the<sp/>check<sp/>for<sp/>the</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>oldest</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>snapshot<sp/>ensures<sp/>that<sp/>all<sp/>expired<sp/>snapshots<sp/>are<sp/>not<sp/>in<sp/>the<sp/>time<sp/>range.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>timestamp<sp/>!=<sp/></highlight><highlight class="keyword">null</highlight><highlight class="normal"><sp/>&amp;&amp;<sp/>timestamp<sp/>&gt;=<sp/>minTimestamp;</highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>});</highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="213"><highlight class="normal"></highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1a8e622f02ddf652f50516b8ce4677e33b" kindref="member">computeTopPartitionMetrics</ref>(</highlight></codeline>
<codeline lineno="215"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rowFilter,<sp/>manifests,<sp/>filterByTimestamp,<sp/>snapshotsInTimeRange);</highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="217"><highlight class="normal"></highlight></codeline>
<codeline lineno="218" refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1a8e622f02ddf652f50516b8ce4677e33b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/>Map&lt;String,<sp/>PartitionMetrics&gt;<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1a8e622f02ddf652f50516b8ce4677e33b" kindref="member">computeTopPartitionMetrics</ref>(</highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1expressions_1_1Expression" kindref="compound">Expression</ref><sp/>rowFilter,</highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Iterable&lt;ManifestFile&gt;<sp/>manifests,</highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">boolean</highlight><highlight class="normal"><sp/>filterByTimestamp,</highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Set&lt;Long&gt;<sp/>snapshotsInTimeRange)<sp/>{</highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1TopN" kindref="compound">TopN&lt;String, PartitionMetrics&gt;</ref><sp/>topN<sp/>=</highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1TopN" kindref="compound">TopN&lt;&gt;</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1a1c3b334219dd7bad979bad8370ea631a" kindref="member">limit</ref>,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1afd3968cc1dd1b444d8fd5413ca4bcd28" kindref="member">throwIfLimited</ref>,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1types_1_1Comparators" kindref="compound">Comparators</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1types_1_1Comparators_1acfae59708074850e3db0d6db637c8b4c" kindref="member">charSequences</ref>());</highlight></codeline>
<codeline lineno="225"><highlight class="normal"></highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal"><sp/>(<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1io_1_1CloseableIterable" kindref="compound">CloseableIterable</ref>&lt;ManifestEntry&lt;DataFile&gt;&gt;<sp/>entries<sp/>=</highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>ManifestGroup(<ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1a22a2b04c653f0410b7b3d3a8f2159d1e" kindref="member">ops</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1TableOperations_1a837621125cb806c9fe18fa8695d57e5a" kindref="member">io</ref>(),<sp/>manifests)</highlight></codeline>
<codeline lineno="228"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.specsById(<ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1a22a2b04c653f0410b7b3d3a8f2159d1e" kindref="member">ops</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1TableOperations_1a96a251e76611125a2903eb608c97aa67" kindref="member">current</ref>().<ref refid="classorg_1_1apache_1_1iceberg_1_1TableMetadata_1a4f9788bbc885776fbbaefb19c8d72e1c" kindref="member">specsById</ref>())</highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.filterData(rowFilter)</highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.ignoreDeleted()</highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.select(<ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1a63ca015ad13b66d4c8329c97abde97df" kindref="member">SCAN_SUMMARY_COLUMNS</ref>)</highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.entries())<sp/>{</highlight></codeline>
<codeline lineno="233"><highlight class="normal"></highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1PartitionSpec" kindref="compound">PartitionSpec</ref><sp/>spec<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1adb5dbc5964d70db167b231f6a59b9fe3" kindref="member">table</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Table_1a896bd81a171a850db849109694a5b9ce" kindref="member">spec</ref>();</highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(ManifestEntry&lt;?&gt;<sp/>entry<sp/>:<sp/>entries)<sp/>{</highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Long<sp/>timestamp<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1Builder_1a0e738ded11999a59a40c9326fbedda98" kindref="member">snapshotTimestamps</ref>.get(entry.snapshotId());</highlight></codeline>
<codeline lineno="237"><highlight class="normal"></highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>if<sp/>filtering,<sp/>skip<sp/>timestamps<sp/>that<sp/>are<sp/>outside<sp/>the<sp/>range</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(filterByTimestamp<sp/>&amp;&amp;<sp/>!snapshotsInTimeRange.contains(entry.snapshotId()))<sp/>{</highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="242"><highlight class="normal"></highlight></codeline>
<codeline lineno="243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>String<sp/>partition<sp/>=<sp/>spec.<ref refid="classorg_1_1apache_1_1iceberg_1_1PartitionSpec_1a82c06d03a8b9738ecbcbc8cfc987e090" kindref="member">partitionToPath</ref>(entry.file().partition());</highlight></codeline>
<codeline lineno="244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>topN.<ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1TopN_1a8b0733ace1984a8ca6763e30b5adc13d" kindref="member">update</ref>(</highlight></codeline>
<codeline lineno="245"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>partition,</highlight></codeline>
<codeline lineno="246"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metrics<sp/>-&gt;</highlight></codeline>
<codeline lineno="247"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(metrics<sp/>==<sp/></highlight><highlight class="keyword">null</highlight><highlight class="normal"><sp/>?<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1PartitionMetrics" kindref="compound">PartitionMetrics</ref>()<sp/>:<sp/>metrics)</highlight></codeline>
<codeline lineno="248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.updateFromFile(entry.file(),<sp/>timestamp));</highlight></codeline>
<codeline lineno="249"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="250"><highlight class="normal"></highlight></codeline>
<codeline lineno="251"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">catch</highlight><highlight class="normal"><sp/>(IOException<sp/>e)<sp/>{</highlight></codeline>
<codeline lineno="252"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1exceptions_1_1RuntimeIOException" kindref="compound">RuntimeIOException</ref>(e);</highlight></codeline>
<codeline lineno="253"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="254"><highlight class="normal"></highlight></codeline>
<codeline lineno="255"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>topN.<ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1TopN_1a952f283ea8c644cffb9ca9cb22f5aa33" kindref="member">get</ref>();</highlight></codeline>
<codeline lineno="256"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="257"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="258"><highlight class="normal"></highlight></codeline>
<codeline lineno="259" refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1PartitionMetrics" refkind="compound"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1PartitionMetrics" kindref="compound">PartitionMetrics</ref><sp/>{</highlight></codeline>
<codeline lineno="260" refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1PartitionMetrics_1ad917357e4c1b0f93860a1d0ac499e5a1" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1PartitionMetrics_1ad917357e4c1b0f93860a1d0ac499e5a1" kindref="member">fileCount</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="261" refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1PartitionMetrics_1a0fcbc1f06a1fc47cf4128a0f87a19564" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1PartitionMetrics_1a0fcbc1f06a1fc47cf4128a0f87a19564" kindref="member">recordCount</ref><sp/>=<sp/>0L;</highlight></codeline>
<codeline lineno="262" refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1PartitionMetrics_1a2fd65cd9d84d631803bd2c2222eb8186" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1PartitionMetrics_1a2fd65cd9d84d631803bd2c2222eb8186" kindref="member">totalSize</ref><sp/>=<sp/>0L;</highlight></codeline>
<codeline lineno="263" refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1PartitionMetrics_1a8d014b5e550f6ac0b4c046b8830a5f92" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/>Long<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1PartitionMetrics_1a8d014b5e550f6ac0b4c046b8830a5f92" kindref="member">dataTimestampMillis</ref><sp/>=<sp/></highlight><highlight class="keyword">null</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="264"><highlight class="normal"></highlight></codeline>
<codeline lineno="265" refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1PartitionMetrics_1ae63c894e555b269b44c3594c3f7252cd" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1PartitionMetrics_1ae63c894e555b269b44c3594c3f7252cd" kindref="member">fileCount</ref>()<sp/>{</highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1PartitionMetrics_1ad917357e4c1b0f93860a1d0ac499e5a1" kindref="member">fileCount</ref>;</highlight></codeline>
<codeline lineno="267"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="268"><highlight class="normal"></highlight></codeline>
<codeline lineno="269" refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1PartitionMetrics_1ad758a3d1884a21dcdca9ccc20a4b2ba0" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1PartitionMetrics_1ad758a3d1884a21dcdca9ccc20a4b2ba0" kindref="member">recordCount</ref>()<sp/>{</highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1PartitionMetrics_1a0fcbc1f06a1fc47cf4128a0f87a19564" kindref="member">recordCount</ref>;</highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="272"><highlight class="normal"></highlight></codeline>
<codeline lineno="273" refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1PartitionMetrics_1a2bf86759dbc64121cfd52518957fe6ca" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1PartitionMetrics_1a2bf86759dbc64121cfd52518957fe6ca" kindref="member">totalSize</ref>()<sp/>{</highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1PartitionMetrics_1a2fd65cd9d84d631803bd2c2222eb8186" kindref="member">totalSize</ref>;</highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="276"><highlight class="normal"></highlight></codeline>
<codeline lineno="277" refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1PartitionMetrics_1a635c19f3ba6d690f0609a895a5c5e475" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>Long<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1PartitionMetrics_1a635c19f3ba6d690f0609a895a5c5e475" kindref="member">dataTimestampMillis</ref>()<sp/>{</highlight></codeline>
<codeline lineno="278"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1PartitionMetrics_1a8d014b5e550f6ac0b4c046b8830a5f92" kindref="member">dataTimestampMillis</ref>;</highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="280"><highlight class="normal"></highlight></codeline>
<codeline lineno="281"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1PartitionMetrics" kindref="compound">PartitionMetrics</ref><sp/>updateFromCounts(</highlight></codeline>
<codeline lineno="282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>numFiles,<sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>filesRecordCount,<sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>filesSize,<sp/>Long<sp/>timestampMillis)<sp/>{</highlight></codeline>
<codeline lineno="283"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this.fileCount<sp/>+=<sp/>numFiles;</highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this.recordCount<sp/>+=<sp/>filesRecordCount;</highlight></codeline>
<codeline lineno="285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this.totalSize<sp/>+=<sp/>filesSize;</highlight></codeline>
<codeline lineno="286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(timestampMillis<sp/>!=<sp/></highlight><highlight class="keyword">null</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="287"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;&amp;<sp/>(<ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1PartitionMetrics_1a8d014b5e550f6ac0b4c046b8830a5f92" kindref="member">dataTimestampMillis</ref><sp/>==<sp/></highlight><highlight class="keyword">null</highlight><highlight class="normal"><sp/>||<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1PartitionMetrics_1a8d014b5e550f6ac0b4c046b8830a5f92" kindref="member">dataTimestampMillis</ref><sp/>&lt;<sp/>timestampMillis))<sp/>{</highlight></codeline>
<codeline lineno="288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this.dataTimestampMillis<sp/>=<sp/>timestampMillis;</highlight></codeline>
<codeline lineno="289"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="290"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">this</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="291"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="292"><highlight class="normal"></highlight></codeline>
<codeline lineno="293" refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1PartitionMetrics_1a62f800818597c7edacc9d89ceddebbc6" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1PartitionMetrics" kindref="compound">PartitionMetrics</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1PartitionMetrics_1a62f800818597c7edacc9d89ceddebbc6" kindref="member">updateFromFile</ref>(<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1ContentFile" kindref="compound">ContentFile&lt;?&gt;</ref><sp/>file,<sp/>Long<sp/>timestampMillis)<sp/>{</highlight></codeline>
<codeline lineno="294"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this.fileCount<sp/>+=<sp/>1;</highlight></codeline>
<codeline lineno="295"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this.recordCount<sp/>+=<sp/>file.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1ContentFile_1a1368ff1d89aea31a284482dcf6a37ff5" kindref="member">recordCount</ref>();</highlight></codeline>
<codeline lineno="296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this.totalSize<sp/>+=<sp/>file.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1ContentFile_1a81bb72e22fef076e30bad1a47cc8bf8f" kindref="member">fileSizeInBytes</ref>();</highlight></codeline>
<codeline lineno="297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(timestampMillis<sp/>!=<sp/></highlight><highlight class="keyword">null</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;&amp;<sp/>(<ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1PartitionMetrics_1a8d014b5e550f6ac0b4c046b8830a5f92" kindref="member">dataTimestampMillis</ref><sp/>==<sp/></highlight><highlight class="keyword">null</highlight><highlight class="normal"><sp/>||<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1PartitionMetrics_1a8d014b5e550f6ac0b4c046b8830a5f92" kindref="member">dataTimestampMillis</ref><sp/>&lt;<sp/>timestampMillis))<sp/>{</highlight></codeline>
<codeline lineno="299"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this.dataTimestampMillis<sp/>=<sp/>timestampMillis;</highlight></codeline>
<codeline lineno="300"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="301"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">this</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="302"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="303"><highlight class="normal"></highlight></codeline>
<codeline lineno="304"><highlight class="normal"><sp/><sp/><sp/><sp/>@Override</highlight></codeline>
<codeline lineno="305" refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1PartitionMetrics_1a82d3c2c0ed5efa944ff81f09b920fa22" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>String<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1PartitionMetrics_1a82d3c2c0ed5efa944ff81f09b920fa22" kindref="member">toString</ref>()<sp/>{</highlight></codeline>
<codeline lineno="306"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>String<sp/>dataTimestamp<sp/>=</highlight></codeline>
<codeline lineno="307"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1PartitionMetrics_1a8d014b5e550f6ac0b4c046b8830a5f92" kindref="member">dataTimestampMillis</ref><sp/>!=<sp/></highlight><highlight class="keyword">null</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="308"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>?<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1util_1_1DateTimeUtil" kindref="compound">DateTimeUtil</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1util_1_1DateTimeUtil_1af1cc9a259220efe49d435ed1909f6bb3" kindref="member">formatTimestampMillis</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1PartitionMetrics_1a8d014b5e550f6ac0b4c046b8830a5f92" kindref="member">dataTimestampMillis</ref>)</highlight></codeline>
<codeline lineno="309"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:<sp/></highlight><highlight class="keyword">null</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="310"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;PartitionMetrics(fileCount=&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="311"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1PartitionMetrics_1ad917357e4c1b0f93860a1d0ac499e5a1" kindref="member">fileCount</ref></highlight></codeline>
<codeline lineno="312"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+<sp/></highlight><highlight class="stringliteral">&quot;,<sp/>recordCount=&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="313"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1PartitionMetrics_1a0fcbc1f06a1fc47cf4128a0f87a19564" kindref="member">recordCount</ref></highlight></codeline>
<codeline lineno="314"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+<sp/></highlight><highlight class="stringliteral">&quot;,<sp/>totalSize=&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="315"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1PartitionMetrics_1a2fd65cd9d84d631803bd2c2222eb8186" kindref="member">totalSize</ref></highlight></codeline>
<codeline lineno="316"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+<sp/></highlight><highlight class="stringliteral">&quot;,<sp/>dataTimestamp=&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="317"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+<sp/>dataTimestamp</highlight></codeline>
<codeline lineno="318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+<sp/></highlight><highlight class="stringliteral">&quot;)&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="319"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="320"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="321"><highlight class="normal"></highlight></codeline>
<codeline lineno="322" refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1TopN" refkind="compound"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1TopN" kindref="compound">TopN</ref>&lt;K,<sp/>V&gt;<sp/>{</highlight></codeline>
<codeline lineno="323" refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1TopN_1ae0787606bf56ef72542a3ad4be5900a8" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1TopN_1ae0787606bf56ef72542a3ad4be5900a8" kindref="member">maxSize</ref>;</highlight></codeline>
<codeline lineno="324" refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1TopN_1adb4c7bef1a786f2b5afd98429620463a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">boolean</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1TopN_1adb4c7bef1a786f2b5afd98429620463a" kindref="member">throwIfLimited</ref>;</highlight></codeline>
<codeline lineno="325" refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1TopN_1a16ee8701ff7db36bcb0bba2affa8c4df" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/>NavigableMap&lt;K,<sp/>V&gt;<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1TopN_1a16ee8701ff7db36bcb0bba2affa8c4df" kindref="member">map</ref>;</highlight></codeline>
<codeline lineno="326" refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1TopN_1a9a9e609d2c255ea25d1359ef9655ab9b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/>Comparator&lt;?<sp/>super<sp/>K&gt;<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1TopN_1a9a9e609d2c255ea25d1359ef9655ab9b" kindref="member">keyComparator</ref>;</highlight></codeline>
<codeline lineno="327" refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1TopN_1ad0d379032c3e9fefeb2d00ad08db5ebc" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/>K<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1TopN_1ad0d379032c3e9fefeb2d00ad08db5ebc" kindref="member">cut</ref><sp/>=<sp/></highlight><highlight class="keyword">null</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="328"><highlight class="normal"></highlight></codeline>
<codeline lineno="329"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1TopN" kindref="compound">TopN</ref>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1TopN_1ae0787606bf56ef72542a3ad4be5900a8" kindref="member">maxSize</ref>,<sp/></highlight><highlight class="keywordtype">boolean</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1TopN_1adb4c7bef1a786f2b5afd98429620463a" kindref="member">throwIfLimited</ref>,<sp/>Comparator&lt;?<sp/>super<sp/>K&gt;<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1TopN_1a9a9e609d2c255ea25d1359ef9655ab9b" kindref="member">keyComparator</ref>)<sp/>{</highlight></codeline>
<codeline lineno="330"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this.maxSize<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1TopN_1ae0787606bf56ef72542a3ad4be5900a8" kindref="member">maxSize</ref>;</highlight></codeline>
<codeline lineno="331"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this.throwIfLimited<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1TopN_1adb4c7bef1a786f2b5afd98429620463a" kindref="member">throwIfLimited</ref>;</highlight></codeline>
<codeline lineno="332"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this.map<sp/>=<sp/>Maps.newTreeMap(<ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1TopN_1a9a9e609d2c255ea25d1359ef9655ab9b" kindref="member">keyComparator</ref>);</highlight></codeline>
<codeline lineno="333"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this.keyComparator<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1TopN_1a9a9e609d2c255ea25d1359ef9655ab9b" kindref="member">keyComparator</ref>;</highlight></codeline>
<codeline lineno="334"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="335"><highlight class="normal"></highlight></codeline>
<codeline lineno="336" refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1TopN_1a8b0733ace1984a8ca6763e30b5adc13d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1TopN_1a8b0733ace1984a8ca6763e30b5adc13d" kindref="member">update</ref>(K<sp/>key,<sp/>Function&lt;V,<sp/>V&gt;<sp/>updateFunc)<sp/>{</highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>if<sp/>there<sp/>is<sp/>a<sp/>cut<sp/>and<sp/>it<sp/>comes<sp/>before<sp/>the<sp/>given<sp/>key,<sp/>do<sp/>nothing</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="338"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1TopN_1ad0d379032c3e9fefeb2d00ad08db5ebc" kindref="member">cut</ref><sp/>!=<sp/></highlight><highlight class="keyword">null</highlight><highlight class="normal"><sp/>&amp;&amp;<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1TopN_1a9a9e609d2c255ea25d1359ef9655ab9b" kindref="member">keyComparator</ref>.compare(<ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1TopN_1ad0d379032c3e9fefeb2d00ad08db5ebc" kindref="member">cut</ref>,<sp/>key)<sp/>&lt;=<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="340"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="341"><highlight class="normal"></highlight></codeline>
<codeline lineno="342"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>call<sp/>the<sp/>update<sp/>function<sp/>and<sp/>add<sp/>the<sp/>result<sp/>to<sp/>the<sp/>map</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1TopN_1a16ee8701ff7db36bcb0bba2affa8c4df" kindref="member">map</ref>.put(key,<sp/>updateFunc.apply(<ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1TopN_1a16ee8701ff7db36bcb0bba2affa8c4df" kindref="member">map</ref>.get(key)));</highlight></codeline>
<codeline lineno="344"><highlight class="normal"></highlight></codeline>
<codeline lineno="345"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>enforce<sp/>the<sp/>size<sp/>constraint<sp/>and<sp/>update<sp/>the<sp/>cut<sp/>if<sp/>some<sp/>keys<sp/>are<sp/>excluded</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(<ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1TopN_1a16ee8701ff7db36bcb0bba2affa8c4df" kindref="member">map</ref>.size()<sp/>&gt;<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1TopN_1ae0787606bf56ef72542a3ad4be5900a8" kindref="member">maxSize</ref>)<sp/>{</highlight></codeline>
<codeline lineno="347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1TopN_1adb4c7bef1a786f2b5afd98429620463a" kindref="member">throwIfLimited</ref>)<sp/>{</highlight></codeline>
<codeline lineno="348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>IllegalStateException(</highlight></codeline>
<codeline lineno="349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>String.format(</highlight><highlight class="stringliteral">&quot;Too<sp/>many<sp/>matching<sp/>keys:<sp/>more<sp/>than<sp/>%d&quot;</highlight><highlight class="normal">,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1TopN_1ae0787606bf56ef72542a3ad4be5900a8" kindref="member">maxSize</ref>));</highlight></codeline>
<codeline lineno="350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="351"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this.cut<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1TopN_1a16ee8701ff7db36bcb0bba2affa8c4df" kindref="member">map</ref>.lastKey();</highlight></codeline>
<codeline lineno="352"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1TopN_1a16ee8701ff7db36bcb0bba2affa8c4df" kindref="member">map</ref>.remove(<ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1TopN_1ad0d379032c3e9fefeb2d00ad08db5ebc" kindref="member">cut</ref>);</highlight></codeline>
<codeline lineno="353"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="354"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="355"><highlight class="normal"></highlight></codeline>
<codeline lineno="356" refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1TopN_1a952f283ea8c644cffb9ca9cb22f5aa33" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>Map&lt;K,<sp/>V&gt;<sp/></highlight><highlight class="keyword">get</highlight><highlight class="normal">()<sp/>{</highlight></codeline>
<codeline lineno="357"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ImmutableSortedMap.copyOfSorted(<ref refid="classorg_1_1apache_1_1iceberg_1_1ScanSummary_1_1TopN_1a16ee8701ff7db36bcb0bba2affa8c4df" kindref="member">map</ref>);</highlight></codeline>
<codeline lineno="358"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="359"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="360"><highlight class="normal"></highlight></codeline>
<codeline lineno="361"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1expressions_1_1Expression" kindref="compound">Expression</ref><sp/>joinFilters(List&lt;Expression&gt;<sp/>expressions)<sp/>{</highlight></codeline>
<codeline lineno="362"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1expressions_1_1Expression" kindref="compound">Expression</ref><sp/>result<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1Expressions" kindref="compound">Expressions</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1Expressions_1a53d1494a86985c74259aa1f8982e55c2" kindref="member">alwaysTrue</ref>();</highlight></codeline>
<codeline lineno="363"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1expressions_1_1Expression" kindref="compound">Expression</ref><sp/>expression<sp/>:<sp/>expressions)<sp/>{</highlight></codeline>
<codeline lineno="364"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1Expressions" kindref="compound">Expressions</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1expressions_1_1Expressions_1ab5f3130e4b4bc72d48c2c120cabf2193" kindref="member">and</ref>(result,<sp/>expression);</highlight></codeline>
<codeline lineno="365"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="366"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result;</highlight></codeline>
<codeline lineno="367"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="368"><highlight class="normal"></highlight></codeline>
<codeline lineno="369"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>toMillis(</highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>timestamp)<sp/>{</highlight></codeline>
<codeline lineno="370"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(timestamp<sp/>&lt;<sp/>10000000000L)<sp/>{</highlight></codeline>
<codeline lineno="371"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>in<sp/>seconds</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="372"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>timestamp<sp/>*<sp/>1000;</highlight></codeline>
<codeline lineno="373"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(timestamp<sp/>&lt;<sp/>10000000000000L)<sp/>{</highlight></codeline>
<codeline lineno="374"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>in<sp/>millis</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="375"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>timestamp;</highlight></codeline>
<codeline lineno="376"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="377"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>in<sp/>micros</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="378"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>timestamp<sp/>/<sp/>1000;</highlight></codeline>
<codeline lineno="379"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="380"><highlight class="normal"></highlight></codeline>
<codeline lineno="381"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>Pair&lt;Long,<sp/>Long&gt;<sp/>timestampRange(List&lt;UnboundPredicate&lt;Long&gt;&gt;<sp/>timeFilters)<sp/>{</highlight></codeline>
<codeline lineno="382"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>evaluation<sp/>is<sp/>inclusive</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="383"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>minTimestamp<sp/>=<sp/>Long.MIN_VALUE;</highlight></codeline>
<codeline lineno="384"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>maxTimestamp<sp/>=<sp/>Long.MAX_VALUE;</highlight></codeline>
<codeline lineno="385"><highlight class="normal"></highlight></codeline>
<codeline lineno="386"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(UnboundPredicate&lt;Long&gt;<sp/>pred<sp/>:<sp/>timeFilters)<sp/>{</highlight></codeline>
<codeline lineno="387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>value<sp/>=<sp/>pred.literal().value();</highlight></codeline>
<codeline lineno="388"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(pred.op())<sp/>{</highlight></codeline>
<codeline lineno="389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>LT:</highlight></codeline>
<codeline lineno="390"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(value<sp/>-<sp/>1<sp/>&lt;<sp/>maxTimestamp)<sp/>{</highlight></codeline>
<codeline lineno="391"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>maxTimestamp<sp/>=<sp/>value<sp/>-<sp/>1;</highlight></codeline>
<codeline lineno="392"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="393"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="394"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>LT_EQ:</highlight></codeline>
<codeline lineno="395"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(value<sp/>&lt;<sp/>maxTimestamp)<sp/>{</highlight></codeline>
<codeline lineno="396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>maxTimestamp<sp/>=<sp/>value;</highlight></codeline>
<codeline lineno="397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="398"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>GT:</highlight></codeline>
<codeline lineno="400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(value<sp/>+<sp/>1<sp/>&gt;<sp/>minTimestamp)<sp/>{</highlight></codeline>
<codeline lineno="401"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>minTimestamp<sp/>=<sp/>value<sp/>+<sp/>1;</highlight></codeline>
<codeline lineno="402"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="403"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="404"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>GT_EQ:</highlight></codeline>
<codeline lineno="405"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(value<sp/>&gt;<sp/>minTimestamp)<sp/>{</highlight></codeline>
<codeline lineno="406"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>minTimestamp<sp/>=<sp/>value;</highlight></codeline>
<codeline lineno="407"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="408"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="409"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>EQ:</highlight></codeline>
<codeline lineno="410"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(value<sp/>&lt;<sp/>maxTimestamp)<sp/>{</highlight></codeline>
<codeline lineno="411"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>maxTimestamp<sp/>=<sp/>value;</highlight></codeline>
<codeline lineno="412"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="413"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(value<sp/>&gt;<sp/>minTimestamp)<sp/>{</highlight></codeline>
<codeline lineno="414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>minTimestamp<sp/>=<sp/>value;</highlight></codeline>
<codeline lineno="415"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="417"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="418"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>UnsupportedOperationException(</highlight></codeline>
<codeline lineno="419"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Cannot<sp/>filter<sp/>timestamps<sp/>using<sp/>predicate:<sp/>&quot;</highlight><highlight class="normal"><sp/>+<sp/>pred);</highlight></codeline>
<codeline lineno="420"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="421"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="422"><highlight class="normal"></highlight></codeline>
<codeline lineno="423"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(maxTimestamp<sp/>&lt;<sp/>minTimestamp)<sp/>{</highlight></codeline>
<codeline lineno="424"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>IllegalArgumentException(</highlight></codeline>
<codeline lineno="425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;No<sp/>timestamps<sp/>can<sp/>match<sp/>filters:<sp/>&quot;</highlight><highlight class="normal"><sp/>+<sp/>Joiner.on(</highlight><highlight class="stringliteral">&quot;,<sp/>&quot;</highlight><highlight class="normal">).join(timeFilters));</highlight></codeline>
<codeline lineno="426"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="427"><highlight class="normal"></highlight></codeline>
<codeline lineno="428"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>Pair.of(minTimestamp,<sp/>maxTimestamp);</highlight></codeline>
<codeline lineno="429"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="430"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="core/src/main/java/org/apache/iceberg/ScanSummary.java"/>
  </compounddef>
</doxygen>
