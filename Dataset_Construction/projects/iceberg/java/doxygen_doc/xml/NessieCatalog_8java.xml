<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.17">
  <compounddef id="NessieCatalog_8java" kind="file" language="Java">
    <compoundname>NessieCatalog.java</compoundname>
    <innerclass refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog" prot="public">org::apache::iceberg::nessie::NessieCatalog</innerclass>
    <innernamespace refid="namespaceorg_1_1apache_1_1iceberg_1_1nessie">org::apache::iceberg::nessie</innernamespace>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">/*</highlight></codeline>
<codeline lineno="2"><highlight class="comment"><sp/>*<sp/>Licensed<sp/>to<sp/>the<sp/>Apache<sp/>Software<sp/>Foundation<sp/>(ASF)<sp/>under<sp/>one</highlight></codeline>
<codeline lineno="3"><highlight class="comment"><sp/>*<sp/>or<sp/>more<sp/>contributor<sp/>license<sp/>agreements.<sp/><sp/>See<sp/>the<sp/>NOTICE<sp/>file</highlight></codeline>
<codeline lineno="4"><highlight class="comment"><sp/>*<sp/>distributed<sp/>with<sp/>this<sp/>work<sp/>for<sp/>additional<sp/>information</highlight></codeline>
<codeline lineno="5"><highlight class="comment"><sp/>*<sp/>regarding<sp/>copyright<sp/>ownership.<sp/><sp/>The<sp/>ASF<sp/>licenses<sp/>this<sp/>file</highlight></codeline>
<codeline lineno="6"><highlight class="comment"><sp/>*<sp/>to<sp/>you<sp/>under<sp/>the<sp/>Apache<sp/>License,<sp/>Version<sp/>2.0<sp/>(the</highlight></codeline>
<codeline lineno="7"><highlight class="comment"><sp/>*<sp/>&quot;License&quot;);<sp/>you<sp/>may<sp/>not<sp/>use<sp/>this<sp/>file<sp/>except<sp/>in<sp/>compliance</highlight></codeline>
<codeline lineno="8"><highlight class="comment"><sp/>*<sp/>with<sp/>the<sp/>License.<sp/><sp/>You<sp/>may<sp/>obtain<sp/>a<sp/>copy<sp/>of<sp/>the<sp/>License<sp/>at</highlight></codeline>
<codeline lineno="9"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="10"><highlight class="comment"><sp/>*<sp/><sp/><sp/>http://www.apache.org/licenses/LICENSE-2.0</highlight></codeline>
<codeline lineno="11"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="12"><highlight class="comment"><sp/>*<sp/>Unless<sp/>required<sp/>by<sp/>applicable<sp/>law<sp/>or<sp/>agreed<sp/>to<sp/>in<sp/>writing,</highlight></codeline>
<codeline lineno="13"><highlight class="comment"><sp/>*<sp/>software<sp/>distributed<sp/>under<sp/>the<sp/>License<sp/>is<sp/>distributed<sp/>on<sp/>an</highlight></codeline>
<codeline lineno="14"><highlight class="comment"><sp/>*<sp/>&quot;AS<sp/>IS&quot;<sp/>BASIS,<sp/>WITHOUT<sp/>WARRANTIES<sp/>OR<sp/>CONDITIONS<sp/>OF<sp/>ANY</highlight></codeline>
<codeline lineno="15"><highlight class="comment"><sp/>*<sp/>KIND,<sp/>either<sp/>express<sp/>or<sp/>implied.<sp/><sp/>See<sp/>the<sp/>License<sp/>for<sp/>the</highlight></codeline>
<codeline lineno="16"><highlight class="comment"><sp/>*<sp/>specific<sp/>language<sp/>governing<sp/>permissions<sp/>and<sp/>limitations</highlight></codeline>
<codeline lineno="17"><highlight class="comment"><sp/>*<sp/>under<sp/>the<sp/>License.</highlight></codeline>
<codeline lineno="18"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="19" refid="namespaceorg_1_1apache_1_1iceberg_1_1nessie" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">package<sp/></highlight><highlight class="normal">org.apache.iceberg.nessie;</highlight></codeline>
<codeline lineno="20"><highlight class="normal"></highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>java.io.IOException;</highlight></codeline>
<codeline lineno="22"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>java.util.List;</highlight></codeline>
<codeline lineno="23"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>java.util.Locale;</highlight></codeline>
<codeline lineno="24"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>java.util.Map;</highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>java.util.Set;</highlight></codeline>
<codeline lineno="26"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>java.util.UUID;</highlight></codeline>
<codeline lineno="27"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>java.util.function.Function;</highlight></codeline>
<codeline lineno="28"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>java.util.regex.Matcher;</highlight></codeline>
<codeline lineno="29"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>java.util.regex.Pattern;</highlight></codeline>
<codeline lineno="30"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1CatalogProperties" kindref="compound">CatalogProperties</ref>;</highlight></codeline>
<codeline lineno="31"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1CatalogUtil" kindref="compound">CatalogUtil</ref>;</highlight></codeline>
<codeline lineno="32"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1TableOperations" kindref="compound">TableOperations</ref>;</highlight></codeline>
<codeline lineno="33"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1TableProperties" kindref="compound">TableProperties</ref>;</highlight></codeline>
<codeline lineno="34"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1catalog" kindref="compound">catalog</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1Namespace" kindref="compound">Namespace</ref>;</highlight></codeline>
<codeline lineno="35"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1catalog" kindref="compound">catalog</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1SupportsNamespaces" kindref="compound">SupportsNamespaces</ref>;</highlight></codeline>
<codeline lineno="36"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1catalog" kindref="compound">catalog</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1TableIdentifier" kindref="compound">TableIdentifier</ref>;</highlight></codeline>
<codeline lineno="37"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1exceptions" kindref="compound">exceptions</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1exceptions_1_1NamespaceNotEmptyException" kindref="compound">NamespaceNotEmptyException</ref>;</highlight></codeline>
<codeline lineno="38"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1exceptions" kindref="compound">exceptions</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1exceptions_1_1NoSuchNamespaceException" kindref="compound">NoSuchNamespaceException</ref>;</highlight></codeline>
<codeline lineno="39"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1hadoop" kindref="compound">hadoop</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1hadoop_1_1Configurable" kindref="compound">Configurable</ref>;</highlight></codeline>
<codeline lineno="40"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1io" kindref="compound">io</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1CloseableGroup" kindref="compound">CloseableGroup</ref>;</highlight></codeline>
<codeline lineno="41"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1io" kindref="compound">io</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1io_1_1FileIO" kindref="compound">FileIO</ref>;</highlight></codeline>
<codeline lineno="42"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.relocated.com.google.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1common" kindref="compound">common</ref>.annotations.VisibleForTesting;</highlight></codeline>
<codeline lineno="43"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.relocated.com.google.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1common" kindref="compound">common</ref>.base.<ref refid="classorg_1_1apache_1_1iceberg_1_1relocated_1_1com_1_1google_1_1common_1_1base_1_1Joiner" kindref="compound">Joiner</ref>;</highlight></codeline>
<codeline lineno="44"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.relocated.com.google.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1common" kindref="compound">common</ref>.base.<ref refid="classorg_1_1apache_1_1iceberg_1_1relocated_1_1com_1_1google_1_1common_1_1base_1_1Preconditions" kindref="compound">Preconditions</ref>;</highlight></codeline>
<codeline lineno="45"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.relocated.com.google.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1common" kindref="compound">common</ref>.collect.ImmutableMap;</highlight></codeline>
<codeline lineno="46"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1util" kindref="compound">util</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1util_1_1LocationUtil" kindref="compound">LocationUtil</ref>;</highlight></codeline>
<codeline lineno="47"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1view" kindref="compound">view</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1view_1_1BaseMetastoreViewCatalog" kindref="compound">BaseMetastoreViewCatalog</ref>;</highlight></codeline>
<codeline lineno="48"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1view" kindref="compound">view</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1view_1_1ViewOperations" kindref="compound">ViewOperations</ref>;</highlight></codeline>
<codeline lineno="49"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.projectnessie.client.NessieClientBuilder;</highlight></codeline>
<codeline lineno="50"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.projectnessie.client.NessieConfigConstants;</highlight></codeline>
<codeline lineno="51"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.projectnessie.client.api.NessieApiV1;</highlight></codeline>
<codeline lineno="52"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.projectnessie.client.api.NessieApiV2;</highlight></codeline>
<codeline lineno="53"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.projectnessie.client.config.NessieClientConfigSource;</highlight></codeline>
<codeline lineno="54"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.projectnessie.client.config.NessieClientConfigSources;</highlight></codeline>
<codeline lineno="55"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.projectnessie.model.Content;</highlight></codeline>
<codeline lineno="56"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.projectnessie.model.ContentKey;</highlight></codeline>
<codeline lineno="57"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.projectnessie.model.TableReference;</highlight></codeline>
<codeline lineno="58"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.slf4j.Logger;</highlight></codeline>
<codeline lineno="59"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.slf4j.LoggerFactory;</highlight></codeline>
<codeline lineno="60"><highlight class="normal"></highlight></codeline>
<codeline lineno="62" refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog" refkind="compound"><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog" kindref="compound">NessieCatalog</ref><sp/></highlight><highlight class="keyword">extends</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1view_1_1BaseMetastoreViewCatalog" kindref="compound">BaseMetastoreViewCatalog</ref></highlight></codeline>
<codeline lineno="63"><highlight class="normal"><sp/><sp/><sp/><sp/>implements<sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1SupportsNamespaces" kindref="compound">SupportsNamespaces</ref>,<sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1hadoop_1_1Configurable" kindref="compound">Configurable</ref>&lt;Object&gt;<sp/>{</highlight></codeline>
<codeline lineno="64"><highlight class="normal"></highlight></codeline>
<codeline lineno="65" refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a8b1220faeb418e336fc2cf8bdcfe0695" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/>Logger<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a8b1220faeb418e336fc2cf8bdcfe0695" kindref="member">LOG</ref><sp/>=<sp/>LoggerFactory.getLogger(<ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog" kindref="compound">NessieCatalog</ref>.class);</highlight></codeline>
<codeline lineno="66" refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1ab2e1512ca1225b8660abd61c023c026f" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/>Joiner<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1ab2e1512ca1225b8660abd61c023c026f" kindref="member">SLASH</ref><sp/>=<sp/>Joiner.on(</highlight><highlight class="stringliteral">&quot;/&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="67" refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1aceddea9f684468bd4778cc5977dc0a05" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/>String<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1aceddea9f684468bd4778cc5977dc0a05" kindref="member">NAMESPACE_LOCATION_PROPS</ref><sp/>=<sp/></highlight><highlight class="stringliteral">&quot;location&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="68"><highlight class="normal"></highlight></codeline>
<codeline lineno="69" refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a89a0d7c0ea6fbfc20a148d0d27d5f1ef" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/>Map&lt;String,<sp/>String&gt;<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a89a0d7c0ea6fbfc20a148d0d27d5f1ef" kindref="member">DEFAULT_CATALOG_OPTIONS</ref><sp/>=</highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>ImmutableMap.&lt;String,<sp/>String&gt;builder()</highlight></codeline>
<codeline lineno="71"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.put(<ref refid="classorg_1_1apache_1_1iceberg_1_1CatalogProperties" kindref="compound">CatalogProperties</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1CatalogProperties_1a5a82f420697447f7e88a470cc2b41806" kindref="member">TABLE_DEFAULT_PREFIX</ref><sp/>+<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1TableProperties" kindref="compound">TableProperties</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1TableProperties_1a93ee0d7c5766cc29426a1e8ae2151a88" kindref="member">GC_ENABLED</ref>,<sp/></highlight><highlight class="stringliteral">&quot;false&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="72"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.put(</highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1CatalogProperties" kindref="compound">CatalogProperties</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1CatalogProperties_1a5a82f420697447f7e88a470cc2b41806" kindref="member">TABLE_DEFAULT_PREFIX</ref></highlight></codeline>
<codeline lineno="74"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1TableProperties" kindref="compound">TableProperties</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1TableProperties_1a4ba5bee73513b9663f532304f6e9f2a4" kindref="member">METADATA_DELETE_AFTER_COMMIT_ENABLED</ref>,</highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;false&quot;</highlight><highlight class="normal">)<sp/></highlight><highlight class="comment">//<sp/>just<sp/>in<sp/>case<sp/>METADATA_DELETE_AFTER_COMMIT_ENABLED_DEFAULT<sp/>changes</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.build();</highlight></codeline>
<codeline lineno="77"><highlight class="normal"></highlight></codeline>
<codeline lineno="78" refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a4f697b5b226c61289ab7b300f5cd49c7" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieIcebergClient" kindref="compound">NessieIcebergClient</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a4f697b5b226c61289ab7b300f5cd49c7" kindref="member">client</ref>;</highlight></codeline>
<codeline lineno="79" refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a4021722b267295a1688da20f94607ca1" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/>String<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a4021722b267295a1688da20f94607ca1" kindref="member">warehouseLocation</ref>;</highlight></codeline>
<codeline lineno="80" refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a6add9b6b06d3b677acf558887926c87e" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/>Object<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a6add9b6b06d3b677acf558887926c87e" kindref="member">config</ref>;</highlight></codeline>
<codeline lineno="81" refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a488890bc1208240512dad3c837d09c90" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/>String<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a488890bc1208240512dad3c837d09c90" kindref="member">name</ref>;</highlight></codeline>
<codeline lineno="82" refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1adf187bccb52b6225cf4d6099c7499b8d" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1io_1_1FileIO" kindref="compound">FileIO</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1adf187bccb52b6225cf4d6099c7499b8d" kindref="member">fileIO</ref>;</highlight></codeline>
<codeline lineno="83" refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1ab7a8e2e6a51170cfccbae8e620f69b25" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/>Map&lt;String,<sp/>String&gt;<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1ab7a8e2e6a51170cfccbae8e620f69b25" kindref="member">catalogOptions</ref><sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a89a0d7c0ea6fbfc20a148d0d27d5f1ef" kindref="member">DEFAULT_CATALOG_OPTIONS</ref>;</highlight></codeline>
<codeline lineno="84" refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1aae09b9178585e51c89d40c9ecd054fea" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1CloseableGroup" kindref="compound">CloseableGroup</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1aae09b9178585e51c89d40c9ecd054fea" kindref="member">closeableGroup</ref>;</highlight></codeline>
<codeline lineno="85"><highlight class="normal"></highlight></codeline>
<codeline lineno="86" refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a11dc88677d7ff70839645c02908eb02d" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a11dc88677d7ff70839645c02908eb02d" kindref="member">NessieCatalog</ref>()<sp/>{}</highlight></codeline>
<codeline lineno="87"><highlight class="normal"></highlight></codeline>
<codeline lineno="88"><highlight class="normal"><sp/><sp/>@SuppressWarnings(</highlight><highlight class="stringliteral">&quot;checkstyle:HiddenField&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/>@Override</highlight></codeline>
<codeline lineno="90" refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1ae733a28af289416360049cca40703568" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1ae733a28af289416360049cca40703568" kindref="member">initialize</ref>(String<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a488890bc1208240512dad3c837d09c90" kindref="member">name</ref>,<sp/>Map&lt;String,<sp/>String&gt;<sp/>options)<sp/>{</highlight></codeline>
<codeline lineno="91"><highlight class="normal"><sp/><sp/><sp/><sp/>Map&lt;String,<sp/>String&gt;<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1ab7a8e2e6a51170cfccbae8e620f69b25" kindref="member">catalogOptions</ref><sp/>=<sp/>ImmutableMap.copyOf(options);</highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/><sp/><sp/>String<sp/>fileIOImpl<sp/>=</highlight></codeline>
<codeline lineno="93"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>options.getOrDefault(</highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1CatalogProperties" kindref="compound">CatalogProperties</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1CatalogProperties_1a16455eeabeee0b4bdebfe52e87286ffe" kindref="member">FILE_IO_IMPL</ref>,<sp/></highlight><highlight class="stringliteral">&quot;org.apache.iceberg.hadoop.HadoopFileIO&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>remove<sp/>nessie<sp/>prefix</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="96"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/>Function&lt;String,<sp/>String&gt;<sp/>removePrefix<sp/>=</highlight></codeline>
<codeline lineno="97"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x<sp/>-&gt;<sp/>x.replace(<ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieUtil" kindref="compound">NessieUtil</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieUtil_1aa39bc4cef4c5ed3e7d03e3ca3e4e4fbb" kindref="member">NESSIE_CONFIG_PREFIX</ref>,<sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/>String<sp/>requestedRef<sp/>=</highlight></codeline>
<codeline lineno="99"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>options.get(removePrefix.apply(NessieConfigConstants.CONF_NESSIE_REF));</highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/><sp/><sp/>String<sp/>requestedHash<sp/>=</highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>options.get(removePrefix.apply(NessieConfigConstants.CONF_NESSIE_REF_HASH));</highlight></codeline>
<codeline lineno="102"><highlight class="normal"></highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/>NessieClientConfigSource<sp/>configSource<sp/>=</highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NessieClientConfigSources.mapConfigSource(options)</highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.fallbackTo(x<sp/>-&gt;<sp/>options.get(removePrefix.apply(x)));</highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/><sp/><sp/>NessieClientBuilder<sp/>nessieClientBuilder<sp/>=</highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NessieClientBuilder.createClientBuilderFromSystemSettings(configSource);</highlight></codeline>
<codeline lineno="108"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>default<sp/>version<sp/>is<sp/>inferred<sp/>by<sp/>uri.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="109"><highlight class="normal"><sp/><sp/><sp/><sp/>String<sp/>apiVersion<sp/>=<sp/>options.get(removePrefix.apply(<ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieUtil" kindref="compound">NessieUtil</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieUtil_1ab2448b6c5bc347c1698024664fa0ae4a" kindref="member">CLIENT_API_VERSION</ref>));</highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(apiVersion<sp/>==<sp/></highlight><highlight class="keyword">null</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>apiVersion<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1aeca941b5f887ef1ecb4501d1fe53dcea" kindref="member">inferVersionFromURI</ref>(options.get(<ref refid="classorg_1_1apache_1_1iceberg_1_1CatalogProperties" kindref="compound">CatalogProperties</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1CatalogProperties_1aa3a737353e2240af730c63fe3b2e0289" kindref="member">URI</ref>));</highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="113"><highlight class="normal"></highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/>NessieApiV1<sp/>api;</highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(apiVersion)<sp/>{</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;1&quot;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>api<sp/>=<sp/>nessieClientBuilder.build(NessieApiV1.class);</highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;2&quot;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>api<sp/>=<sp/>nessieClientBuilder.build(NessieApiV2.class);</highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>IllegalArgumentException(</highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>String.format(</highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Unsupported<sp/>%s:<sp/>%s.<sp/>Can<sp/>only<sp/>be<sp/>1<sp/>or<sp/>2&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>removePrefix.apply(<ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieUtil" kindref="compound">NessieUtil</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieUtil_1ab2448b6c5bc347c1698024664fa0ae4a" kindref="member">CLIENT_API_VERSION</ref>),<sp/>apiVersion));</highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="128"><highlight class="normal"></highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1ae733a28af289416360049cca40703568" kindref="member">initialize</ref>(</highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a488890bc1208240512dad3c837d09c90" kindref="member">name</ref>,</highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieIcebergClient" kindref="compound">NessieIcebergClient</ref>(api,<sp/>requestedRef,<sp/>requestedHash,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1ab7a8e2e6a51170cfccbae8e620f69b25" kindref="member">catalogOptions</ref>),</highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1CatalogUtil" kindref="compound">CatalogUtil</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1CatalogUtil_1a6ee393ff36e27b54fba258ff34bb9e81" kindref="member">loadFileIO</ref>(fileIOImpl,<sp/>options,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a6add9b6b06d3b677acf558887926c87e" kindref="member">config</ref>),</highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1ab7a8e2e6a51170cfccbae8e620f69b25" kindref="member">catalogOptions</ref>);</highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="135"><highlight class="normal"></highlight></codeline>
<codeline lineno="136" refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1aeca941b5f887ef1ecb4501d1fe53dcea" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>String<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1aeca941b5f887ef1ecb4501d1fe53dcea" kindref="member">inferVersionFromURI</ref>(String<sp/>uri)<sp/>{</highlight></codeline>
<codeline lineno="137"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(uri<sp/>==<sp/></highlight><highlight class="keyword">null</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>IllegalArgumentException(</highlight><highlight class="stringliteral">&quot;URI<sp/>is<sp/>not<sp/>specified<sp/>in<sp/>the<sp/>catalog<sp/>properties&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="140"><highlight class="normal"></highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>match<sp/>for<sp/>uri<sp/>ending<sp/>with<sp/>/v1,<sp/>/v2<sp/>etc</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><sp/><sp/>Pattern<sp/>pattern<sp/>=<sp/>Pattern.compile(</highlight><highlight class="stringliteral">&quot;/v(\\d+)$&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/><sp/><sp/>Matcher<sp/>matcher<sp/>=<sp/>pattern.matcher(uri);</highlight></codeline>
<codeline lineno="144"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(matcher.find())<sp/>{</highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>matcher.group(1);</highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>IllegalArgumentException(</highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>String.format(</highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;URI<sp/>doesn&apos;t<sp/>end<sp/>with<sp/>the<sp/>version:<sp/>%s.<sp/>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+<sp/></highlight><highlight class="stringliteral">&quot;Please<sp/>configure<sp/>`client-api-version`<sp/>in<sp/>the<sp/>catalog<sp/>properties<sp/>explicitly.&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uri));</highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="154"><highlight class="normal"></highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/>@SuppressWarnings(</highlight><highlight class="stringliteral">&quot;checkstyle:HiddenField&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="165" refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a6bc7a901983e63a70beabaa812c8e64b" refkind="member"><highlight class="normal"><sp/><sp/>public<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1ae733a28af289416360049cca40703568" kindref="member">initialize</ref>(</highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>String<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a488890bc1208240512dad3c837d09c90" kindref="member">name</ref>,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieIcebergClient" kindref="compound">NessieIcebergClient</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a4f697b5b226c61289ab7b300f5cd49c7" kindref="member">client</ref>,<sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1io_1_1FileIO" kindref="compound">FileIO</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1adf187bccb52b6225cf4d6099c7499b8d" kindref="member">fileIO</ref>,<sp/>Map&lt;String,<sp/>String&gt;<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1ab7a8e2e6a51170cfccbae8e620f69b25" kindref="member">catalogOptions</ref>)<sp/>{</highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/><sp/><sp/>this.name<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a488890bc1208240512dad3c837d09c90" kindref="member">name</ref><sp/>==<sp/></highlight><highlight class="keyword">null</highlight><highlight class="normal"><sp/>?<sp/></highlight><highlight class="stringliteral">&quot;nessie&quot;</highlight><highlight class="normal"><sp/>:<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a488890bc1208240512dad3c837d09c90" kindref="member">name</ref>;</highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/>this.client<sp/>=<sp/>Preconditions.checkNotNull(<ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a4f697b5b226c61289ab7b300f5cd49c7" kindref="member">client</ref>,<sp/></highlight><highlight class="stringliteral">&quot;client<sp/>must<sp/>be<sp/>non-null&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/>this.fileIO<sp/>=<sp/>Preconditions.checkNotNull(<ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1adf187bccb52b6225cf4d6099c7499b8d" kindref="member">fileIO</ref>,<sp/></highlight><highlight class="stringliteral">&quot;fileIO<sp/>must<sp/>be<sp/>non-null&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/>this.catalogOptions<sp/>=</highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ImmutableMap.&lt;String,<sp/>String&gt;builder()</highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.putAll(<ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a89a0d7c0ea6fbfc20a148d0d27d5f1ef" kindref="member">DEFAULT_CATALOG_OPTIONS</ref>)</highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.putAll(Preconditions.checkNotNull(<ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1ab7a8e2e6a51170cfccbae8e620f69b25" kindref="member">catalogOptions</ref>,<sp/></highlight><highlight class="stringliteral">&quot;catalogOptions<sp/>must<sp/>be<sp/>non-null&quot;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.buildKeepingLast();</highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/>this.warehouseLocation<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a4021722b267295a1688da20f94607ca1" kindref="member">warehouseLocation</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a488890bc1208240512dad3c837d09c90" kindref="member">name</ref>,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1ab7a8e2e6a51170cfccbae8e620f69b25" kindref="member">catalogOptions</ref>);</highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/>this.closeableGroup<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1CloseableGroup" kindref="compound">CloseableGroup</ref>();</highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1aae09b9178585e51c89d40c9ecd054fea" kindref="member">closeableGroup</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1CloseableGroup_1a3ffc580c50ca898063555662a3e30d0d" kindref="member">addCloseable</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a4f697b5b226c61289ab7b300f5cd49c7" kindref="member">client</ref>);</highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1aae09b9178585e51c89d40c9ecd054fea" kindref="member">closeableGroup</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1CloseableGroup_1a3ffc580c50ca898063555662a3e30d0d" kindref="member">addCloseable</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1adf187bccb52b6225cf4d6099c7499b8d" kindref="member">fileIO</ref>);</highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1aae09b9178585e51c89d40c9ecd054fea" kindref="member">closeableGroup</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1CloseableGroup_1a3ffc580c50ca898063555662a3e30d0d" kindref="member">addCloseable</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1BaseMetastoreCatalog_1a483177c0805ea0363b81a7a59e33dc91" kindref="member">metricsReporter</ref>());</highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1aae09b9178585e51c89d40c9ecd054fea" kindref="member">closeableGroup</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1CloseableGroup_1a0c30e0a0bd1d476fee88d8c71fd8d9de" kindref="member">setSuppressCloseFailure</ref>(</highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="182"><highlight class="normal"></highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/>@SuppressWarnings(</highlight><highlight class="stringliteral">&quot;checkstyle:HiddenField&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="184" refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a71202a065053cf06a798a8e69cca913e" refkind="member"><highlight class="normal"><sp/><sp/>private<sp/>String<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a4021722b267295a1688da20f94607ca1" kindref="member">warehouseLocation</ref>(String<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a488890bc1208240512dad3c837d09c90" kindref="member">name</ref>,<sp/>Map&lt;String,<sp/>String&gt;<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1ab7a8e2e6a51170cfccbae8e620f69b25" kindref="member">catalogOptions</ref>)<sp/>{</highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/>String<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a4021722b267295a1688da20f94607ca1" kindref="member">warehouseLocation</ref><sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1ab7a8e2e6a51170cfccbae8e620f69b25" kindref="member">catalogOptions</ref>.get(<ref refid="classorg_1_1apache_1_1iceberg_1_1CatalogProperties" kindref="compound">CatalogProperties</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1CatalogProperties_1a0a16892ccb5c52f49843098b25b0655f" kindref="member">WAREHOUSE_LOCATION</ref>);</highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a4021722b267295a1688da20f94607ca1" kindref="member">warehouseLocation</ref><sp/>==<sp/></highlight><highlight class="keyword">null</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Explicitly<sp/>log<sp/>a<sp/>warning,<sp/>otherwise<sp/>the<sp/>thrown<sp/>exception<sp/>can<sp/>get<sp/>list<sp/>in<sp/>the<sp/>&quot;silent-ish</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>catch&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>in<sp/>o.a.i.spark.Spark3Util.catalogAndIdentifier(o.a.s.sql.SparkSession,<sp/>List&lt;String&gt;,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/>o.a.s.sql.connector.catalog.CatalogPlugin)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>in<sp/>the<sp/>code<sp/>block</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/>Pair&lt;CatalogPlugin,<sp/>Identifier&gt;<sp/>catalogIdentifier<sp/>=</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>SparkUtil.catalogAndIdentifier(nameParts,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>catalogName<sp/>-&gt;<sp/><sp/>{</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>try<sp/>{</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>catalogManager.catalog(catalogName);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>catch<sp/>(Exception<sp/>e)<sp/>{</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>null;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>},</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Identifier::of,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>defaultCatalog,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>currentNamespace</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/>);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a8b1220faeb418e336fc2cf8bdcfe0695" kindref="member">LOG</ref>.warn(</highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Catalog<sp/>creation<sp/>for<sp/>inputName={}<sp/>and<sp/>options<sp/>{}<sp/>failed,<sp/>because<sp/>parameter<sp/>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+<sp/></highlight><highlight class="stringliteral">&quot;&apos;warehouse&apos;<sp/>is<sp/>not<sp/>set,<sp/>Nessie<sp/>can&apos;t<sp/>store<sp/>data.&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a488890bc1208240512dad3c837d09c90" kindref="member">name</ref>,</highlight></codeline>
<codeline lineno="209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1ab7a8e2e6a51170cfccbae8e620f69b25" kindref="member">catalogOptions</ref>);</highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>IllegalStateException(</highlight><highlight class="stringliteral">&quot;Parameter<sp/>&apos;warehouse&apos;<sp/>not<sp/>set,<sp/>Nessie<sp/>can&apos;t<sp/>store<sp/>data.&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="212"><highlight class="normal"></highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1util_1_1LocationUtil" kindref="compound">LocationUtil</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1util_1_1LocationUtil_1aa94d5984076b1ef6e53a6e4ca3793e33" kindref="member">stripTrailingSlash</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a4021722b267295a1688da20f94607ca1" kindref="member">warehouseLocation</ref>);</highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="215"><highlight class="normal"></highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/>@Override</highlight></codeline>
<codeline lineno="217" refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1af188d88205cf98ec52c01ec484d3a316" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1af188d88205cf98ec52c01ec484d3a316" kindref="member">close</ref>()<sp/>throws<sp/>IOException<sp/>{</highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keyword">null</highlight><highlight class="normal"><sp/>!=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1aae09b9178585e51c89d40c9ecd054fea" kindref="member">closeableGroup</ref>)<sp/>{</highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1aae09b9178585e51c89d40c9ecd054fea" kindref="member">closeableGroup</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1CloseableGroup_1aac8e101dc1b6246afba8bb0c6ba9b34a" kindref="member">close</ref>();</highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="222"><highlight class="normal"></highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/>@Override</highlight></codeline>
<codeline lineno="224" refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a6ab4b0c426a22a8a69e139c986148476" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>String<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a6ab4b0c426a22a8a69e139c986148476" kindref="member">name</ref>()<sp/>{</highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a488890bc1208240512dad3c837d09c90" kindref="member">name</ref>;</highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="227"><highlight class="normal"></highlight></codeline>
<codeline lineno="228"><highlight class="normal"><sp/><sp/>@Override</highlight></codeline>
<codeline lineno="229" refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a6865c803e4b587a206b6cdc1f44c02b2" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">protected</highlight><highlight class="normal"><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1TableOperations" kindref="compound">TableOperations</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a6865c803e4b587a206b6cdc1f44c02b2" kindref="member">newTableOps</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1TableIdentifier" kindref="compound">TableIdentifier</ref><sp/>tableIdentifier)<sp/>{</highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><sp/><sp/>TableReference<sp/>tr<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a901566bbef7aaf7730c46ed279d758aa" kindref="member">parseTableReference</ref>(tableIdentifier);</highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieTableOperations" kindref="compound">NessieTableOperations</ref>(</highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ContentKey.of(</highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.projectnessie.model.Namespace.of(tableIdentifier.namespace().levels()),</highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tr.getName()),</highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a4f697b5b226c61289ab7b300f5cd49c7" kindref="member">client</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieIcebergClient_1ae7e7bcbd310b0aedad1be3c067049e24" kindref="member">withReference</ref>(tr.getReference(),<sp/>tr.getHash()),</highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1adf187bccb52b6225cf4d6099c7499b8d" kindref="member">fileIO</ref>);</highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="238"><highlight class="normal"></highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/>@Override</highlight></codeline>
<codeline lineno="240" refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1af1326b107c3bfcf0b88ed7bfb6560e30" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">protected</highlight><highlight class="normal"><sp/>String<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1af1326b107c3bfcf0b88ed7bfb6560e30" kindref="member">defaultWarehouseLocation</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1TableIdentifier" kindref="compound">TableIdentifier</ref><sp/>table)<sp/>{</highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><sp/><sp/>String<sp/>location;</highlight></codeline>
<codeline lineno="242"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(table.<ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1TableIdentifier_1a39e7ddac761e0d02901616d7d5e2b8be" kindref="member">hasNamespace</ref>())<sp/>{</highlight></codeline>
<codeline lineno="243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>String<sp/>baseLocation<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1ab2e1512ca1225b8660abd61c023c026f" kindref="member">SLASH</ref>.join(<ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a4021722b267295a1688da20f94607ca1" kindref="member">warehouseLocation</ref>,<sp/>table.namespace().<ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1TableIdentifier_1afdf4cc9646c2810128f5564bc13ecf28" kindref="member">toString</ref>());</highlight></codeline>
<codeline lineno="244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="245"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>baseLocation<sp/>=</highlight></codeline>
<codeline lineno="246"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1ab54c83343c6383869f8f919928a13ec2" kindref="member">loadNamespaceMetadata</ref>(table.namespace())</highlight></codeline>
<codeline lineno="247"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.getOrDefault(<ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1aceddea9f684468bd4778cc5977dc0a05" kindref="member">NAMESPACE_LOCATION_PROPS</ref>,<sp/>baseLocation);</highlight></codeline>
<codeline lineno="248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">catch</highlight><highlight class="normal"><sp/>(<ref refid="classorg_1_1apache_1_1iceberg_1_1exceptions_1_1NoSuchNamespaceException" kindref="compound">NoSuchNamespaceException</ref><sp/>e)<sp/>{</highlight></codeline>
<codeline lineno="249"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>do<sp/>nothing<sp/>we<sp/>want<sp/>the<sp/>same<sp/>behavior<sp/>that<sp/>if<sp/>the<sp/>location<sp/>is<sp/>not<sp/>defined</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="251"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>location<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1ab2e1512ca1225b8660abd61c023c026f" kindref="member">SLASH</ref>.join(baseLocation,<sp/>table.<ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1TableIdentifier_1aeb31dbd38b5159d60e05b02d9b3f5b9e" kindref="member">name</ref>());</highlight></codeline>
<codeline lineno="252"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="253"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>location<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1ab2e1512ca1225b8660abd61c023c026f" kindref="member">SLASH</ref>.join(<ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a4021722b267295a1688da20f94607ca1" kindref="member">warehouseLocation</ref>,<sp/>table.<ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1TableIdentifier_1aeb31dbd38b5159d60e05b02d9b3f5b9e" kindref="member">name</ref>());</highlight></codeline>
<codeline lineno="254"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="255"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Different<sp/>tables<sp/>with<sp/>same<sp/>table<sp/>name<sp/>can<sp/>exist<sp/>across<sp/>references<sp/>in<sp/>Nessie.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="256"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>To<sp/>avoid<sp/>sharing<sp/>same<sp/>table<sp/>path<sp/>between<sp/>two<sp/>tables<sp/>with<sp/>same<sp/>name,<sp/>use<sp/>uuid<sp/>in<sp/>the<sp/>table</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="257"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>path.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="258"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>location<sp/>+<sp/></highlight><highlight class="stringliteral">&quot;_&quot;</highlight><highlight class="normal"><sp/>+<sp/>UUID.randomUUID();</highlight></codeline>
<codeline lineno="259"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="260"><highlight class="normal"></highlight></codeline>
<codeline lineno="261"><highlight class="normal"><sp/><sp/>@Override</highlight></codeline>
<codeline lineno="262" refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1ace6e74682a05beb511d68940b76dae04" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>List&lt;TableIdentifier&gt;<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1ace6e74682a05beb511d68940b76dae04" kindref="member">listTables</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1Namespace" kindref="compound">Namespace</ref><sp/></highlight><highlight class="keyword">namespace</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a4f697b5b226c61289ab7b300f5cd49c7" kindref="member">client</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieIcebergClient_1ab3bf8781d75807ecda4cf33e058fde2e" kindref="member">listTables</ref>(</highlight><highlight class="keyword">namespace</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="265"><highlight class="normal"></highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/>@Override</highlight></codeline>
<codeline lineno="267" refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a9230709fca61dd2824b572175b1253ff" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">boolean</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a9230709fca61dd2824b572175b1253ff" kindref="member">dropTable</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1TableIdentifier" kindref="compound">TableIdentifier</ref><sp/>identifier,<sp/></highlight><highlight class="keywordtype">boolean</highlight><highlight class="normal"><sp/>purge)<sp/>{</highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/><sp/><sp/>TableReference<sp/>tableReference<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a901566bbef7aaf7730c46ed279d758aa" kindref="member">parseTableReference</ref>(identifier);</highlight></codeline>
<codeline lineno="269"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a4f697b5b226c61289ab7b300f5cd49c7" kindref="member">client</ref></highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.<ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieIcebergClient_1ae7e7bcbd310b0aedad1be3c067049e24" kindref="member">withReference</ref>(tableReference.getReference(),<sp/>tableReference.getHash())</highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.<ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieIcebergClient_1a8f7c458f18ad08f1b93993af45c3f3d8" kindref="member">dropTable</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1aead3d76a5c368a40c385bf72e8cf28f0" kindref="member">identifierWithoutTableReference</ref>(identifier,<sp/>tableReference),<sp/>purge);</highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="273"><highlight class="normal"></highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/>@Override</highlight></codeline>
<codeline lineno="275" refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a79671711f0938302fd792fe810de323b" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a79671711f0938302fd792fe810de323b" kindref="member">renameTable</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1TableIdentifier" kindref="compound">TableIdentifier</ref><sp/>from,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1TableIdentifier" kindref="compound">TableIdentifier</ref><sp/>to)<sp/>{</highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/><sp/><sp/>TableReference<sp/>fromTableReference<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a901566bbef7aaf7730c46ed279d758aa" kindref="member">parseTableReference</ref>(from);</highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/><sp/><sp/>TableReference<sp/>toTableReference<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a901566bbef7aaf7730c46ed279d758aa" kindref="member">parseTableReference</ref>(to);</highlight></codeline>
<codeline lineno="278"><highlight class="normal"></highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a3b33e44e1a3654a4989f48aee17bfd47" kindref="member">validateReferenceForRename</ref>(fromTableReference,<sp/>toTableReference,<sp/>Content.Type.ICEBERG_TABLE);</highlight></codeline>
<codeline lineno="280"><highlight class="normal"></highlight></codeline>
<codeline lineno="281"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1TableIdentifier" kindref="compound">TableIdentifier</ref><sp/>fromIdentifier<sp/>=</highlight></codeline>
<codeline lineno="282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieUtil" kindref="compound">NessieUtil</ref>.removeCatalogName(</highlight></codeline>
<codeline lineno="283"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1aead3d76a5c368a40c385bf72e8cf28f0" kindref="member">identifierWithoutTableReference</ref>(from,<sp/>fromTableReference),<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a488890bc1208240512dad3c837d09c90" kindref="member">name</ref>());</highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1TableIdentifier" kindref="compound">TableIdentifier</ref><sp/>toIdentifier<sp/>=</highlight></codeline>
<codeline lineno="285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieUtil" kindref="compound">NessieUtil</ref>.removeCatalogName(<ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1aead3d76a5c368a40c385bf72e8cf28f0" kindref="member">identifierWithoutTableReference</ref>(to,<sp/>toTableReference),<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a488890bc1208240512dad3c837d09c90" kindref="member">name</ref>());</highlight></codeline>
<codeline lineno="286"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a4f697b5b226c61289ab7b300f5cd49c7" kindref="member">client</ref></highlight></codeline>
<codeline lineno="287"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.<ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieIcebergClient_1ae7e7bcbd310b0aedad1be3c067049e24" kindref="member">withReference</ref>(fromTableReference.getReference(),<sp/>fromTableReference.getHash())</highlight></codeline>
<codeline lineno="288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.<ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieIcebergClient_1a51b338b293adb718809a4ab6e0553e38" kindref="member">renameTable</ref>(fromIdentifier,<sp/>toIdentifier);</highlight></codeline>
<codeline lineno="289"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="290"><highlight class="normal"></highlight></codeline>
<codeline lineno="291"><highlight class="normal"><sp/><sp/>@Override</highlight></codeline>
<codeline lineno="292" refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1ab95d4472033e21582ad7d4d625a9df9c" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1ab95d4472033e21582ad7d4d625a9df9c" kindref="member">createNamespace</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1Namespace" kindref="compound">Namespace</ref><sp/></highlight><highlight class="keyword">namespace</highlight><highlight class="normal">,<sp/>Map&lt;String,<sp/>String&gt;<sp/>metadata)<sp/>{</highlight></codeline>
<codeline lineno="293"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a4f697b5b226c61289ab7b300f5cd49c7" kindref="member">client</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieIcebergClient_1aa59e86f82667477eb5fb5083e69b9ea7" kindref="member">createNamespace</ref>(</highlight><highlight class="keyword">namespace</highlight><highlight class="normal">,<sp/>metadata);</highlight></codeline>
<codeline lineno="294"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="295"><highlight class="normal"></highlight></codeline>
<codeline lineno="296"><highlight class="normal"><sp/><sp/>@Override</highlight></codeline>
<codeline lineno="297" refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1ac1a1734a20ecef5653f64dfa5b0949fb" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>List&lt;Namespace&gt;<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1ac1a1734a20ecef5653f64dfa5b0949fb" kindref="member">listNamespaces</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1Namespace" kindref="compound">Namespace</ref><sp/></highlight><highlight class="keyword">namespace</highlight><highlight class="normal">)<sp/></highlight><highlight class="keywordflow">throws</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1exceptions_1_1NoSuchNamespaceException" kindref="compound">NoSuchNamespaceException</ref><sp/>{</highlight></codeline>
<codeline lineno="298"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a4f697b5b226c61289ab7b300f5cd49c7" kindref="member">client</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieIcebergClient_1a1c538039fe3cc175f86402d1d2873ae5" kindref="member">listNamespaces</ref>(</highlight><highlight class="keyword">namespace</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="299"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="300"><highlight class="normal"></highlight></codeline>
<codeline lineno="308"><highlight class="normal"><sp/><sp/>@Override</highlight></codeline>
<codeline lineno="309" refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1ab54c83343c6383869f8f919928a13ec2" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>Map&lt;String,<sp/>String&gt;<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1ab54c83343c6383869f8f919928a13ec2" kindref="member">loadNamespaceMetadata</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1Namespace" kindref="compound">Namespace</ref><sp/></highlight><highlight class="keyword">namespace</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="310"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throws</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1exceptions_1_1NoSuchNamespaceException" kindref="compound">NoSuchNamespaceException</ref><sp/>{</highlight></codeline>
<codeline lineno="311"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a4f697b5b226c61289ab7b300f5cd49c7" kindref="member">client</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieIcebergClient_1a86b268a3c7eb122bacb4fd3a821f4c48" kindref="member">loadNamespaceMetadata</ref>(</highlight><highlight class="keyword">namespace</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="312"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="313"><highlight class="normal"></highlight></codeline>
<codeline lineno="314"><highlight class="normal"><sp/><sp/>@Override</highlight></codeline>
<codeline lineno="315" refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1ac46363d242f6d9b8082e78a9b12038f9" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">boolean</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1ac46363d242f6d9b8082e78a9b12038f9" kindref="member">dropNamespace</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1Namespace" kindref="compound">Namespace</ref><sp/></highlight><highlight class="keyword">namespace</highlight><highlight class="normal">)<sp/></highlight><highlight class="keywordflow">throws</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1exceptions_1_1NamespaceNotEmptyException" kindref="compound">NamespaceNotEmptyException</ref><sp/>{</highlight></codeline>
<codeline lineno="316"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a4f697b5b226c61289ab7b300f5cd49c7" kindref="member">client</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieIcebergClient_1a9e5a3e13e642e50d341d16b348d5623b" kindref="member">dropNamespace</ref>(</highlight><highlight class="keyword">namespace</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="317"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="318"><highlight class="normal"></highlight></codeline>
<codeline lineno="319"><highlight class="normal"><sp/><sp/>@Override</highlight></codeline>
<codeline lineno="320" refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1ab4e60ff7cb6ec4055b94cdc6f5bf50fc" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">boolean</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1ab4e60ff7cb6ec4055b94cdc6f5bf50fc" kindref="member">setProperties</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1Namespace" kindref="compound">Namespace</ref><sp/></highlight><highlight class="keyword">namespace</highlight><highlight class="normal">,<sp/>Map&lt;String,<sp/>String&gt;<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1ac78085c64847b04599870c6dbd3b2cd3" kindref="member">properties</ref>)<sp/>{</highlight></codeline>
<codeline lineno="321"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a4f697b5b226c61289ab7b300f5cd49c7" kindref="member">client</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieIcebergClient_1a7bee8c05d9831317cd7d1edaaf69ffa1" kindref="member">setProperties</ref>(</highlight><highlight class="keyword">namespace</highlight><highlight class="normal">,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1ac78085c64847b04599870c6dbd3b2cd3" kindref="member">properties</ref>);</highlight></codeline>
<codeline lineno="322"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="323"><highlight class="normal"></highlight></codeline>
<codeline lineno="324"><highlight class="normal"><sp/><sp/>@Override</highlight></codeline>
<codeline lineno="325" refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1af6e1c365bb5fe37690df7a37bf42c55e" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">boolean</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1af6e1c365bb5fe37690df7a37bf42c55e" kindref="member">removeProperties</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1Namespace" kindref="compound">Namespace</ref><sp/></highlight><highlight class="keyword">namespace</highlight><highlight class="normal">,<sp/>Set&lt;String&gt;<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1ac78085c64847b04599870c6dbd3b2cd3" kindref="member">properties</ref>)<sp/>{</highlight></codeline>
<codeline lineno="326"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a4f697b5b226c61289ab7b300f5cd49c7" kindref="member">client</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieIcebergClient_1a0cf3f678843fa311d64af26ba18e7f25" kindref="member">removeProperties</ref>(</highlight><highlight class="keyword">namespace</highlight><highlight class="normal">,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1ac78085c64847b04599870c6dbd3b2cd3" kindref="member">properties</ref>);</highlight></codeline>
<codeline lineno="327"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="328"><highlight class="normal"></highlight></codeline>
<codeline lineno="329"><highlight class="normal"><sp/><sp/>@Override</highlight></codeline>
<codeline lineno="330" refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1af6b4519c2ed5c257d3ac5a4554ab392b" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1af6b4519c2ed5c257d3ac5a4554ab392b" kindref="member">setConf</ref>(Object<sp/>conf)<sp/>{</highlight></codeline>
<codeline lineno="331"><highlight class="normal"><sp/><sp/><sp/><sp/>this.config<sp/>=<sp/>conf;</highlight></codeline>
<codeline lineno="332"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="333"><highlight class="normal"></highlight></codeline>
<codeline lineno="334"><highlight class="normal"><sp/><sp/>@VisibleForTesting</highlight></codeline>
<codeline lineno="335"><highlight class="normal"><sp/><sp/>String<sp/>currentHash()<sp/>{</highlight></codeline>
<codeline lineno="336"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a4f697b5b226c61289ab7b300f5cd49c7" kindref="member">client</ref>.getRef().getHash();</highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="338"><highlight class="normal"></highlight></codeline>
<codeline lineno="339"><highlight class="normal"><sp/><sp/>@VisibleForTesting</highlight></codeline>
<codeline lineno="340"><highlight class="normal"><sp/><sp/>String<sp/>currentRefName()<sp/>{</highlight></codeline>
<codeline lineno="341"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a4f697b5b226c61289ab7b300f5cd49c7" kindref="member">client</ref>.getRef().getName();</highlight></codeline>
<codeline lineno="342"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="343"><highlight class="normal"></highlight></codeline>
<codeline lineno="344"><highlight class="normal"><sp/><sp/>@VisibleForTesting</highlight></codeline>
<codeline lineno="345"><highlight class="normal"><sp/><sp/>FileIO<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1adf187bccb52b6225cf4d6099c7499b8d" kindref="member">fileIO</ref>()<sp/>{</highlight></codeline>
<codeline lineno="346"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1adf187bccb52b6225cf4d6099c7499b8d" kindref="member">fileIO</ref>;</highlight></codeline>
<codeline lineno="347"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="348"><highlight class="normal"></highlight></codeline>
<codeline lineno="349" refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a901566bbef7aaf7730c46ed279d758aa" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/>TableReference<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a901566bbef7aaf7730c46ed279d758aa" kindref="member">parseTableReference</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1TableIdentifier" kindref="compound">TableIdentifier</ref><sp/>tableIdentifier)<sp/>{</highlight></codeline>
<codeline lineno="350"><highlight class="normal"><sp/><sp/><sp/><sp/>TableReference<sp/>tr<sp/>=<sp/>TableReference.parse(tableIdentifier.<ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1TableIdentifier_1aeb31dbd38b5159d60e05b02d9b3f5b9e" kindref="member">name</ref>());</highlight></codeline>
<codeline lineno="351"><highlight class="normal"><sp/><sp/><sp/><sp/>Preconditions.checkArgument(</highlight></codeline>
<codeline lineno="352"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>!tr.hasTimestamp(),</highlight></codeline>
<codeline lineno="353"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Invalid<sp/>table<sp/>name:<sp/>#<sp/>is<sp/>only<sp/>allowed<sp/>for<sp/>hashes<sp/>(reference<sp/>by<sp/>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="354"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+<sp/></highlight><highlight class="stringliteral">&quot;timestamp<sp/>is<sp/>not<sp/>supported)&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="355"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>tr;</highlight></codeline>
<codeline lineno="356"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="357"><highlight class="normal"></highlight></codeline>
<codeline lineno="358" refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1aead3d76a5c368a40c385bf72e8cf28f0" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1TableIdentifier" kindref="compound">TableIdentifier</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1aead3d76a5c368a40c385bf72e8cf28f0" kindref="member">identifierWithoutTableReference</ref>(</highlight></codeline>
<codeline lineno="359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1TableIdentifier" kindref="compound">TableIdentifier</ref><sp/>identifier,<sp/>TableReference<sp/>tableReference)<sp/>{</highlight></codeline>
<codeline lineno="360"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(tableReference.hasReference())<sp/>{</highlight></codeline>
<codeline lineno="361"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1TableIdentifier" kindref="compound">TableIdentifier</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1TableIdentifier_1a76db86a1aa530669397f2c4de5e9497d" kindref="member">of</ref>(identifier.namespace(),<sp/>tableReference.getName());</highlight></codeline>
<codeline lineno="362"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="363"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>identifier;</highlight></codeline>
<codeline lineno="364"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="365"><highlight class="normal"></highlight></codeline>
<codeline lineno="366"><highlight class="normal"><sp/><sp/>@Override</highlight></codeline>
<codeline lineno="367" refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1ac78085c64847b04599870c6dbd3b2cd3" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">protected</highlight><highlight class="normal"><sp/>Map&lt;String,<sp/>String&gt;<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1ac78085c64847b04599870c6dbd3b2cd3" kindref="member">properties</ref>()<sp/>{</highlight></codeline>
<codeline lineno="368"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1ab7a8e2e6a51170cfccbae8e620f69b25" kindref="member">catalogOptions</ref>;</highlight></codeline>
<codeline lineno="369"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="370"><highlight class="normal"></highlight></codeline>
<codeline lineno="371"><highlight class="normal"><sp/><sp/>@Override</highlight></codeline>
<codeline lineno="372" refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a437c6cbbedd57c5b6816d53ce12d4131" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">protected</highlight><highlight class="normal"><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1view_1_1ViewOperations" kindref="compound">ViewOperations</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a437c6cbbedd57c5b6816d53ce12d4131" kindref="member">newViewOps</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1TableIdentifier" kindref="compound">TableIdentifier</ref><sp/>identifier)<sp/>{</highlight></codeline>
<codeline lineno="373"><highlight class="normal"><sp/><sp/><sp/><sp/>TableReference<sp/>tr<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a901566bbef7aaf7730c46ed279d758aa" kindref="member">parseTableReference</ref>(identifier);</highlight></codeline>
<codeline lineno="374"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieViewOperations" kindref="compound">NessieViewOperations</ref>(</highlight></codeline>
<codeline lineno="375"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ContentKey.of(</highlight></codeline>
<codeline lineno="376"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.projectnessie.model.Namespace.of(identifier.namespace().levels()),<sp/>tr.getName()),</highlight></codeline>
<codeline lineno="377"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a4f697b5b226c61289ab7b300f5cd49c7" kindref="member">client</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieIcebergClient_1ae7e7bcbd310b0aedad1be3c067049e24" kindref="member">withReference</ref>(tr.getReference(),<sp/>tr.getHash()),</highlight></codeline>
<codeline lineno="378"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1adf187bccb52b6225cf4d6099c7499b8d" kindref="member">fileIO</ref>);</highlight></codeline>
<codeline lineno="379"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="380"><highlight class="normal"></highlight></codeline>
<codeline lineno="381"><highlight class="normal"><sp/><sp/>@Override</highlight></codeline>
<codeline lineno="382" refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a4d1cbe89419548d41ebeefce59e00a29" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>List&lt;TableIdentifier&gt;<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a4d1cbe89419548d41ebeefce59e00a29" kindref="member">listViews</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1Namespace" kindref="compound">Namespace</ref><sp/></highlight><highlight class="keyword">namespace</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="383"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a4f697b5b226c61289ab7b300f5cd49c7" kindref="member">client</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieIcebergClient_1a7b506b78c3986c8f7f56df1d5f4bd679" kindref="member">listViews</ref>(</highlight><highlight class="keyword">namespace</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="384"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="385"><highlight class="normal"></highlight></codeline>
<codeline lineno="386"><highlight class="normal"><sp/><sp/>@Override</highlight></codeline>
<codeline lineno="387" refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a56effaaa317ff3fad08a28a53bd053bf" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">boolean</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a56effaaa317ff3fad08a28a53bd053bf" kindref="member">dropView</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1TableIdentifier" kindref="compound">TableIdentifier</ref><sp/>identifier)<sp/>{</highlight></codeline>
<codeline lineno="388"><highlight class="normal"><sp/><sp/><sp/><sp/>TableReference<sp/>tableReference<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a901566bbef7aaf7730c46ed279d758aa" kindref="member">parseTableReference</ref>(identifier);</highlight></codeline>
<codeline lineno="389"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a4f697b5b226c61289ab7b300f5cd49c7" kindref="member">client</ref></highlight></codeline>
<codeline lineno="390"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.<ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieIcebergClient_1ae7e7bcbd310b0aedad1be3c067049e24" kindref="member">withReference</ref>(tableReference.getReference(),<sp/>tableReference.getHash())</highlight></codeline>
<codeline lineno="391"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.<ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieIcebergClient_1aa78d0a2eeb620c1fa5a68da928353b7e" kindref="member">dropView</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1aead3d76a5c368a40c385bf72e8cf28f0" kindref="member">identifierWithoutTableReference</ref>(identifier,<sp/>tableReference),<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="392"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="393"><highlight class="normal"></highlight></codeline>
<codeline lineno="394"><highlight class="normal"><sp/><sp/>@Override</highlight></codeline>
<codeline lineno="395" refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1aad976138a07fea9f703f38d7c9199c18" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1aad976138a07fea9f703f38d7c9199c18" kindref="member">renameView</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1TableIdentifier" kindref="compound">TableIdentifier</ref><sp/>from,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1TableIdentifier" kindref="compound">TableIdentifier</ref><sp/>to)<sp/>{</highlight></codeline>
<codeline lineno="396"><highlight class="normal"><sp/><sp/><sp/><sp/>TableReference<sp/>fromTableReference<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a901566bbef7aaf7730c46ed279d758aa" kindref="member">parseTableReference</ref>(from);</highlight></codeline>
<codeline lineno="397"><highlight class="normal"><sp/><sp/><sp/><sp/>TableReference<sp/>toTableReference<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a901566bbef7aaf7730c46ed279d758aa" kindref="member">parseTableReference</ref>(to);</highlight></codeline>
<codeline lineno="398"><highlight class="normal"></highlight></codeline>
<codeline lineno="399"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a3b33e44e1a3654a4989f48aee17bfd47" kindref="member">validateReferenceForRename</ref>(fromTableReference,<sp/>toTableReference,<sp/>Content.Type.ICEBERG_VIEW);</highlight></codeline>
<codeline lineno="400"><highlight class="normal"></highlight></codeline>
<codeline lineno="401"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1TableIdentifier" kindref="compound">TableIdentifier</ref><sp/>fromIdentifier<sp/>=</highlight></codeline>
<codeline lineno="402"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieUtil" kindref="compound">NessieUtil</ref>.removeCatalogName(</highlight></codeline>
<codeline lineno="403"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1aead3d76a5c368a40c385bf72e8cf28f0" kindref="member">identifierWithoutTableReference</ref>(from,<sp/>fromTableReference),<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a488890bc1208240512dad3c837d09c90" kindref="member">name</ref>());</highlight></codeline>
<codeline lineno="404"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1TableIdentifier" kindref="compound">TableIdentifier</ref><sp/>toIdentifier<sp/>=</highlight></codeline>
<codeline lineno="405"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieUtil" kindref="compound">NessieUtil</ref>.removeCatalogName(<ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1aead3d76a5c368a40c385bf72e8cf28f0" kindref="member">identifierWithoutTableReference</ref>(to,<sp/>toTableReference),<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a488890bc1208240512dad3c837d09c90" kindref="member">name</ref>());</highlight></codeline>
<codeline lineno="406"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a4f697b5b226c61289ab7b300f5cd49c7" kindref="member">client</ref></highlight></codeline>
<codeline lineno="407"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.<ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieIcebergClient_1ae7e7bcbd310b0aedad1be3c067049e24" kindref="member">withReference</ref>(fromTableReference.getReference(),<sp/>fromTableReference.getHash())</highlight></codeline>
<codeline lineno="408"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.<ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieIcebergClient_1a31828c0c18ea3e98db035c1eb782f575" kindref="member">renameView</ref>(fromIdentifier,<sp/>toIdentifier);</highlight></codeline>
<codeline lineno="409"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="410"><highlight class="normal"></highlight></codeline>
<codeline lineno="411" refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a3b33e44e1a3654a4989f48aee17bfd47" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a3b33e44e1a3654a4989f48aee17bfd47" kindref="member">validateReferenceForRename</ref>(</highlight></codeline>
<codeline lineno="412"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>TableReference<sp/>fromTableReference,<sp/>TableReference<sp/>toTableReference,<sp/>Content.Type<sp/>type)<sp/>{</highlight></codeline>
<codeline lineno="413"><highlight class="normal"><sp/><sp/><sp/><sp/>String<sp/>fromReference<sp/>=</highlight></codeline>
<codeline lineno="414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fromTableReference.hasReference()</highlight></codeline>
<codeline lineno="415"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>?<sp/>fromTableReference.getReference()</highlight></codeline>
<codeline lineno="416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a4f697b5b226c61289ab7b300f5cd49c7" kindref="member">client</ref>.getRef().getName();</highlight></codeline>
<codeline lineno="417"><highlight class="normal"><sp/><sp/><sp/><sp/>String<sp/>toReference<sp/>=</highlight></codeline>
<codeline lineno="418"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>toTableReference.hasReference()</highlight></codeline>
<codeline lineno="419"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>?<sp/>toTableReference.getReference()</highlight></codeline>
<codeline lineno="420"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieCatalog_1a4f697b5b226c61289ab7b300f5cd49c7" kindref="member">client</ref>.getRef().getName();</highlight></codeline>
<codeline lineno="421"><highlight class="normal"><sp/><sp/><sp/><sp/>Preconditions.checkArgument(</highlight></codeline>
<codeline lineno="422"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fromReference.equalsIgnoreCase(toReference),</highlight></codeline>
<codeline lineno="423"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Cannot<sp/>rename<sp/>%s<sp/>&apos;%s&apos;<sp/>on<sp/>reference<sp/>&apos;%s&apos;<sp/>to<sp/>&apos;%s&apos;<sp/>on<sp/>reference<sp/>&apos;%s&apos;:&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="424"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+<sp/></highlight><highlight class="stringliteral">&quot;<sp/>source<sp/>and<sp/>target<sp/>references<sp/>must<sp/>be<sp/>the<sp/>same.&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1nessie_1_1NessieUtil" kindref="compound">NessieUtil</ref>.contentTypeString(type).toLowerCase(Locale.ENGLISH),</highlight></codeline>
<codeline lineno="426"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fromTableReference.getName(),</highlight></codeline>
<codeline lineno="427"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fromReference,</highlight></codeline>
<codeline lineno="428"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>toTableReference.getName(),</highlight></codeline>
<codeline lineno="429"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>toReference);</highlight></codeline>
<codeline lineno="430"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="431"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="nessie/src/main/java/org/apache/iceberg/nessie/NessieCatalog.java"/>
  </compounddef>
</doxygen>
