<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.17">
  <compounddef id="CatalogHandlers_8java" kind="file" language="Java">
    <compoundname>CatalogHandlers.java</compoundname>
    <innerclass refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers" prot="public">org::apache::iceberg::rest::CatalogHandlers</innerclass>
    <innerclass refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1_1ValidationFailureException" prot="private">org::apache::iceberg::rest::CatalogHandlers::ValidationFailureException</innerclass>
    <innernamespace refid="namespaceorg_1_1apache_1_1iceberg_1_1rest">org::apache::iceberg::rest</innernamespace>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">/*</highlight></codeline>
<codeline lineno="2"><highlight class="comment"><sp/>*<sp/>Licensed<sp/>to<sp/>the<sp/>Apache<sp/>Software<sp/>Foundation<sp/>(ASF)<sp/>under<sp/>one</highlight></codeline>
<codeline lineno="3"><highlight class="comment"><sp/>*<sp/>or<sp/>more<sp/>contributor<sp/>license<sp/>agreements.<sp/><sp/>See<sp/>the<sp/>NOTICE<sp/>file</highlight></codeline>
<codeline lineno="4"><highlight class="comment"><sp/>*<sp/>distributed<sp/>with<sp/>this<sp/>work<sp/>for<sp/>additional<sp/>information</highlight></codeline>
<codeline lineno="5"><highlight class="comment"><sp/>*<sp/>regarding<sp/>copyright<sp/>ownership.<sp/><sp/>The<sp/>ASF<sp/>licenses<sp/>this<sp/>file</highlight></codeline>
<codeline lineno="6"><highlight class="comment"><sp/>*<sp/>to<sp/>you<sp/>under<sp/>the<sp/>Apache<sp/>License,<sp/>Version<sp/>2.0<sp/>(the</highlight></codeline>
<codeline lineno="7"><highlight class="comment"><sp/>*<sp/>&quot;License&quot;);<sp/>you<sp/>may<sp/>not<sp/>use<sp/>this<sp/>file<sp/>except<sp/>in<sp/>compliance</highlight></codeline>
<codeline lineno="8"><highlight class="comment"><sp/>*<sp/>with<sp/>the<sp/>License.<sp/><sp/>You<sp/>may<sp/>obtain<sp/>a<sp/>copy<sp/>of<sp/>the<sp/>License<sp/>at</highlight></codeline>
<codeline lineno="9"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="10"><highlight class="comment"><sp/>*<sp/><sp/><sp/>http://www.apache.org/licenses/LICENSE-2.0</highlight></codeline>
<codeline lineno="11"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="12"><highlight class="comment"><sp/>*<sp/>Unless<sp/>required<sp/>by<sp/>applicable<sp/>law<sp/>or<sp/>agreed<sp/>to<sp/>in<sp/>writing,</highlight></codeline>
<codeline lineno="13"><highlight class="comment"><sp/>*<sp/>software<sp/>distributed<sp/>under<sp/>the<sp/>License<sp/>is<sp/>distributed<sp/>on<sp/>an</highlight></codeline>
<codeline lineno="14"><highlight class="comment"><sp/>*<sp/>&quot;AS<sp/>IS&quot;<sp/>BASIS,<sp/>WITHOUT<sp/>WARRANTIES<sp/>OR<sp/>CONDITIONS<sp/>OF<sp/>ANY</highlight></codeline>
<codeline lineno="15"><highlight class="comment"><sp/>*<sp/>KIND,<sp/>either<sp/>express<sp/>or<sp/>implied.<sp/><sp/>See<sp/>the<sp/>License<sp/>for<sp/>the</highlight></codeline>
<codeline lineno="16"><highlight class="comment"><sp/>*<sp/>specific<sp/>language<sp/>governing<sp/>permissions<sp/>and<sp/>limitations</highlight></codeline>
<codeline lineno="17"><highlight class="comment"><sp/>*<sp/>under<sp/>the<sp/>License.</highlight></codeline>
<codeline lineno="18"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="19"><highlight class="normal"></highlight><highlight class="keyword">package<sp/></highlight><highlight class="normal">org.apache.iceberg.rest;</highlight></codeline>
<codeline lineno="20"><highlight class="normal"></highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1TableProperties" kindref="compound">TableProperties</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1TableProperties_1ac45e17cf44ad36e4868e0baa2572b255" kindref="member">COMMIT_MAX_RETRY_WAIT_MS_DEFAULT</ref>;</highlight></codeline>
<codeline lineno="22"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1TableProperties" kindref="compound">TableProperties</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1TableProperties_1a39c3419cd4dc1557fed230ffba3670a3" kindref="member">COMMIT_MIN_RETRY_WAIT_MS_DEFAULT</ref>;</highlight></codeline>
<codeline lineno="23"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1TableProperties" kindref="compound">TableProperties</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1TableProperties_1a3a5472d1c63b84db40ddc56574be5f43" kindref="member">COMMIT_NUM_RETRIES_DEFAULT</ref>;</highlight></codeline>
<codeline lineno="24"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1TableProperties" kindref="compound">TableProperties</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1TableProperties_1ad9cf752dce2ad464d55bd322c3774d05" kindref="member">COMMIT_TOTAL_RETRY_TIME_MS_DEFAULT</ref>;</highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight></codeline>
<codeline lineno="26"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>java.time.OffsetDateTime;</highlight></codeline>
<codeline lineno="27"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>java.time.ZoneOffset;</highlight></codeline>
<codeline lineno="28"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>java.util.List;</highlight></codeline>
<codeline lineno="29"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>java.util.Map;</highlight></codeline>
<codeline lineno="30"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>java.util.Set;</highlight></codeline>
<codeline lineno="31"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>java.util.concurrent.atomic.AtomicBoolean;</highlight></codeline>
<codeline lineno="32"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>java.util.stream.Collectors;</highlight></codeline>
<codeline lineno="33"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1BaseMetadataTable" kindref="compound">BaseMetadataTable</ref>;</highlight></codeline>
<codeline lineno="34"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1BaseTable" kindref="compound">BaseTable</ref>;</highlight></codeline>
<codeline lineno="35"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1BaseTransaction" kindref="compound">BaseTransaction</ref>;</highlight></codeline>
<codeline lineno="36"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1PartitionSpec" kindref="compound">PartitionSpec</ref>;</highlight></codeline>
<codeline lineno="37"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1Schema" kindref="compound">Schema</ref>;</highlight></codeline>
<codeline lineno="38"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1SortOrder" kindref="compound">SortOrder</ref>;</highlight></codeline>
<codeline lineno="39"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Table" kindref="compound">Table</ref>;</highlight></codeline>
<codeline lineno="40"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1TableMetadata" kindref="compound">TableMetadata</ref>;</highlight></codeline>
<codeline lineno="41"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1TableOperations" kindref="compound">TableOperations</ref>;</highlight></codeline>
<codeline lineno="42"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Transaction" kindref="compound">Transaction</ref>;</highlight></codeline>
<codeline lineno="43"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1UpdateRequirement" kindref="compound">UpdateRequirement</ref>;</highlight></codeline>
<codeline lineno="44"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1catalog" kindref="compound">catalog</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1Catalog" kindref="compound">Catalog</ref>;</highlight></codeline>
<codeline lineno="45"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1catalog" kindref="compound">catalog</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1Namespace" kindref="compound">Namespace</ref>;</highlight></codeline>
<codeline lineno="46"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1catalog" kindref="compound">catalog</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1SupportsNamespaces" kindref="compound">SupportsNamespaces</ref>;</highlight></codeline>
<codeline lineno="47"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1catalog" kindref="compound">catalog</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1TableIdentifier" kindref="compound">TableIdentifier</ref>;</highlight></codeline>
<codeline lineno="48"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1catalog" kindref="compound">catalog</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1ViewCatalog" kindref="compound">ViewCatalog</ref>;</highlight></codeline>
<codeline lineno="49"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1exceptions" kindref="compound">exceptions</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1exceptions_1_1AlreadyExistsException" kindref="compound">AlreadyExistsException</ref>;</highlight></codeline>
<codeline lineno="50"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1exceptions" kindref="compound">exceptions</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1exceptions_1_1CommitFailedException" kindref="compound">CommitFailedException</ref>;</highlight></codeline>
<codeline lineno="51"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1exceptions" kindref="compound">exceptions</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1exceptions_1_1NoSuchNamespaceException" kindref="compound">NoSuchNamespaceException</ref>;</highlight></codeline>
<codeline lineno="52"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1exceptions" kindref="compound">exceptions</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1exceptions_1_1NoSuchTableException" kindref="compound">NoSuchTableException</ref>;</highlight></codeline>
<codeline lineno="53"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1exceptions" kindref="compound">exceptions</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1exceptions_1_1NoSuchViewException" kindref="compound">NoSuchViewException</ref>;</highlight></codeline>
<codeline lineno="54"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.relocated.com.google.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1common" kindref="compound">common</ref>.base.<ref refid="classorg_1_1apache_1_1iceberg_1_1relocated_1_1com_1_1google_1_1common_1_1base_1_1Preconditions" kindref="compound">Preconditions</ref>;</highlight></codeline>
<codeline lineno="55"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.relocated.com.google.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1common" kindref="compound">common</ref>.collect.<ref refid="classorg_1_1apache_1_1iceberg_1_1relocated_1_1com_1_1google_1_1common_1_1collect_1_1Maps" kindref="compound">Maps</ref>;</highlight></codeline>
<codeline lineno="56"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.relocated.com.google.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1common" kindref="compound">common</ref>.collect.<ref refid="classorg_1_1apache_1_1iceberg_1_1relocated_1_1com_1_1google_1_1common_1_1collect_1_1Sets" kindref="compound">Sets</ref>;</highlight></codeline>
<codeline lineno="57"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1rest" kindref="compound">rest</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1rest_1_1requests" kindref="compound">requests</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1CreateNamespaceRequest" kindref="compound">CreateNamespaceRequest</ref>;</highlight></codeline>
<codeline lineno="58"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1rest" kindref="compound">rest</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1rest_1_1requests" kindref="compound">requests</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1CreateTableRequest" kindref="compound">CreateTableRequest</ref>;</highlight></codeline>
<codeline lineno="59"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1rest" kindref="compound">rest</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1rest_1_1requests" kindref="compound">requests</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1CreateViewRequest" kindref="compound">CreateViewRequest</ref>;</highlight></codeline>
<codeline lineno="60"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1rest" kindref="compound">rest</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1rest_1_1requests" kindref="compound">requests</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1RegisterTableRequest" kindref="compound">RegisterTableRequest</ref>;</highlight></codeline>
<codeline lineno="61"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1rest" kindref="compound">rest</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1rest_1_1requests" kindref="compound">requests</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1RenameTableRequest" kindref="compound">RenameTableRequest</ref>;</highlight></codeline>
<codeline lineno="62"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1rest" kindref="compound">rest</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1rest_1_1requests" kindref="compound">requests</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1UpdateNamespacePropertiesRequest" kindref="compound">UpdateNamespacePropertiesRequest</ref>;</highlight></codeline>
<codeline lineno="63"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1rest" kindref="compound">rest</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1rest_1_1requests" kindref="compound">requests</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1UpdateTableRequest" kindref="compound">UpdateTableRequest</ref>;</highlight></codeline>
<codeline lineno="64"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1rest" kindref="compound">rest</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1rest_1_1responses" kindref="compound">responses</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1CreateNamespaceResponse" kindref="compound">CreateNamespaceResponse</ref>;</highlight></codeline>
<codeline lineno="65"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1rest" kindref="compound">rest</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1rest_1_1responses" kindref="compound">responses</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1GetNamespaceResponse" kindref="compound">GetNamespaceResponse</ref>;</highlight></codeline>
<codeline lineno="66"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1rest" kindref="compound">rest</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1rest_1_1responses" kindref="compound">responses</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1ImmutableLoadViewResponse" kindref="compound">ImmutableLoadViewResponse</ref>;</highlight></codeline>
<codeline lineno="67"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1rest" kindref="compound">rest</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1rest_1_1responses" kindref="compound">responses</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1ListNamespacesResponse" kindref="compound">ListNamespacesResponse</ref>;</highlight></codeline>
<codeline lineno="68"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1rest" kindref="compound">rest</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1rest_1_1responses" kindref="compound">responses</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1ListTablesResponse" kindref="compound">ListTablesResponse</ref>;</highlight></codeline>
<codeline lineno="69"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1rest" kindref="compound">rest</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1rest_1_1responses" kindref="compound">responses</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1LoadTableResponse" kindref="compound">LoadTableResponse</ref>;</highlight></codeline>
<codeline lineno="70"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1rest" kindref="compound">rest</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1rest_1_1responses" kindref="compound">responses</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1LoadViewResponse" kindref="compound">LoadViewResponse</ref>;</highlight></codeline>
<codeline lineno="71"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1rest" kindref="compound">rest</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1rest_1_1responses" kindref="compound">responses</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1UpdateNamespacePropertiesResponse" kindref="compound">UpdateNamespacePropertiesResponse</ref>;</highlight></codeline>
<codeline lineno="72"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1util" kindref="compound">util</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1util_1_1Tasks" kindref="compound">Tasks</ref>;</highlight></codeline>
<codeline lineno="73"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1view" kindref="compound">view</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1view_1_1BaseView" kindref="compound">BaseView</ref>;</highlight></codeline>
<codeline lineno="74"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1view" kindref="compound">view</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1view_1_1SQLViewRepresentation" kindref="compound">SQLViewRepresentation</ref>;</highlight></codeline>
<codeline lineno="75"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1view" kindref="compound">view</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1view_1_1View" kindref="compound">View</ref>;</highlight></codeline>
<codeline lineno="76"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1view" kindref="compound">view</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1view_1_1ViewBuilder" kindref="compound">ViewBuilder</ref>;</highlight></codeline>
<codeline lineno="77"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1view" kindref="compound">view</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1view_1_1ViewMetadata" kindref="compound">ViewMetadata</ref>;</highlight></codeline>
<codeline lineno="78"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1view" kindref="compound">view</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1view_1_1ViewOperations" kindref="compound">ViewOperations</ref>;</highlight></codeline>
<codeline lineno="79"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1view" kindref="compound">view</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1view_1_1ViewRepresentation" kindref="compound">ViewRepresentation</ref>;</highlight></codeline>
<codeline lineno="80"><highlight class="normal"></highlight></codeline>
<codeline lineno="81" refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers" kindref="compound">CatalogHandlers</ref><sp/>{</highlight></codeline>
<codeline lineno="82" refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1a298bace6272177bfabac7e70a3237e05" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1Schema" kindref="compound">Schema</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1a298bace6272177bfabac7e70a3237e05" kindref="member">EMPTY_SCHEMA</ref><sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1Schema" kindref="compound">Schema</ref>();</highlight></codeline>
<codeline lineno="83" refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1afba67d355137060445ce581b1867e37c" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/>String<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1afba67d355137060445ce581b1867e37c" kindref="member">INTIAL_PAGE_TOKEN</ref><sp/>=<sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="84"><highlight class="normal"></highlight></codeline>
<codeline lineno="85" refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1af21c1701181e76379dca3777021b1960" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1af21c1701181e76379dca3777021b1960" kindref="member">CatalogHandlers</ref>()<sp/>{}</highlight></codeline>
<codeline lineno="86"><highlight class="normal"></highlight></codeline>
<codeline lineno="96" refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1_1ValidationFailureException" refkind="compound"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1_1ValidationFailureException" kindref="compound">ValidationFailureException</ref><sp/></highlight><highlight class="keyword">extends</highlight><highlight class="normal"><sp/>RuntimeException<sp/>{</highlight></codeline>
<codeline lineno="97" refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1_1ValidationFailureException_1a8721eb35b0a1217e8b6907e3a2894eff" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1exceptions_1_1CommitFailedException" kindref="compound">CommitFailedException</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1_1ValidationFailureException_1a8721eb35b0a1217e8b6907e3a2894eff" kindref="member">wrapped</ref>;</highlight></codeline>
<codeline lineno="98"><highlight class="normal"></highlight></codeline>
<codeline lineno="99" refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1_1ValidationFailureException_1a895150d2ee08ce9b7d5245c71e25d825" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1_1ValidationFailureException_1a895150d2ee08ce9b7d5245c71e25d825" kindref="member">ValidationFailureException</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1exceptions_1_1CommitFailedException" kindref="compound">CommitFailedException</ref><sp/>cause)<sp/>{</highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>super(cause);</highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this.wrapped<sp/>=<sp/>cause;</highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="103"><highlight class="normal"></highlight></codeline>
<codeline lineno="104" refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1_1ValidationFailureException_1a9a08babb32d760552ae61042c1661e88" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1exceptions_1_1CommitFailedException" kindref="compound">CommitFailedException</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1_1ValidationFailureException_1a9a08babb32d760552ae61042c1661e88" kindref="member">wrapped</ref>()<sp/>{</highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1_1ValidationFailureException_1a8721eb35b0a1217e8b6907e3a2894eff" kindref="member">wrapped</ref>;</highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="108"><highlight class="normal"></highlight></codeline>
<codeline lineno="109" refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1ab35e462b20b7648a7ac4dde31f47b7fa" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1ListNamespacesResponse" kindref="compound">ListNamespacesResponse</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1ab35e462b20b7648a7ac4dde31f47b7fa" kindref="member">listNamespaces</ref>(</highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1SupportsNamespaces" kindref="compound">SupportsNamespaces</ref><sp/>catalog,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1Namespace" kindref="compound">Namespace</ref><sp/>parent)<sp/>{</highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><sp/><sp/>List&lt;Namespace&gt;<sp/>results;</highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(parent.<ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1Namespace_1a69557ac80eefb8f7856ec445114e5ccf" kindref="member">isEmpty</ref>())<sp/>{</highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>results<sp/>=<sp/>catalog.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1SupportsNamespaces_1afeb1dc59ff0b25cfde224eda3f3f9906" kindref="member">listNamespaces</ref>();</highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>results<sp/>=<sp/>catalog.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1SupportsNamespaces_1afeb1dc59ff0b25cfde224eda3f3f9906" kindref="member">listNamespaces</ref>(parent);</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="117"><highlight class="normal"></highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1ListNamespacesResponse" kindref="compound">ListNamespacesResponse</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1ListNamespacesResponse_1a091da31d7db61863a507120ecb8cc417" kindref="member">builder</ref>().<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1ListNamespacesResponse_1_1Builder_1a1afec5ed35d9f26078b4578d61447cef" kindref="member">addAll</ref>(results).<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1ListNamespacesResponse_1_1Builder_1af0534bd503b1730f33a5509e31bf31f7" kindref="member">build</ref>();</highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="120"><highlight class="normal"></highlight></codeline>
<codeline lineno="121" refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1a16149e32cc3216ed9633b5e2458c2700" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1ListNamespacesResponse" kindref="compound">ListNamespacesResponse</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1a16149e32cc3216ed9633b5e2458c2700" kindref="member">listNamespaces</ref>(</highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1SupportsNamespaces" kindref="compound">SupportsNamespaces</ref><sp/>catalog,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1Namespace" kindref="compound">Namespace</ref><sp/>parent,<sp/>String<sp/>pageToken,<sp/>String<sp/>pageSize)<sp/>{</highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><sp/><sp/>List&lt;Namespace&gt;<sp/>results;</highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/><sp/><sp/>List&lt;Namespace&gt;<sp/>subResults;</highlight></codeline>
<codeline lineno="125"><highlight class="normal"></highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(parent.<ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1Namespace_1a69557ac80eefb8f7856ec445114e5ccf" kindref="member">isEmpty</ref>())<sp/>{</highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>results<sp/>=<sp/>catalog.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1SupportsNamespaces_1afeb1dc59ff0b25cfde224eda3f3f9906" kindref="member">listNamespaces</ref>();</highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>results<sp/>=<sp/>catalog.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1SupportsNamespaces_1afeb1dc59ff0b25cfde224eda3f3f9906" kindref="member">listNamespaces</ref>(parent);</highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="131"><highlight class="normal"></highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>start<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1afba67d355137060445ce581b1867e37c" kindref="member">INTIAL_PAGE_TOKEN</ref>.equals(pageToken)<sp/>?<sp/>0<sp/>:<sp/>Integer.parseInt(pageToken);</highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>end<sp/>=<sp/>start<sp/>+<sp/>Integer.parseInt(pageSize);</highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/><sp/><sp/>subResults<sp/>=<sp/>results.subList(start,<sp/>end);</highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/><sp/><sp/>String<sp/>nextToken<sp/>=<sp/>String.valueOf(end);</highlight></codeline>
<codeline lineno="136"><highlight class="normal"></highlight></codeline>
<codeline lineno="137"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(end<sp/>&gt;=<sp/>results.size())<sp/>{</highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>nextToken<sp/>=<sp/></highlight><highlight class="keyword">null</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="140"><highlight class="normal"></highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1ListNamespacesResponse" kindref="compound">ListNamespacesResponse</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1ListNamespacesResponse_1a091da31d7db61863a507120ecb8cc417" kindref="member">builder</ref>().<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1ListNamespacesResponse_1_1Builder_1a1afec5ed35d9f26078b4578d61447cef" kindref="member">addAll</ref>(subResults).<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1ListNamespacesResponse_1_1Builder_1aaba2cf23bbdea304353913ba2f3b8d27" kindref="member">nextPageToken</ref>(nextToken).build();</highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="143"><highlight class="normal"></highlight></codeline>
<codeline lineno="144" refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1af385a5f04661c873bb7c5bb1ad075599" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1CreateNamespaceResponse" kindref="compound">CreateNamespaceResponse</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1af385a5f04661c873bb7c5bb1ad075599" kindref="member">createNamespace</ref>(</highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1SupportsNamespaces" kindref="compound">SupportsNamespaces</ref><sp/>catalog,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1CreateNamespaceRequest" kindref="compound">CreateNamespaceRequest</ref><sp/>request)<sp/>{</highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1Namespace" kindref="compound">Namespace</ref><sp/></highlight><highlight class="keyword">namespace<sp/></highlight><highlight class="normal">=<sp/>request.namespace();</highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/>catalog.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1SupportsNamespaces_1acc80b7da14b90a65d39e97e05479ea33" kindref="member">createNamespace</ref>(</highlight><highlight class="keyword">namespace</highlight><highlight class="normal">,<sp/>request.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1CreateNamespaceRequest_1aa832313ba0b92844e76537c3c1da158d" kindref="member">properties</ref>());</highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1CreateNamespaceResponse" kindref="compound">CreateNamespaceResponse</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1CreateNamespaceResponse_1aa0a6c5afb5da1210ca02760adff70779" kindref="member">builder</ref>()</highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1CreateNamespaceResponse_1_1Builder_1a8de47f78fb7ba22a0052ad5a808f3fd6" kindref="member">withNamespace</ref>(</highlight><highlight class="keyword">namespace</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1CreateNamespaceResponse_1_1Builder_1a6fcee01a909cdaddc6ad435d6ccf25de" kindref="member">setProperties</ref>(catalog.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1SupportsNamespaces_1a68f05b7949ffed7561de0b847530088a" kindref="member">loadNamespaceMetadata</ref>(</highlight><highlight class="keyword">namespace</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1CreateNamespaceResponse_1_1Builder_1a1358e4a51499637e5653c79585e1d7b3" kindref="member">build</ref>();</highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="153"><highlight class="normal"></highlight></codeline>
<codeline lineno="154" refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1a7e0e02e8afbbca02e6a206211bbfe009" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1GetNamespaceResponse" kindref="compound">GetNamespaceResponse</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1a7e0e02e8afbbca02e6a206211bbfe009" kindref="member">loadNamespace</ref>(</highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1SupportsNamespaces" kindref="compound">SupportsNamespaces</ref><sp/>catalog,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1Namespace" kindref="compound">Namespace</ref><sp/></highlight><highlight class="keyword">namespace</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/>Map&lt;String,<sp/>String&gt;<sp/>properties<sp/>=<sp/>catalog.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1SupportsNamespaces_1a68f05b7949ffed7561de0b847530088a" kindref="member">loadNamespaceMetadata</ref>(</highlight><highlight class="keyword">namespace</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1GetNamespaceResponse" kindref="compound">GetNamespaceResponse</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1GetNamespaceResponse_1a04571d97d24b11aaf4f6a32c36e799b5" kindref="member">builder</ref>()</highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1GetNamespaceResponse_1_1Builder_1af8094b1a5b0ef9ff416108652d2bf231" kindref="member">withNamespace</ref>(</highlight><highlight class="keyword">namespace</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1GetNamespaceResponse_1_1Builder_1aa18996bade48b059b5bac009a3e8b478" kindref="member">setProperties</ref>(properties)</highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1GetNamespaceResponse_1_1Builder_1ae7c8c2feaeeacda3429f16948df78762" kindref="member">build</ref>();</highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="162"><highlight class="normal"></highlight></codeline>
<codeline lineno="163" refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1a48314398f28017ffad3fc3b09755a3fd" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1a48314398f28017ffad3fc3b09755a3fd" kindref="member">dropNamespace</ref>(<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1SupportsNamespaces" kindref="compound">SupportsNamespaces</ref><sp/>catalog,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1Namespace" kindref="compound">Namespace</ref><sp/></highlight><highlight class="keyword">namespace</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">boolean</highlight><highlight class="normal"><sp/>dropped<sp/>=<sp/>catalog.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1SupportsNamespaces_1acf63db9574b2e049feb8b3f336199580" kindref="member">dropNamespace</ref>(</highlight><highlight class="keyword">namespace</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!dropped)<sp/>{</highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1exceptions_1_1NoSuchNamespaceException" kindref="compound">NoSuchNamespaceException</ref>(</highlight><highlight class="stringliteral">&quot;Namespace<sp/>does<sp/>not<sp/>exist:<sp/>%s&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="keyword">namespace</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="169"><highlight class="normal"></highlight></codeline>
<codeline lineno="170" refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1a8ee05cf2ff0c6f3fc5699c8c3ff7a3b3" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1UpdateNamespacePropertiesResponse" kindref="compound">UpdateNamespacePropertiesResponse</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1a8ee05cf2ff0c6f3fc5699c8c3ff7a3b3" kindref="member">updateNamespaceProperties</ref>(</highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1SupportsNamespaces" kindref="compound">SupportsNamespaces</ref><sp/>catalog,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1Namespace" kindref="compound">Namespace</ref><sp/></highlight><highlight class="keyword">namespace</highlight><highlight class="normal">,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1UpdateNamespacePropertiesRequest" kindref="compound">UpdateNamespacePropertiesRequest</ref><sp/>request)<sp/>{</highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/>request.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1UpdateNamespacePropertiesRequest_1a452bf2aabd52c179c57914f225b3a994" kindref="member">validate</ref>();</highlight></codeline>
<codeline lineno="173"><highlight class="normal"></highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/>Set&lt;String&gt;<sp/>removals<sp/>=<sp/>Sets.newHashSet(request.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1UpdateNamespacePropertiesRequest_1a40e17dfba74c2f73f7fdf5ab920649c2" kindref="member">removals</ref>());</highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/>Map&lt;String,<sp/>String&gt;<sp/>updates<sp/>=<sp/>request.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1UpdateNamespacePropertiesRequest_1aee12b805b6bb21f04e1d28120ea09263" kindref="member">updates</ref>();</highlight></codeline>
<codeline lineno="176"><highlight class="normal"></highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/>Map&lt;String,<sp/>String&gt;<sp/>startProperties<sp/>=<sp/>catalog.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1SupportsNamespaces_1a68f05b7949ffed7561de0b847530088a" kindref="member">loadNamespaceMetadata</ref>(</highlight><highlight class="keyword">namespace</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/>Set&lt;String&gt;<sp/>missing<sp/>=<sp/>Sets.difference(removals,<sp/>startProperties.keySet());</highlight></codeline>
<codeline lineno="179"><highlight class="normal"></highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!updates.isEmpty())<sp/>{</highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>catalog.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1SupportsNamespaces_1a8869570cea0555c5f8d125ebafb11865" kindref="member">setProperties</ref>(</highlight><highlight class="keyword">namespace</highlight><highlight class="normal">,<sp/>updates);</highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="183"><highlight class="normal"></highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!removals.isEmpty())<sp/>{</highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>remove<sp/>the<sp/>original<sp/>set<sp/>just<sp/>in<sp/>case<sp/>there<sp/>was<sp/>an<sp/>update<sp/>just<sp/>after<sp/>loading<sp/>properties</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>catalog.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1SupportsNamespaces_1a0cde285e5da773dd910fbe08d36c3d80" kindref="member">removeProperties</ref>(</highlight><highlight class="keyword">namespace</highlight><highlight class="normal">,<sp/>removals);</highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="188"><highlight class="normal"></highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1UpdateNamespacePropertiesResponse" kindref="compound">UpdateNamespacePropertiesResponse</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1UpdateNamespacePropertiesResponse_1a3757548a1c0c651fb351319e29351f27" kindref="member">builder</ref>()</highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1UpdateNamespacePropertiesResponse_1_1Builder_1a59556779ebc909b1954e7a6137f746c7" kindref="member">addMissing</ref>(missing)</highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1UpdateNamespacePropertiesResponse_1_1Builder_1a9b9d81ddadbe4e6fd1bc5962a9253c44" kindref="member">addUpdated</ref>(updates.keySet())</highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1UpdateNamespacePropertiesResponse_1_1Builder_1a0a3fc311d55ace48ac981d9ebdf60051" kindref="member">addRemoved</ref>(Sets.difference(removals,<sp/>missing))</highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1UpdateNamespacePropertiesResponse_1_1Builder_1af584016c150d2296872401f442fe3707" kindref="member">build</ref>();</highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="195"><highlight class="normal"></highlight></codeline>
<codeline lineno="196" refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1a5cd6efa75274ff7db9b65fe77fa38551" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1ListTablesResponse" kindref="compound">ListTablesResponse</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1a5cd6efa75274ff7db9b65fe77fa38551" kindref="member">listTables</ref>(<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1Catalog" kindref="compound">Catalog</ref><sp/>catalog,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1Namespace" kindref="compound">Namespace</ref><sp/></highlight><highlight class="keyword">namespace</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/>List&lt;TableIdentifier&gt;<sp/>idents<sp/>=<sp/>catalog.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1Catalog_1a7789d56c7b96208d4d3e064979862a19" kindref="member">listTables</ref>(</highlight><highlight class="keyword">namespace</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1ListTablesResponse" kindref="compound">ListTablesResponse</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1ListTablesResponse_1af28680b6b78152b1b5893b73b2718d91" kindref="member">builder</ref>().<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1ListTablesResponse_1_1Builder_1ab1dfa56e4df3f0390ec2a8db38395795" kindref="member">addAll</ref>(idents).<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1ListTablesResponse_1_1Builder_1a003854e7074d6320a624fba112e65465" kindref="member">build</ref>();</highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="200"><highlight class="normal"></highlight></codeline>
<codeline lineno="201" refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1ae8d55529df1fb615f4a12b865fff4e58" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1ListTablesResponse" kindref="compound">ListTablesResponse</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1ae8d55529df1fb615f4a12b865fff4e58" kindref="member">listTables</ref>(</highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1Catalog" kindref="compound">Catalog</ref><sp/>catalog,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1Namespace" kindref="compound">Namespace</ref><sp/></highlight><highlight class="keyword">namespace</highlight><highlight class="normal">,<sp/>String<sp/>pageToken,<sp/>String<sp/>pageSize)<sp/>{</highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><sp/><sp/>List&lt;TableIdentifier&gt;<sp/>results<sp/>=<sp/>catalog.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1Catalog_1a7789d56c7b96208d4d3e064979862a19" kindref="member">listTables</ref>(</highlight><highlight class="keyword">namespace</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><sp/><sp/>List&lt;TableIdentifier&gt;<sp/>subResults;</highlight></codeline>
<codeline lineno="205"><highlight class="normal"></highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>start<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1afba67d355137060445ce581b1867e37c" kindref="member">INTIAL_PAGE_TOKEN</ref>.equals(pageToken)<sp/>?<sp/>0<sp/>:<sp/>Integer.parseInt(pageToken);</highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>end<sp/>=<sp/>start<sp/>+<sp/>Integer.parseInt(pageSize);</highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/><sp/><sp/>subResults<sp/>=<sp/>results.subList(start,<sp/>end);</highlight></codeline>
<codeline lineno="209"><highlight class="normal"><sp/><sp/><sp/><sp/>String<sp/>nextToken<sp/>=<sp/>String.valueOf(end);</highlight></codeline>
<codeline lineno="210"><highlight class="normal"></highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(end<sp/>&gt;=<sp/>results.size())<sp/>{</highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>nextToken<sp/>=<sp/></highlight><highlight class="keyword">null</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="214"><highlight class="normal"></highlight></codeline>
<codeline lineno="215"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1ListTablesResponse" kindref="compound">ListTablesResponse</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1ListTablesResponse_1af28680b6b78152b1b5893b73b2718d91" kindref="member">builder</ref>().<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1ListTablesResponse_1_1Builder_1ab1dfa56e4df3f0390ec2a8db38395795" kindref="member">addAll</ref>(subResults).<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1ListTablesResponse_1_1Builder_1a97eaef1213eb3877e5f1d78f002b166d" kindref="member">nextPageToken</ref>(nextToken).build();</highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="217"><highlight class="normal"></highlight></codeline>
<codeline lineno="218" refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1af653f19f7aeda499a7590d57838ff8c3" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1LoadTableResponse" kindref="compound">LoadTableResponse</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1af653f19f7aeda499a7590d57838ff8c3" kindref="member">stageTableCreate</ref>(</highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1Catalog" kindref="compound">Catalog</ref><sp/>catalog,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1Namespace" kindref="compound">Namespace</ref><sp/></highlight><highlight class="keyword">namespace</highlight><highlight class="normal">,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1CreateTableRequest" kindref="compound">CreateTableRequest</ref><sp/>request)<sp/>{</highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/><sp/>request.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1CreateTableRequest_1a4a2d8be0a00cd58c4b5903dbde0bab33" kindref="member">validate</ref>();</highlight></codeline>
<codeline lineno="221"><highlight class="normal"></highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1TableIdentifier" kindref="compound">TableIdentifier</ref><sp/>ident<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1TableIdentifier" kindref="compound">TableIdentifier</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1TableIdentifier_1a76db86a1aa530669397f2c4de5e9497d" kindref="member">of</ref>(</highlight><highlight class="keyword">namespace</highlight><highlight class="normal">,<sp/>request.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1CreateTableRequest_1a4d63266c4966439f85ea45d812788a08" kindref="member">name</ref>());</highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(catalog.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1Catalog_1a8b4b9fdc68d8862f4fdc349bd7383a40" kindref="member">tableExists</ref>(ident))<sp/>{</highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1exceptions_1_1AlreadyExistsException" kindref="compound">AlreadyExistsException</ref>(</highlight><highlight class="stringliteral">&quot;Table<sp/>already<sp/>exists:<sp/>%s&quot;</highlight><highlight class="normal">,<sp/>ident);</highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="226"><highlight class="normal"></highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/><sp/><sp/>Map&lt;String,<sp/>String&gt;<sp/>properties<sp/>=<sp/>Maps.newHashMap();</highlight></codeline>
<codeline lineno="228"><highlight class="normal"><sp/><sp/><sp/><sp/>properties.put(</highlight><highlight class="stringliteral">&quot;created-at&quot;</highlight><highlight class="normal">,<sp/>OffsetDateTime.now(ZoneOffset.UTC).toString());</highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/><sp/><sp/>properties.putAll(request.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1CreateTableRequest_1a7891e6883dbf8d25350f695c73b977e9" kindref="member">properties</ref>());</highlight></codeline>
<codeline lineno="230"><highlight class="normal"></highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/>String<sp/>location;</highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(request.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1CreateTableRequest_1a4d05cf429430fe294663356d5e4de924" kindref="member">location</ref>()<sp/>!=<sp/></highlight><highlight class="keyword">null</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>location<sp/>=<sp/>request.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1CreateTableRequest_1a4d05cf429430fe294663356d5e4de924" kindref="member">location</ref>();</highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>location<sp/>=</highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>catalog</highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1Catalog_1a2c01afeef7c14c4a305054ae2954df10" kindref="member">buildTable</ref>(ident,<sp/>request.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1CreateTableRequest_1afb2756bdacab24192a63b49c93736d6c" kindref="member">schema</ref>())</highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1Catalog_1_1TableBuilder_1aba5cf378d71abe6d191dae4b1b0beb97" kindref="member">withPartitionSpec</ref>(request.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1CreateTableRequest_1a8c061cb05d37dc74d8a166b16f100d40" kindref="member">spec</ref>())</highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1Catalog_1_1TableBuilder_1a376c1f45461c23f633463aa0094da24f" kindref="member">withSortOrder</ref>(request.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1CreateTableRequest_1ac9f016d3fa1e0a80dcf3b630e937777d" kindref="member">writeOrder</ref>())</highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1Catalog_1_1TableBuilder_1acbc72f3fbb3473ab78ed3720d0ec782b" kindref="member">withProperties</ref>(properties)</highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1Catalog_1_1TableBuilder_1af0a975301e1c65c764b7e40c15672882" kindref="member">createTransaction</ref>()</highlight></codeline>
<codeline lineno="242"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Transaction_1ae69c741f88d2519eab3985724d4b2a9c" kindref="member">table</ref>()</highlight></codeline>
<codeline lineno="243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Table_1a511c89ef4e28cf6eaafef5615c0ee9a2" kindref="member">location</ref>();</highlight></codeline>
<codeline lineno="244"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="245"><highlight class="normal"></highlight></codeline>
<codeline lineno="246"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1TableMetadata" kindref="compound">TableMetadata</ref><sp/>metadata<sp/>=</highlight></codeline>
<codeline lineno="247"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1TableMetadata" kindref="compound">TableMetadata</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1TableMetadata_1a9fd4203393b368d9e5aaa14acf38014a" kindref="member">newTableMetadata</ref>(</highlight></codeline>
<codeline lineno="248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>request.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1CreateTableRequest_1afb2756bdacab24192a63b49c93736d6c" kindref="member">schema</ref>(),</highlight></codeline>
<codeline lineno="249"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>request.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1CreateTableRequest_1a8c061cb05d37dc74d8a166b16f100d40" kindref="member">spec</ref>()<sp/>!=<sp/></highlight><highlight class="keyword">null</highlight><highlight class="normal"><sp/>?<sp/>request.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1CreateTableRequest_1a8c061cb05d37dc74d8a166b16f100d40" kindref="member">spec</ref>()<sp/>:<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1PartitionSpec" kindref="compound">PartitionSpec</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1PartitionSpec_1a0409de53f7357c6c70009d25ba61b2c5" kindref="member">unpartitioned</ref>(),</highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>request.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1CreateTableRequest_1ac9f016d3fa1e0a80dcf3b630e937777d" kindref="member">writeOrder</ref>()<sp/>!=<sp/></highlight><highlight class="keyword">null</highlight><highlight class="normal"><sp/>?<sp/>request.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1CreateTableRequest_1ac9f016d3fa1e0a80dcf3b630e937777d" kindref="member">writeOrder</ref>()<sp/>:<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1SortOrder" kindref="compound">SortOrder</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1SortOrder_1a0df25c253d4bd778f08db5b7680ad14a" kindref="member">unsorted</ref>(),</highlight></codeline>
<codeline lineno="251"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>location,</highlight></codeline>
<codeline lineno="252"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>properties);</highlight></codeline>
<codeline lineno="253"><highlight class="normal"></highlight></codeline>
<codeline lineno="254"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1LoadTableResponse" kindref="compound">LoadTableResponse</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1LoadTableResponse_1ac2ea7ae288658bd2446a0505f84acbb0" kindref="member">builder</ref>().<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1LoadTableResponse_1_1Builder_1a6ad8448239c32af8b96281a29ed377ab" kindref="member">withTableMetadata</ref>(metadata).<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1LoadTableResponse_1_1Builder_1a2ba69e9e246443fc20c9d104d94e0352" kindref="member">build</ref>();</highlight></codeline>
<codeline lineno="255"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="256"><highlight class="normal"></highlight></codeline>
<codeline lineno="257" refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1a3a1608e7b937912504fb07369e805970" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1LoadTableResponse" kindref="compound">LoadTableResponse</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1a3a1608e7b937912504fb07369e805970" kindref="member">createTable</ref>(</highlight></codeline>
<codeline lineno="258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1Catalog" kindref="compound">Catalog</ref><sp/>catalog,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1Namespace" kindref="compound">Namespace</ref><sp/></highlight><highlight class="keyword">namespace</highlight><highlight class="normal">,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1CreateTableRequest" kindref="compound">CreateTableRequest</ref><sp/>request)<sp/>{</highlight></codeline>
<codeline lineno="259"><highlight class="normal"><sp/><sp/><sp/><sp/>request.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1CreateTableRequest_1a4a2d8be0a00cd58c4b5903dbde0bab33" kindref="member">validate</ref>();</highlight></codeline>
<codeline lineno="260"><highlight class="normal"></highlight></codeline>
<codeline lineno="261"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1TableIdentifier" kindref="compound">TableIdentifier</ref><sp/>ident<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1TableIdentifier" kindref="compound">TableIdentifier</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1TableIdentifier_1a76db86a1aa530669397f2c4de5e9497d" kindref="member">of</ref>(</highlight><highlight class="keyword">namespace</highlight><highlight class="normal">,<sp/>request.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1CreateTableRequest_1a4d63266c4966439f85ea45d812788a08" kindref="member">name</ref>());</highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Table" kindref="compound">Table</ref><sp/>table<sp/>=</highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>catalog</highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1Catalog_1a2c01afeef7c14c4a305054ae2954df10" kindref="member">buildTable</ref>(ident,<sp/>request.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1CreateTableRequest_1afb2756bdacab24192a63b49c93736d6c" kindref="member">schema</ref>())</highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1Catalog_1_1TableBuilder_1adb558b9ec848bfc96dfbd3fe4489de47" kindref="member">withLocation</ref>(request.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1CreateTableRequest_1a4d05cf429430fe294663356d5e4de924" kindref="member">location</ref>())</highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1Catalog_1_1TableBuilder_1aba5cf378d71abe6d191dae4b1b0beb97" kindref="member">withPartitionSpec</ref>(request.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1CreateTableRequest_1a8c061cb05d37dc74d8a166b16f100d40" kindref="member">spec</ref>())</highlight></codeline>
<codeline lineno="267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1Catalog_1_1TableBuilder_1a376c1f45461c23f633463aa0094da24f" kindref="member">withSortOrder</ref>(request.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1CreateTableRequest_1ac9f016d3fa1e0a80dcf3b630e937777d" kindref="member">writeOrder</ref>())</highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1Catalog_1_1TableBuilder_1acbc72f3fbb3473ab78ed3720d0ec782b" kindref="member">withProperties</ref>(request.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1CreateTableRequest_1a7891e6883dbf8d25350f695c73b977e9" kindref="member">properties</ref>())</highlight></codeline>
<codeline lineno="269"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1Catalog_1_1TableBuilder_1a6b9efe5211cb1866428f37ac4ddffa15" kindref="member">create</ref>();</highlight></codeline>
<codeline lineno="270"><highlight class="normal"></highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(table<sp/>instanceof<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1BaseTable" kindref="compound">BaseTable</ref>)<sp/>{</highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1LoadTableResponse" kindref="compound">LoadTableResponse</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1LoadTableResponse_1ac2ea7ae288658bd2446a0505f84acbb0" kindref="member">builder</ref>()</highlight></codeline>
<codeline lineno="273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1LoadTableResponse_1_1Builder_1a6ad8448239c32af8b96281a29ed377ab" kindref="member">withTableMetadata</ref>(((<ref refid="classorg_1_1apache_1_1iceberg_1_1BaseTable" kindref="compound">BaseTable</ref>)<sp/>table).operations().current())</highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1LoadTableResponse_1_1Builder_1a2ba69e9e246443fc20c9d104d94e0352" kindref="member">build</ref>();</highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="276"><highlight class="normal"></highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>IllegalStateException(</highlight><highlight class="stringliteral">&quot;Cannot<sp/>wrap<sp/>catalog<sp/>that<sp/>does<sp/>not<sp/>produce<sp/>BaseTable&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="278"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="279"><highlight class="normal"></highlight></codeline>
<codeline lineno="280" refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1a66291e217b41e0b517d56926eaebe653" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1LoadTableResponse" kindref="compound">LoadTableResponse</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1a66291e217b41e0b517d56926eaebe653" kindref="member">registerTable</ref>(</highlight></codeline>
<codeline lineno="281"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1Catalog" kindref="compound">Catalog</ref><sp/>catalog,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1Namespace" kindref="compound">Namespace</ref><sp/></highlight><highlight class="keyword">namespace</highlight><highlight class="normal">,<sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1RegisterTableRequest" kindref="compound">RegisterTableRequest</ref><sp/>request)<sp/>{</highlight></codeline>
<codeline lineno="282"><highlight class="normal"><sp/><sp/><sp/><sp/>request.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1RegisterTableRequest_1aa0d013961bc8be7c3dd58e1ced4add9d" kindref="member">validate</ref>();</highlight></codeline>
<codeline lineno="283"><highlight class="normal"></highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1TableIdentifier" kindref="compound">TableIdentifier</ref><sp/>identifier<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1TableIdentifier" kindref="compound">TableIdentifier</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1TableIdentifier_1a76db86a1aa530669397f2c4de5e9497d" kindref="member">of</ref>(</highlight><highlight class="keyword">namespace</highlight><highlight class="normal">,<sp/>request.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1RegisterTableRequest_1a69fd4bbf797ebe7e98a79425209ed519" kindref="member">name</ref>());</highlight></codeline>
<codeline lineno="285"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Table" kindref="compound">Table</ref><sp/>table<sp/>=<sp/>catalog.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1Catalog_1a2fe0af717f867dffad934fba3b425001" kindref="member">registerTable</ref>(identifier,<sp/>request.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1RegisterTableRequest_1a941c4548bb9b6db50c1ea7edc33f58fd" kindref="member">metadataLocation</ref>());</highlight></codeline>
<codeline lineno="286"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(table<sp/>instanceof<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1BaseTable" kindref="compound">BaseTable</ref>)<sp/>{</highlight></codeline>
<codeline lineno="287"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1LoadTableResponse" kindref="compound">LoadTableResponse</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1LoadTableResponse_1ac2ea7ae288658bd2446a0505f84acbb0" kindref="member">builder</ref>()</highlight></codeline>
<codeline lineno="288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1LoadTableResponse_1_1Builder_1a6ad8448239c32af8b96281a29ed377ab" kindref="member">withTableMetadata</ref>(((<ref refid="classorg_1_1apache_1_1iceberg_1_1BaseTable" kindref="compound">BaseTable</ref>)<sp/>table).operations().current())</highlight></codeline>
<codeline lineno="289"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1LoadTableResponse_1_1Builder_1a2ba69e9e246443fc20c9d104d94e0352" kindref="member">build</ref>();</highlight></codeline>
<codeline lineno="290"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="291"><highlight class="normal"></highlight></codeline>
<codeline lineno="292"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>IllegalStateException(</highlight><highlight class="stringliteral">&quot;Cannot<sp/>wrap<sp/>catalog<sp/>that<sp/>does<sp/>not<sp/>produce<sp/>BaseTable&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="293"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="294"><highlight class="normal"></highlight></codeline>
<codeline lineno="295" refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1a98e5c254b243c1c6590f2a72190e4947" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1a98e5c254b243c1c6590f2a72190e4947" kindref="member">dropTable</ref>(<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1Catalog" kindref="compound">Catalog</ref><sp/>catalog,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1TableIdentifier" kindref="compound">TableIdentifier</ref><sp/>ident)<sp/>{</highlight></codeline>
<codeline lineno="296"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">boolean</highlight><highlight class="normal"><sp/>dropped<sp/>=<sp/>catalog.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1Catalog_1ad42e74e5b4ab4b2f59d75a00426eafb7" kindref="member">dropTable</ref>(ident,<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="297"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!dropped)<sp/>{</highlight></codeline>
<codeline lineno="298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1exceptions_1_1NoSuchTableException" kindref="compound">NoSuchTableException</ref>(</highlight><highlight class="stringliteral">&quot;Table<sp/>does<sp/>not<sp/>exist:<sp/>%s&quot;</highlight><highlight class="normal">,<sp/>ident);</highlight></codeline>
<codeline lineno="299"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="300"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="301"><highlight class="normal"></highlight></codeline>
<codeline lineno="302" refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1afbb280bffc00d89aae63ec483ff3561e" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1afbb280bffc00d89aae63ec483ff3561e" kindref="member">purgeTable</ref>(<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1Catalog" kindref="compound">Catalog</ref><sp/>catalog,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1TableIdentifier" kindref="compound">TableIdentifier</ref><sp/>ident)<sp/>{</highlight></codeline>
<codeline lineno="303"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">boolean</highlight><highlight class="normal"><sp/>dropped<sp/>=<sp/>catalog.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1Catalog_1ad42e74e5b4ab4b2f59d75a00426eafb7" kindref="member">dropTable</ref>(ident,<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="304"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!dropped)<sp/>{</highlight></codeline>
<codeline lineno="305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1exceptions_1_1NoSuchTableException" kindref="compound">NoSuchTableException</ref>(</highlight><highlight class="stringliteral">&quot;Table<sp/>does<sp/>not<sp/>exist:<sp/>%s&quot;</highlight><highlight class="normal">,<sp/>ident);</highlight></codeline>
<codeline lineno="306"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="307"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="308"><highlight class="normal"></highlight></codeline>
<codeline lineno="309" refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1afedf26b3cd4b93cb5c3d385ea1aa326d" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1LoadTableResponse" kindref="compound">LoadTableResponse</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1afedf26b3cd4b93cb5c3d385ea1aa326d" kindref="member">loadTable</ref>(<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1Catalog" kindref="compound">Catalog</ref><sp/>catalog,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1TableIdentifier" kindref="compound">TableIdentifier</ref><sp/>ident)<sp/>{</highlight></codeline>
<codeline lineno="310"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Table" kindref="compound">Table</ref><sp/>table<sp/>=<sp/>catalog.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1Catalog_1ae0f2c034e81cc13f0ff5782e749d192d" kindref="member">loadTable</ref>(ident);</highlight></codeline>
<codeline lineno="311"><highlight class="normal"></highlight></codeline>
<codeline lineno="312"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(table<sp/>instanceof<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1BaseTable" kindref="compound">BaseTable</ref>)<sp/>{</highlight></codeline>
<codeline lineno="313"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1LoadTableResponse" kindref="compound">LoadTableResponse</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1LoadTableResponse_1ac2ea7ae288658bd2446a0505f84acbb0" kindref="member">builder</ref>()</highlight></codeline>
<codeline lineno="314"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1LoadTableResponse_1_1Builder_1a6ad8448239c32af8b96281a29ed377ab" kindref="member">withTableMetadata</ref>(((<ref refid="classorg_1_1apache_1_1iceberg_1_1BaseTable" kindref="compound">BaseTable</ref>)<sp/>table).operations().current())</highlight></codeline>
<codeline lineno="315"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1LoadTableResponse_1_1Builder_1a2ba69e9e246443fc20c9d104d94e0352" kindref="member">build</ref>();</highlight></codeline>
<codeline lineno="316"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(table<sp/>instanceof<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1BaseMetadataTable" kindref="compound">BaseMetadataTable</ref>)<sp/>{</highlight></codeline>
<codeline lineno="317"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>metadata<sp/>tables<sp/>are<sp/>loaded<sp/>on<sp/>the<sp/>client<sp/>side,<sp/>return<sp/>NoSuchTableException<sp/>for<sp/>now</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1exceptions_1_1NoSuchTableException" kindref="compound">NoSuchTableException</ref>(</highlight><highlight class="stringliteral">&quot;Table<sp/>does<sp/>not<sp/>exist:<sp/>%s&quot;</highlight><highlight class="normal">,<sp/>ident.<ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1TableIdentifier_1afdf4cc9646c2810128f5564bc13ecf28" kindref="member">toString</ref>());</highlight></codeline>
<codeline lineno="319"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="320"><highlight class="normal"></highlight></codeline>
<codeline lineno="321"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>IllegalStateException(</highlight><highlight class="stringliteral">&quot;Cannot<sp/>wrap<sp/>catalog<sp/>that<sp/>does<sp/>not<sp/>produce<sp/>BaseTable&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="322"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="323"><highlight class="normal"></highlight></codeline>
<codeline lineno="324" refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1ad54b1a99711c0784143ab0ad45bf5244" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1LoadTableResponse" kindref="compound">LoadTableResponse</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1ad54b1a99711c0784143ab0ad45bf5244" kindref="member">updateTable</ref>(</highlight></codeline>
<codeline lineno="325"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1Catalog" kindref="compound">Catalog</ref><sp/>catalog,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1TableIdentifier" kindref="compound">TableIdentifier</ref><sp/>ident,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1UpdateTableRequest" kindref="compound">UpdateTableRequest</ref><sp/>request)<sp/>{</highlight></codeline>
<codeline lineno="326"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1TableMetadata" kindref="compound">TableMetadata</ref><sp/>finalMetadata;</highlight></codeline>
<codeline lineno="327"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1a387b234c6590cb3d2abd6ea7f85b0eb6" kindref="member">isCreate</ref>(request))<sp/>{</highlight></codeline>
<codeline lineno="328"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>this<sp/>is<sp/>a<sp/>hacky<sp/>way<sp/>to<sp/>get<sp/>TableOperations<sp/>for<sp/>an<sp/>uncommitted<sp/>table</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="329"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Transaction" kindref="compound">Transaction</ref><sp/>transaction<sp/>=</highlight></codeline>
<codeline lineno="330"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>catalog.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1Catalog_1a2c01afeef7c14c4a305054ae2954df10" kindref="member">buildTable</ref>(ident,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1a298bace6272177bfabac7e70a3237e05" kindref="member">EMPTY_SCHEMA</ref>).<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1Catalog_1_1TableBuilder_1ac8df91c100c1259b6f39b98a89de7ac1" kindref="member">createOrReplaceTransaction</ref>();</highlight></codeline>
<codeline lineno="331"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(transaction<sp/>instanceof<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1BaseTransaction" kindref="compound">BaseTransaction</ref>)<sp/>{</highlight></codeline>
<codeline lineno="332"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1BaseTransaction" kindref="compound">BaseTransaction</ref><sp/>baseTransaction<sp/>=<sp/>(<ref refid="classorg_1_1apache_1_1iceberg_1_1BaseTransaction" kindref="compound">BaseTransaction</ref>)<sp/>transaction;</highlight></codeline>
<codeline lineno="333"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>finalMetadata<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1af2843e396139274e10eb006b4beb5352" kindref="member">create</ref>(baseTransaction.<ref refid="classorg_1_1apache_1_1iceberg_1_1BaseTransaction_1a53cb6ac848edc3a6d318120c90157554" kindref="member">underlyingOps</ref>(),<sp/>request);</highlight></codeline>
<codeline lineno="334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>IllegalStateException(</highlight></codeline>
<codeline lineno="336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Cannot<sp/>wrap<sp/>catalog<sp/>that<sp/>does<sp/>not<sp/>produce<sp/>BaseTransaction&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="338"><highlight class="normal"></highlight></codeline>
<codeline lineno="339"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="340"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Table" kindref="compound">Table</ref><sp/>table<sp/>=<sp/>catalog.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1Catalog_1ae0f2c034e81cc13f0ff5782e749d192d" kindref="member">loadTable</ref>(ident);</highlight></codeline>
<codeline lineno="341"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(table<sp/>instanceof<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1BaseTable" kindref="compound">BaseTable</ref>)<sp/>{</highlight></codeline>
<codeline lineno="342"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1TableOperations" kindref="compound">TableOperations</ref><sp/>ops<sp/>=<sp/>((<ref refid="classorg_1_1apache_1_1iceberg_1_1BaseTable" kindref="compound">BaseTable</ref>)<sp/>table).operations();</highlight></codeline>
<codeline lineno="343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>finalMetadata<sp/>=<sp/>commit(ops,<sp/>request);</highlight></codeline>
<codeline lineno="344"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="345"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>IllegalStateException(</highlight><highlight class="stringliteral">&quot;Cannot<sp/>wrap<sp/>catalog<sp/>that<sp/>does<sp/>not<sp/>produce<sp/>BaseTable&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="347"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="348"><highlight class="normal"></highlight></codeline>
<codeline lineno="349"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1LoadTableResponse" kindref="compound">LoadTableResponse</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1LoadTableResponse_1ac2ea7ae288658bd2446a0505f84acbb0" kindref="member">builder</ref>().<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1LoadTableResponse_1_1Builder_1a6ad8448239c32af8b96281a29ed377ab" kindref="member">withTableMetadata</ref>(finalMetadata).<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1LoadTableResponse_1_1Builder_1a2ba69e9e246443fc20c9d104d94e0352" kindref="member">build</ref>();</highlight></codeline>
<codeline lineno="350"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="351"><highlight class="normal"></highlight></codeline>
<codeline lineno="352" refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1a62ecaa9071017d7f47307480ceb7f2c8" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1a62ecaa9071017d7f47307480ceb7f2c8" kindref="member">renameTable</ref>(<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1Catalog" kindref="compound">Catalog</ref><sp/>catalog,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1RenameTableRequest" kindref="compound">RenameTableRequest</ref><sp/>request)<sp/>{</highlight></codeline>
<codeline lineno="353"><highlight class="normal"><sp/><sp/><sp/><sp/>catalog.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1Catalog_1a65b9a525b88f6e743dbfa652d1c27cab" kindref="member">renameTable</ref>(request.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1RenameTableRequest_1aa803710bc03064d3e31542060938accd" kindref="member">source</ref>(),<sp/>request.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1RenameTableRequest_1abcfbbf8a9a8bfacea60fc77c765fc842" kindref="member">destination</ref>());</highlight></codeline>
<codeline lineno="354"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="355"><highlight class="normal"></highlight></codeline>
<codeline lineno="356" refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1a387b234c6590cb3d2abd6ea7f85b0eb6" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">boolean</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1a387b234c6590cb3d2abd6ea7f85b0eb6" kindref="member">isCreate</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1UpdateTableRequest" kindref="compound">UpdateTableRequest</ref><sp/>request)<sp/>{</highlight></codeline>
<codeline lineno="357"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">boolean</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1a387b234c6590cb3d2abd6ea7f85b0eb6" kindref="member">isCreate</ref><sp/>=</highlight></codeline>
<codeline lineno="358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>request.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1UpdateTableRequest_1a630b8c8da2d0e719a33f4b67163b1653" kindref="member">requirements</ref>().stream()</highlight></codeline>
<codeline lineno="359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.anyMatch(<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1UpdateRequirement" kindref="compound">UpdateRequirement</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1UpdateRequirement_1_1AssertTableDoesNotExist" kindref="compound">AssertTableDoesNotExist</ref>.class::isInstance);</highlight></codeline>
<codeline lineno="360"><highlight class="normal"></highlight></codeline>
<codeline lineno="361"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1a387b234c6590cb3d2abd6ea7f85b0eb6" kindref="member">isCreate</ref>)<sp/>{</highlight></codeline>
<codeline lineno="362"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>List&lt;UpdateRequirement&gt;<sp/>invalidRequirements<sp/>=</highlight></codeline>
<codeline lineno="363"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>request.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1UpdateTableRequest_1a630b8c8da2d0e719a33f4b67163b1653" kindref="member">requirements</ref>().stream()</highlight></codeline>
<codeline lineno="364"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.filter(req<sp/>-&gt;<sp/>!(req<sp/>instanceof<sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1UpdateRequirement" kindref="compound">UpdateRequirement</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1UpdateRequirement_1_1AssertTableDoesNotExist" kindref="compound">AssertTableDoesNotExist</ref>))</highlight></codeline>
<codeline lineno="365"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.collect(Collectors.toList());</highlight></codeline>
<codeline lineno="366"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Preconditions.checkArgument(</highlight></codeline>
<codeline lineno="367"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>invalidRequirements.isEmpty(),<sp/></highlight><highlight class="stringliteral">&quot;Invalid<sp/>create<sp/>requirements:<sp/>%s&quot;</highlight><highlight class="normal">,<sp/>invalidRequirements);</highlight></codeline>
<codeline lineno="368"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="369"><highlight class="normal"></highlight></codeline>
<codeline lineno="370"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1a387b234c6590cb3d2abd6ea7f85b0eb6" kindref="member">isCreate</ref>;</highlight></codeline>
<codeline lineno="371"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="372"><highlight class="normal"></highlight></codeline>
<codeline lineno="373" refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1af2843e396139274e10eb006b4beb5352" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1TableMetadata" kindref="compound">TableMetadata</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1af2843e396139274e10eb006b4beb5352" kindref="member">create</ref>(<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1TableOperations" kindref="compound">TableOperations</ref><sp/>ops,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1UpdateTableRequest" kindref="compound">UpdateTableRequest</ref><sp/>request)<sp/>{</highlight></codeline>
<codeline lineno="374"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>the<sp/>only<sp/>valid<sp/>requirement<sp/>is<sp/>that<sp/>the<sp/>table<sp/>will<sp/>be<sp/>created</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="375"><highlight class="normal"><sp/><sp/><sp/><sp/>request.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1UpdateTableRequest_1a630b8c8da2d0e719a33f4b67163b1653" kindref="member">requirements</ref>().forEach(requirement<sp/>-&gt;<sp/>requirement.validate(ops.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1TableOperations_1a96a251e76611125a2903eb608c97aa67" kindref="member">current</ref>()));</highlight></codeline>
<codeline lineno="376"><highlight class="normal"></highlight></codeline>
<codeline lineno="377"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1TableMetadata" kindref="compound">TableMetadata</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1TableMetadata_1_1Builder" kindref="compound">Builder</ref><sp/>builder<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1TableMetadata" kindref="compound">TableMetadata</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1TableMetadata_1a44f1055d32b1e739202a52f853446d12" kindref="member">buildFromEmpty</ref>();</highlight></codeline>
<codeline lineno="378"><highlight class="normal"><sp/><sp/><sp/><sp/>request.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1UpdateTableRequest_1aedaa7109083ad9583c1d76c864de977a" kindref="member">updates</ref>().forEach(update<sp/>-&gt;<sp/>update.applyTo(builder));</highlight></codeline>
<codeline lineno="379"><highlight class="normal"></highlight></codeline>
<codeline lineno="380"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>create<sp/>transactions<sp/>do<sp/>not<sp/>retry.<sp/>if<sp/>the<sp/>table<sp/>exists,<sp/>retrying<sp/>is<sp/>not<sp/>a<sp/>solution</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="381"><highlight class="normal"><sp/><sp/><sp/><sp/>ops.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1TableOperations_1ad8497b710d8b0f0363af5759543d7aca" kindref="member">commit</ref>(</highlight><highlight class="keyword">null</highlight><highlight class="normal">,<sp/>builder.build());</highlight></codeline>
<codeline lineno="382"><highlight class="normal"></highlight></codeline>
<codeline lineno="383"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ops.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1TableOperations_1a96a251e76611125a2903eb608c97aa67" kindref="member">current</ref>();</highlight></codeline>
<codeline lineno="384"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="385"><highlight class="normal"></highlight></codeline>
<codeline lineno="386"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1TableMetadata" kindref="compound">TableMetadata</ref><sp/>commit(<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1TableOperations" kindref="compound">TableOperations</ref><sp/>ops,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1UpdateTableRequest" kindref="compound">UpdateTableRequest</ref><sp/>request)<sp/>{</highlight></codeline>
<codeline lineno="387"><highlight class="normal"><sp/><sp/><sp/><sp/>AtomicBoolean<sp/>isRetry<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>AtomicBoolean(</highlight><highlight class="keyword">false</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="388"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1util_1_1Tasks" kindref="compound">Tasks</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1util_1_1Tasks_1a4e02a04c6d01b1feceec7c0b1b4fbf12" kindref="member">foreach</ref>(ops)</highlight></codeline>
<codeline lineno="390"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.retry(COMMIT_NUM_RETRIES_DEFAULT)</highlight></codeline>
<codeline lineno="391"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.exponentialBackoff(</highlight></codeline>
<codeline lineno="392"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>COMMIT_MIN_RETRY_WAIT_MS_DEFAULT,</highlight></codeline>
<codeline lineno="393"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>COMMIT_MAX_RETRY_WAIT_MS_DEFAULT,</highlight></codeline>
<codeline lineno="394"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>COMMIT_TOTAL_RETRY_TIME_MS_DEFAULT,</highlight></codeline>
<codeline lineno="395"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>2.0<sp/></highlight><highlight class="comment">/*<sp/>exponential<sp/>*/</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.onlyRetryOn(<ref refid="classorg_1_1apache_1_1iceberg_1_1exceptions_1_1CommitFailedException" kindref="compound">CommitFailedException</ref>.class)</highlight></codeline>
<codeline lineno="397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.run(</highlight></codeline>
<codeline lineno="398"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>taskOps<sp/>-&gt;<sp/>{</highlight></codeline>
<codeline lineno="399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1TableMetadata" kindref="compound">TableMetadata</ref><sp/>base<sp/>=<sp/>isRetry.get()<sp/>?<sp/>taskOps.refresh()<sp/>:<sp/>taskOps.current();</highlight></codeline>
<codeline lineno="400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>isRetry.set(</highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="401"><highlight class="normal"></highlight></codeline>
<codeline lineno="402"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>validate<sp/>requirements</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="403"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="404"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>request.requirements().forEach(requirement<sp/>-&gt;<sp/>requirement.validate(base));</highlight></codeline>
<codeline lineno="405"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>catch<sp/>(<ref refid="classorg_1_1apache_1_1iceberg_1_1exceptions_1_1CommitFailedException" kindref="compound">CommitFailedException</ref><sp/>e)<sp/>{</highlight></codeline>
<codeline lineno="406"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>wrap<sp/>and<sp/>rethrow<sp/>outside<sp/>of<sp/>tasks<sp/>to<sp/>avoid<sp/>unnecessary<sp/>retry</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="407"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>ValidationFailureException(e);</highlight></codeline>
<codeline lineno="408"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="409"><highlight class="normal"></highlight></codeline>
<codeline lineno="410"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>apply<sp/>changes</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="411"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1TableMetadata" kindref="compound">TableMetadata</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1TableMetadata_1_1Builder" kindref="compound">Builder</ref><sp/>metadataBuilder<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1TableMetadata" kindref="compound">TableMetadata</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1TableMetadata_1aa4c8b99866c10cad05a0c893fe3f936d" kindref="member">buildFrom</ref>(base);</highlight></codeline>
<codeline lineno="412"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>request.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1UpdateTableRequest_1aedaa7109083ad9583c1d76c864de977a" kindref="member">updates</ref>().forEach(update<sp/>-&gt;<sp/>update.applyTo(metadataBuilder));</highlight></codeline>
<codeline lineno="413"><highlight class="normal"></highlight></codeline>
<codeline lineno="414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1TableMetadata" kindref="compound">TableMetadata</ref><sp/>updated<sp/>=<sp/>metadataBuilder.build();</highlight></codeline>
<codeline lineno="415"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(updated.<ref refid="classorg_1_1apache_1_1iceberg_1_1TableMetadata_1a25930ba1c1c77278fd0ef5fc19bf6e91" kindref="member">changes</ref>().isEmpty())<sp/>{</highlight></codeline>
<codeline lineno="416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>do<sp/>not<sp/>commit<sp/>if<sp/>the<sp/>metadata<sp/>has<sp/>not<sp/>changed</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="417"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="418"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="419"><highlight class="normal"></highlight></codeline>
<codeline lineno="420"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>commit</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="421"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>taskOps.commit(base,<sp/>updated);</highlight></codeline>
<codeline lineno="422"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>});</highlight></codeline>
<codeline lineno="423"><highlight class="normal"></highlight></codeline>
<codeline lineno="424"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">catch</highlight><highlight class="normal"><sp/>(ValidationFailureException<sp/>e)<sp/>{</highlight></codeline>
<codeline lineno="425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/>e.wrapped();</highlight></codeline>
<codeline lineno="426"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="427"><highlight class="normal"></highlight></codeline>
<codeline lineno="428"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ops.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1TableOperations_1a96a251e76611125a2903eb608c97aa67" kindref="member">current</ref>();</highlight></codeline>
<codeline lineno="429"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="430"><highlight class="normal"></highlight></codeline>
<codeline lineno="431" refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1a5b15d0a7f6d2334770836755af473c1a" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1view_1_1BaseView" kindref="compound">BaseView</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1a5b15d0a7f6d2334770836755af473c1a" kindref="member">asBaseView</ref>(<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1view_1_1View" kindref="compound">View</ref><sp/>view)<sp/>{</highlight></codeline>
<codeline lineno="432"><highlight class="normal"><sp/><sp/><sp/><sp/>Preconditions.checkState(</highlight></codeline>
<codeline lineno="433"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>view<sp/>instanceof<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1view_1_1BaseView" kindref="compound">BaseView</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Cannot<sp/>wrap<sp/>catalog<sp/>that<sp/>does<sp/>not<sp/>produce<sp/>BaseView&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="434"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(<ref refid="classorg_1_1apache_1_1iceberg_1_1view_1_1BaseView" kindref="compound">BaseView</ref>)<sp/>view;</highlight></codeline>
<codeline lineno="435"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="436"><highlight class="normal"></highlight></codeline>
<codeline lineno="437" refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1ab02ea4f7752ad6190d187907324a3030" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1ListTablesResponse" kindref="compound">ListTablesResponse</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1ab02ea4f7752ad6190d187907324a3030" kindref="member">listViews</ref>(<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1ViewCatalog" kindref="compound">ViewCatalog</ref><sp/>catalog,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1Namespace" kindref="compound">Namespace</ref><sp/></highlight><highlight class="keyword">namespace</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="438"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1ListTablesResponse" kindref="compound">ListTablesResponse</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1ListTablesResponse_1af28680b6b78152b1b5893b73b2718d91" kindref="member">builder</ref>().<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1ListTablesResponse_1_1Builder_1ab1dfa56e4df3f0390ec2a8db38395795" kindref="member">addAll</ref>(catalog.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1ViewCatalog_1ab0ecdf5dba289b2bdabfd1aedf736277" kindref="member">listViews</ref>(</highlight><highlight class="keyword">namespace</highlight><highlight class="normal">)).<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1ListTablesResponse_1_1Builder_1a003854e7074d6320a624fba112e65465" kindref="member">build</ref>();</highlight></codeline>
<codeline lineno="439"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="440"><highlight class="normal"></highlight></codeline>
<codeline lineno="441" refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1a6ad8e1a8972870c3abe7bd757b246fa3" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1ListTablesResponse" kindref="compound">ListTablesResponse</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1a6ad8e1a8972870c3abe7bd757b246fa3" kindref="member">listViews</ref>(</highlight></codeline>
<codeline lineno="442"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1ViewCatalog" kindref="compound">ViewCatalog</ref><sp/>catalog,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1Namespace" kindref="compound">Namespace</ref><sp/></highlight><highlight class="keyword">namespace</highlight><highlight class="normal">,<sp/>String<sp/>pageToken,<sp/>String<sp/>pageSize)<sp/>{</highlight></codeline>
<codeline lineno="443"><highlight class="normal"><sp/><sp/><sp/><sp/>List&lt;TableIdentifier&gt;<sp/>results<sp/>=<sp/>catalog.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1ViewCatalog_1ab0ecdf5dba289b2bdabfd1aedf736277" kindref="member">listViews</ref>(</highlight><highlight class="keyword">namespace</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="444"><highlight class="normal"><sp/><sp/><sp/><sp/>List&lt;TableIdentifier&gt;<sp/>subResults;</highlight></codeline>
<codeline lineno="445"><highlight class="normal"></highlight></codeline>
<codeline lineno="446"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>start<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1afba67d355137060445ce581b1867e37c" kindref="member">INTIAL_PAGE_TOKEN</ref>.equals(pageToken)<sp/>?<sp/>0<sp/>:<sp/>Integer.parseInt(pageToken);</highlight></codeline>
<codeline lineno="447"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>end<sp/>=<sp/>start<sp/>+<sp/>Integer.parseInt(pageSize);</highlight></codeline>
<codeline lineno="448"><highlight class="normal"><sp/><sp/><sp/><sp/>subResults<sp/>=<sp/>results.subList(start,<sp/>end);</highlight></codeline>
<codeline lineno="449"><highlight class="normal"><sp/><sp/><sp/><sp/>String<sp/>nextToken<sp/>=<sp/>String.valueOf(end);</highlight></codeline>
<codeline lineno="450"><highlight class="normal"></highlight></codeline>
<codeline lineno="451"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(end<sp/>&gt;=<sp/>results.size())<sp/>{</highlight></codeline>
<codeline lineno="452"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>nextToken<sp/>=<sp/></highlight><highlight class="keyword">null</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="453"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="454"><highlight class="normal"></highlight></codeline>
<codeline lineno="455"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1ListTablesResponse" kindref="compound">ListTablesResponse</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1ListTablesResponse_1af28680b6b78152b1b5893b73b2718d91" kindref="member">builder</ref>().<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1ListTablesResponse_1_1Builder_1ab1dfa56e4df3f0390ec2a8db38395795" kindref="member">addAll</ref>(subResults).<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1ListTablesResponse_1_1Builder_1a97eaef1213eb3877e5f1d78f002b166d" kindref="member">nextPageToken</ref>(nextToken).build();</highlight></codeline>
<codeline lineno="456"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="457"><highlight class="normal"></highlight></codeline>
<codeline lineno="458" refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1af12dec6ce241b0ced74dd5842641547b" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1LoadViewResponse" kindref="compound">LoadViewResponse</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1af12dec6ce241b0ced74dd5842641547b" kindref="member">createView</ref>(</highlight></codeline>
<codeline lineno="459"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1ViewCatalog" kindref="compound">ViewCatalog</ref><sp/>catalog,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1Namespace" kindref="compound">Namespace</ref><sp/></highlight><highlight class="keyword">namespace</highlight><highlight class="normal">,<sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1CreateViewRequest" kindref="compound">CreateViewRequest</ref><sp/>request)<sp/>{</highlight></codeline>
<codeline lineno="460"><highlight class="normal"><sp/><sp/><sp/><sp/>request.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1CreateViewRequest_1a3c0db4760066c5ea0bdb17b6eb4df59f" kindref="member">validate</ref>();</highlight></codeline>
<codeline lineno="461"><highlight class="normal"></highlight></codeline>
<codeline lineno="462"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1view_1_1ViewBuilder" kindref="compound">ViewBuilder</ref><sp/>viewBuilder<sp/>=</highlight></codeline>
<codeline lineno="463"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>catalog</highlight></codeline>
<codeline lineno="464"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1ViewCatalog_1ac12af6646de92a6b987d768a790fc638" kindref="member">buildView</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1TableIdentifier" kindref="compound">TableIdentifier</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1TableIdentifier_1a76db86a1aa530669397f2c4de5e9497d" kindref="member">of</ref>(</highlight><highlight class="keyword">namespace</highlight><highlight class="normal">,<sp/>request.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1CreateViewRequest_1a8ea0d4e10c7bf32fb4b2351e07d8de2f" kindref="member">name</ref>()))</highlight></codeline>
<codeline lineno="465"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1view_1_1VersionBuilder_1a6fcd303dcdecb913c2ab2d99e4be1e4a" kindref="member">withSchema</ref>(request.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1CreateViewRequest_1ae656193d0de77bad70530f88a34585de" kindref="member">schema</ref>())</highlight></codeline>
<codeline lineno="466"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.withProperties(request.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1CreateViewRequest_1aa9d3e46f95aa870c04c45bbb0e01a4b8" kindref="member">properties</ref>())</highlight></codeline>
<codeline lineno="467"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.withDefaultNamespace(request.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1CreateViewRequest_1a4c82a4e4960182e1d40a6eb9c42d7af7" kindref="member">viewVersion</ref>().<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1view_1_1ViewVersion_1a361d2f9438cb07c0205a8a2b6e5e92fa" kindref="member">defaultNamespace</ref>())</highlight></codeline>
<codeline lineno="468"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.withDefaultCatalog(request.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1CreateViewRequest_1a4c82a4e4960182e1d40a6eb9c42d7af7" kindref="member">viewVersion</ref>().<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1view_1_1ViewVersion_1afabf4cc83acf9bbf3eaec36f18d8ed23" kindref="member">defaultCatalog</ref>())</highlight></codeline>
<codeline lineno="469"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.withLocation(request.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1CreateViewRequest_1acf355376c7a535db7ddee05f26ea98ce" kindref="member">location</ref>());</highlight></codeline>
<codeline lineno="470"><highlight class="normal"></highlight></codeline>
<codeline lineno="471"><highlight class="normal"><sp/><sp/><sp/><sp/>Set&lt;String&gt;<sp/>unsupportedRepresentations<sp/>=</highlight></codeline>
<codeline lineno="472"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>request.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1CreateViewRequest_1a4c82a4e4960182e1d40a6eb9c42d7af7" kindref="member">viewVersion</ref>().<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1view_1_1ViewVersion_1abd47b06de5645f71b30942680b2e6ba4" kindref="member">representations</ref>().stream()</highlight></codeline>
<codeline lineno="473"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.filter(r<sp/>-&gt;<sp/>!(r<sp/>instanceof<sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1view_1_1SQLViewRepresentation" kindref="compound">SQLViewRepresentation</ref>))</highlight></codeline>
<codeline lineno="474"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.map(<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1view_1_1ViewRepresentation_1a9395e5a200e87a615732bc9e01eec684" kindref="member">ViewRepresentation::type</ref>)</highlight></codeline>
<codeline lineno="475"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.collect(Collectors.toSet());</highlight></codeline>
<codeline lineno="476"><highlight class="normal"></highlight></codeline>
<codeline lineno="477"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!unsupportedRepresentations.isEmpty())<sp/>{</highlight></codeline>
<codeline lineno="478"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>IllegalStateException(</highlight></codeline>
<codeline lineno="479"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>String.format(</highlight><highlight class="stringliteral">&quot;Found<sp/>unsupported<sp/>view<sp/>representations:<sp/>%s&quot;</highlight><highlight class="normal">,<sp/>unsupportedRepresentations));</highlight></codeline>
<codeline lineno="480"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="481"><highlight class="normal"></highlight></codeline>
<codeline lineno="482"><highlight class="normal"><sp/><sp/><sp/><sp/>request.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1CreateViewRequest_1a4c82a4e4960182e1d40a6eb9c42d7af7" kindref="member">viewVersion</ref>().<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1view_1_1ViewVersion_1abd47b06de5645f71b30942680b2e6ba4" kindref="member">representations</ref>().stream()</highlight></codeline>
<codeline lineno="483"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.filter(<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1view_1_1SQLViewRepresentation" kindref="compound">SQLViewRepresentation</ref>.class::isInstance)</highlight></codeline>
<codeline lineno="484"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.map(<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1view_1_1SQLViewRepresentation" kindref="compound">SQLViewRepresentation</ref>.class::cast)</highlight></codeline>
<codeline lineno="485"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.forEach(r<sp/>-&gt;<sp/>viewBuilder.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1view_1_1VersionBuilder_1aebc1a90019dee77a953e71ca6e7dadc8" kindref="member">withQuery</ref>(r.dialect(),<sp/>r.sql()));</highlight></codeline>
<codeline lineno="486"><highlight class="normal"></highlight></codeline>
<codeline lineno="487"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1view_1_1View" kindref="compound">View</ref><sp/>view<sp/>=<sp/>viewBuilder.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1view_1_1ViewBuilder_1a294f955de86791f73da5aee5eaec892c" kindref="member">create</ref>();</highlight></codeline>
<codeline lineno="488"><highlight class="normal"></highlight></codeline>
<codeline lineno="489"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1a91d203906e1619bfc9cc89757349adcf" kindref="member">viewResponse</ref>(view);</highlight></codeline>
<codeline lineno="490"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="491"><highlight class="normal"></highlight></codeline>
<codeline lineno="492" refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1a91d203906e1619bfc9cc89757349adcf" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1LoadViewResponse" kindref="compound">LoadViewResponse</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1a91d203906e1619bfc9cc89757349adcf" kindref="member">viewResponse</ref>(<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1view_1_1View" kindref="compound">View</ref><sp/>view)<sp/>{</highlight></codeline>
<codeline lineno="493"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1view_1_1ViewMetadata" kindref="compound">ViewMetadata</ref><sp/>metadata<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1a5b15d0a7f6d2334770836755af473c1a" kindref="member">asBaseView</ref>(view).<ref refid="classorg_1_1apache_1_1iceberg_1_1view_1_1BaseView_1a21add180b32bf7dbe6c69aba19af9096" kindref="member">operations</ref>().<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1view_1_1ViewOperations_1a132e4113581dea45581d060759b7b2e9" kindref="member">current</ref>();</highlight></codeline>
<codeline lineno="494"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1ImmutableLoadViewResponse" kindref="compound">ImmutableLoadViewResponse</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1ImmutableLoadViewResponse_1a29329dda8e889e2bef1ed8b5ce14a974" kindref="member">builder</ref>()</highlight></codeline>
<codeline lineno="495"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1ImmutableLoadViewResponse_1acfd06217c41e467dd6d837563f6392a2" kindref="member">metadata</ref>(metadata)</highlight></codeline>
<codeline lineno="496"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.metadataLocation(metadata.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1view_1_1ViewMetadata_1ab51cddcfb8b3d627f667e5620384705e" kindref="member">metadataFileLocation</ref>())</highlight></codeline>
<codeline lineno="497"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.build();</highlight></codeline>
<codeline lineno="498"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="499"><highlight class="normal"></highlight></codeline>
<codeline lineno="500" refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1a86b1b7e77a8423a6bd7abf513c906e32" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1LoadViewResponse" kindref="compound">LoadViewResponse</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1a86b1b7e77a8423a6bd7abf513c906e32" kindref="member">loadView</ref>(<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1ViewCatalog" kindref="compound">ViewCatalog</ref><sp/>catalog,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1TableIdentifier" kindref="compound">TableIdentifier</ref><sp/>viewIdentifier)<sp/>{</highlight></codeline>
<codeline lineno="501"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1view_1_1View" kindref="compound">View</ref><sp/>view<sp/>=<sp/>catalog.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1ViewCatalog_1aebd35e80a34b84991717da8dfcd91c62" kindref="member">loadView</ref>(viewIdentifier);</highlight></codeline>
<codeline lineno="502"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1a91d203906e1619bfc9cc89757349adcf" kindref="member">viewResponse</ref>(view);</highlight></codeline>
<codeline lineno="503"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="504"><highlight class="normal"></highlight></codeline>
<codeline lineno="505" refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1a61f959c2908f2cc0d94f9f655da88f17" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1LoadViewResponse" kindref="compound">LoadViewResponse</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1a61f959c2908f2cc0d94f9f655da88f17" kindref="member">updateView</ref>(</highlight></codeline>
<codeline lineno="506"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1ViewCatalog" kindref="compound">ViewCatalog</ref><sp/>catalog,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1TableIdentifier" kindref="compound">TableIdentifier</ref><sp/>ident,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1UpdateTableRequest" kindref="compound">UpdateTableRequest</ref><sp/>request)<sp/>{</highlight></codeline>
<codeline lineno="507"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1view_1_1View" kindref="compound">View</ref><sp/>view<sp/>=<sp/>catalog.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1ViewCatalog_1aebd35e80a34b84991717da8dfcd91c62" kindref="member">loadView</ref>(ident);</highlight></codeline>
<codeline lineno="508"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1view_1_1ViewMetadata" kindref="compound">ViewMetadata</ref><sp/>metadata<sp/>=<sp/>commit(<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1a5b15d0a7f6d2334770836755af473c1a" kindref="member">asBaseView</ref>(view).operations(),<sp/>request);</highlight></codeline>
<codeline lineno="509"><highlight class="normal"></highlight></codeline>
<codeline lineno="510"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1ImmutableLoadViewResponse" kindref="compound">ImmutableLoadViewResponse</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1ImmutableLoadViewResponse_1a29329dda8e889e2bef1ed8b5ce14a974" kindref="member">builder</ref>()</highlight></codeline>
<codeline lineno="511"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1responses_1_1ImmutableLoadViewResponse_1acfd06217c41e467dd6d837563f6392a2" kindref="member">metadata</ref>(metadata)</highlight></codeline>
<codeline lineno="512"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.metadataLocation(metadata.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1view_1_1ViewMetadata_1ab51cddcfb8b3d627f667e5620384705e" kindref="member">metadataFileLocation</ref>())</highlight></codeline>
<codeline lineno="513"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.build();</highlight></codeline>
<codeline lineno="514"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="515"><highlight class="normal"></highlight></codeline>
<codeline lineno="516" refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1adf621715c05680c2f3bf2d3957de4a47" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1adf621715c05680c2f3bf2d3957de4a47" kindref="member">renameView</ref>(<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1ViewCatalog" kindref="compound">ViewCatalog</ref><sp/>catalog,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1RenameTableRequest" kindref="compound">RenameTableRequest</ref><sp/>request)<sp/>{</highlight></codeline>
<codeline lineno="517"><highlight class="normal"><sp/><sp/><sp/><sp/>catalog.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1ViewCatalog_1a4d6c688cf39f3900f0a1e9679647903f" kindref="member">renameView</ref>(request.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1RenameTableRequest_1aa803710bc03064d3e31542060938accd" kindref="member">source</ref>(),<sp/>request.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1RenameTableRequest_1abcfbbf8a9a8bfacea60fc77c765fc842" kindref="member">destination</ref>());</highlight></codeline>
<codeline lineno="518"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="519"><highlight class="normal"></highlight></codeline>
<codeline lineno="520" refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1aa5134a797dce0c3454ea67702fbcd609" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1CatalogHandlers_1aa5134a797dce0c3454ea67702fbcd609" kindref="member">dropView</ref>(<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1ViewCatalog" kindref="compound">ViewCatalog</ref><sp/>catalog,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1catalog_1_1TableIdentifier" kindref="compound">TableIdentifier</ref><sp/>viewIdentifier)<sp/>{</highlight></codeline>
<codeline lineno="521"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">boolean</highlight><highlight class="normal"><sp/>dropped<sp/>=<sp/>catalog.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1catalog_1_1ViewCatalog_1a807e60f868a9f3046feb7d638a2e18d6" kindref="member">dropView</ref>(viewIdentifier);</highlight></codeline>
<codeline lineno="522"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!dropped)<sp/>{</highlight></codeline>
<codeline lineno="523"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1exceptions_1_1NoSuchViewException" kindref="compound">NoSuchViewException</ref>(</highlight><highlight class="stringliteral">&quot;View<sp/>does<sp/>not<sp/>exist:<sp/>%s&quot;</highlight><highlight class="normal">,<sp/>viewIdentifier);</highlight></codeline>
<codeline lineno="524"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="525"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="526"><highlight class="normal"></highlight></codeline>
<codeline lineno="527"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1view_1_1ViewMetadata" kindref="compound">ViewMetadata</ref><sp/>commit(<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1view_1_1ViewOperations" kindref="compound">ViewOperations</ref><sp/>ops,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1UpdateTableRequest" kindref="compound">UpdateTableRequest</ref><sp/>request)<sp/>{</highlight></codeline>
<codeline lineno="528"><highlight class="normal"><sp/><sp/><sp/><sp/>AtomicBoolean<sp/>isRetry<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>AtomicBoolean(</highlight><highlight class="keyword">false</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="529"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="530"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1util_1_1Tasks" kindref="compound">Tasks</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1util_1_1Tasks_1a4e02a04c6d01b1feceec7c0b1b4fbf12" kindref="member">foreach</ref>(ops)</highlight></codeline>
<codeline lineno="531"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.retry(COMMIT_NUM_RETRIES_DEFAULT)</highlight></codeline>
<codeline lineno="532"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.exponentialBackoff(</highlight></codeline>
<codeline lineno="533"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>COMMIT_MIN_RETRY_WAIT_MS_DEFAULT,</highlight></codeline>
<codeline lineno="534"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>COMMIT_MAX_RETRY_WAIT_MS_DEFAULT,</highlight></codeline>
<codeline lineno="535"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>COMMIT_TOTAL_RETRY_TIME_MS_DEFAULT,</highlight></codeline>
<codeline lineno="536"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>2.0<sp/></highlight><highlight class="comment">/*<sp/>exponential<sp/>*/</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="537"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.onlyRetryOn(<ref refid="classorg_1_1apache_1_1iceberg_1_1exceptions_1_1CommitFailedException" kindref="compound">CommitFailedException</ref>.class)</highlight></codeline>
<codeline lineno="538"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.run(</highlight></codeline>
<codeline lineno="539"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>taskOps<sp/>-&gt;<sp/>{</highlight></codeline>
<codeline lineno="540"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1view_1_1ViewMetadata" kindref="compound">ViewMetadata</ref><sp/>base<sp/>=<sp/>isRetry.get()<sp/>?<sp/>taskOps.refresh()<sp/>:<sp/>taskOps.current();</highlight></codeline>
<codeline lineno="541"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>isRetry.set(</highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="542"><highlight class="normal"></highlight></codeline>
<codeline lineno="543"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>validate<sp/>requirements</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="544"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="545"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>request.requirements().forEach(requirement<sp/>-&gt;<sp/>requirement.validate(base));</highlight></codeline>
<codeline lineno="546"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>catch<sp/>(<ref refid="classorg_1_1apache_1_1iceberg_1_1exceptions_1_1CommitFailedException" kindref="compound">CommitFailedException</ref><sp/>e)<sp/>{</highlight></codeline>
<codeline lineno="547"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>wrap<sp/>and<sp/>rethrow<sp/>outside<sp/>of<sp/>tasks<sp/>to<sp/>avoid<sp/>unnecessary<sp/>retry</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="548"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>ValidationFailureException(e);</highlight></codeline>
<codeline lineno="549"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="550"><highlight class="normal"></highlight></codeline>
<codeline lineno="551"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>apply<sp/>changes</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="552"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1view_1_1ViewMetadata" kindref="compound">ViewMetadata</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1view_1_1ViewMetadata_1_1Builder" kindref="compound">Builder</ref><sp/>metadataBuilder<sp/>=<sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1view_1_1ViewMetadata" kindref="compound">ViewMetadata</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1view_1_1ViewMetadata_1ab02e95aff20c038070215cff9a870696" kindref="member">buildFrom</ref>(base);</highlight></codeline>
<codeline lineno="553"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>request.<ref refid="classorg_1_1apache_1_1iceberg_1_1rest_1_1requests_1_1UpdateTableRequest_1aedaa7109083ad9583c1d76c864de977a" kindref="member">updates</ref>().forEach(update<sp/>-&gt;<sp/>update.applyTo(metadataBuilder));</highlight></codeline>
<codeline lineno="554"><highlight class="normal"></highlight></codeline>
<codeline lineno="555"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1view_1_1ViewMetadata" kindref="compound">ViewMetadata</ref><sp/>updated<sp/>=<sp/>metadataBuilder.build();</highlight></codeline>
<codeline lineno="556"><highlight class="normal"></highlight></codeline>
<codeline lineno="557"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(updated.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1view_1_1ViewMetadata_1a7131b95e269998b4e72a22e22177757e" kindref="member">changes</ref>().isEmpty())<sp/>{</highlight></codeline>
<codeline lineno="558"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>do<sp/>not<sp/>commit<sp/>if<sp/>the<sp/>metadata<sp/>has<sp/>not<sp/>changed</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="559"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="560"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="561"><highlight class="normal"></highlight></codeline>
<codeline lineno="562"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>commit</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="563"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>taskOps.commit(base,<sp/>updated);</highlight></codeline>
<codeline lineno="564"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>});</highlight></codeline>
<codeline lineno="565"><highlight class="normal"></highlight></codeline>
<codeline lineno="566"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">catch</highlight><highlight class="normal"><sp/>(ValidationFailureException<sp/>e)<sp/>{</highlight></codeline>
<codeline lineno="567"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/>e.wrapped();</highlight></codeline>
<codeline lineno="568"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="569"><highlight class="normal"></highlight></codeline>
<codeline lineno="570"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ops.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1view_1_1ViewOperations_1a132e4113581dea45581d060759b7b2e9" kindref="member">current</ref>();</highlight></codeline>
<codeline lineno="571"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="572"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="core/src/main/java/org/apache/iceberg/rest/CatalogHandlers.java"/>
  </compounddef>
</doxygen>
