<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.17">
  <compounddef id="OutputFileFactory_8java" kind="file" language="Java">
    <compoundname>OutputFileFactory.java</compoundname>
    <innerclass refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory" prot="public">org::apache::iceberg::io::OutputFileFactory</innerclass>
    <innerclass refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1_1Builder" prot="public">org::apache::iceberg::io::OutputFileFactory::Builder</innerclass>
    <innernamespace refid="namespaceorg_1_1apache_1_1iceberg_1_1io">org::apache::iceberg::io</innernamespace>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">/*</highlight></codeline>
<codeline lineno="2"><highlight class="comment"><sp/>*<sp/>Licensed<sp/>to<sp/>the<sp/>Apache<sp/>Software<sp/>Foundation<sp/>(ASF)<sp/>under<sp/>one</highlight></codeline>
<codeline lineno="3"><highlight class="comment"><sp/>*<sp/>or<sp/>more<sp/>contributor<sp/>license<sp/>agreements.<sp/><sp/>See<sp/>the<sp/>NOTICE<sp/>file</highlight></codeline>
<codeline lineno="4"><highlight class="comment"><sp/>*<sp/>distributed<sp/>with<sp/>this<sp/>work<sp/>for<sp/>additional<sp/>information</highlight></codeline>
<codeline lineno="5"><highlight class="comment"><sp/>*<sp/>regarding<sp/>copyright<sp/>ownership.<sp/><sp/>The<sp/>ASF<sp/>licenses<sp/>this<sp/>file</highlight></codeline>
<codeline lineno="6"><highlight class="comment"><sp/>*<sp/>to<sp/>you<sp/>under<sp/>the<sp/>Apache<sp/>License,<sp/>Version<sp/>2.0<sp/>(the</highlight></codeline>
<codeline lineno="7"><highlight class="comment"><sp/>*<sp/>&quot;License&quot;);<sp/>you<sp/>may<sp/>not<sp/>use<sp/>this<sp/>file<sp/>except<sp/>in<sp/>compliance</highlight></codeline>
<codeline lineno="8"><highlight class="comment"><sp/>*<sp/>with<sp/>the<sp/>License.<sp/><sp/>You<sp/>may<sp/>obtain<sp/>a<sp/>copy<sp/>of<sp/>the<sp/>License<sp/>at</highlight></codeline>
<codeline lineno="9"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="10"><highlight class="comment"><sp/>*<sp/><sp/><sp/>http://www.apache.org/licenses/LICENSE-2.0</highlight></codeline>
<codeline lineno="11"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="12"><highlight class="comment"><sp/>*<sp/>Unless<sp/>required<sp/>by<sp/>applicable<sp/>law<sp/>or<sp/>agreed<sp/>to<sp/>in<sp/>writing,</highlight></codeline>
<codeline lineno="13"><highlight class="comment"><sp/>*<sp/>software<sp/>distributed<sp/>under<sp/>the<sp/>License<sp/>is<sp/>distributed<sp/>on<sp/>an</highlight></codeline>
<codeline lineno="14"><highlight class="comment"><sp/>*<sp/>&quot;AS<sp/>IS&quot;<sp/>BASIS,<sp/>WITHOUT<sp/>WARRANTIES<sp/>OR<sp/>CONDITIONS<sp/>OF<sp/>ANY</highlight></codeline>
<codeline lineno="15"><highlight class="comment"><sp/>*<sp/>KIND,<sp/>either<sp/>express<sp/>or<sp/>implied.<sp/><sp/>See<sp/>the<sp/>License<sp/>for<sp/>the</highlight></codeline>
<codeline lineno="16"><highlight class="comment"><sp/>*<sp/>specific<sp/>language<sp/>governing<sp/>permissions<sp/>and<sp/>limitations</highlight></codeline>
<codeline lineno="17"><highlight class="comment"><sp/>*<sp/>under<sp/>the<sp/>License.</highlight></codeline>
<codeline lineno="18"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="19"><highlight class="normal"></highlight><highlight class="keyword">package<sp/></highlight><highlight class="normal">org.apache.iceberg.io;</highlight></codeline>
<codeline lineno="20"><highlight class="normal"></highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1TableProperties" kindref="compound">TableProperties</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1TableProperties_1a9309ce993a4165c3caf578aa76855066" kindref="member">DEFAULT_FILE_FORMAT</ref>;</highlight></codeline>
<codeline lineno="22"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1TableProperties" kindref="compound">TableProperties</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1TableProperties_1ae63dd97a7cd2962dcd3bb35eb3ad9f0c" kindref="member">DEFAULT_FILE_FORMAT_DEFAULT</ref>;</highlight></codeline>
<codeline lineno="23"><highlight class="normal"></highlight></codeline>
<codeline lineno="24"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>java.util.UUID;</highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>java.util.concurrent.atomic.AtomicInteger;</highlight></codeline>
<codeline lineno="26"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>java.util.function.Supplier;</highlight></codeline>
<codeline lineno="27"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="enumorg_1_1apache_1_1iceberg_1_1FileFormat" kindref="compound">FileFormat</ref>;</highlight></codeline>
<codeline lineno="28"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="classorg_1_1apache_1_1iceberg_1_1PartitionSpec" kindref="compound">PartitionSpec</ref>;</highlight></codeline>
<codeline lineno="29"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1StructLike" kindref="compound">StructLike</ref>;</highlight></codeline>
<codeline lineno="30"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Table" kindref="compound">Table</ref>;</highlight></codeline>
<codeline lineno="31"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1encryption" kindref="compound">encryption</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1encryption_1_1EncryptedOutputFile" kindref="compound">EncryptedOutputFile</ref>;</highlight></codeline>
<codeline lineno="32"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespaceorg" kindref="compound">org</ref>.<ref refid="namespaceorg_1_1apache" kindref="compound">apache</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg" kindref="compound">iceberg</ref>.<ref refid="namespaceorg_1_1apache_1_1iceberg_1_1encryption" kindref="compound">encryption</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1encryption_1_1EncryptionManager" kindref="compound">EncryptionManager</ref>;</highlight></codeline>
<codeline lineno="33"><highlight class="normal"></highlight></codeline>
<codeline lineno="35" refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory" refkind="compound"><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory" kindref="compound">OutputFileFactory</ref><sp/>{</highlight></codeline>
<codeline lineno="36" refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1a8053eeafcf6763fe7125790b3370d535" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1PartitionSpec" kindref="compound">PartitionSpec</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1a8053eeafcf6763fe7125790b3370d535" kindref="member">defaultSpec</ref>;</highlight></codeline>
<codeline lineno="37" refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1a591cd2b744e3c769126fd6a1dcb26497" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/><ref refid="enumorg_1_1apache_1_1iceberg_1_1FileFormat" kindref="compound">FileFormat</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1a591cd2b744e3c769126fd6a1dcb26497" kindref="member">format</ref>;</highlight></codeline>
<codeline lineno="38" refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1adc14d2d8b6054aba95665de5edfd7de6" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1io_1_1LocationProvider" kindref="compound">LocationProvider</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1adc14d2d8b6054aba95665de5edfd7de6" kindref="member">locations</ref>;</highlight></codeline>
<codeline lineno="39" refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1a8ff3f92198f2f78207e1dd0add5257db" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/>Supplier&lt;FileIO&gt;<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1a8ff3f92198f2f78207e1dd0add5257db" kindref="member">ioSupplier</ref>;</highlight></codeline>
<codeline lineno="40" refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1a7b0da48f1165f850b870648b763ad2ee" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1encryption_1_1EncryptionManager" kindref="compound">EncryptionManager</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1a7b0da48f1165f850b870648b763ad2ee" kindref="member">encryptionManager</ref>;</highlight></codeline>
<codeline lineno="41" refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1af02f45cd1ff6d3239fe1cfe3f65a360c" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1af02f45cd1ff6d3239fe1cfe3f65a360c" kindref="member">partitionId</ref>;</highlight></codeline>
<codeline lineno="42" refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1a4c33159900991039bd1e2bc71e6b28b3" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1a4c33159900991039bd1e2bc71e6b28b3" kindref="member">taskId</ref>;</highlight></codeline>
<codeline lineno="43"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>The<sp/>purpose<sp/>of<sp/>this<sp/>uuid<sp/>is<sp/>to<sp/>be<sp/>able<sp/>to<sp/>know<sp/>from<sp/>two<sp/>paths<sp/>that<sp/>they<sp/>were<sp/>written<sp/>by<sp/>the</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="44"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>same<sp/>operation.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="45"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>That&apos;s<sp/>useful,<sp/>for<sp/>example,<sp/>if<sp/>a<sp/>Spark<sp/>job<sp/>dies<sp/>and<sp/>leaves<sp/>files<sp/>in<sp/>the<sp/>file<sp/>system,<sp/>you<sp/>can</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="46"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>identify<sp/>them<sp/>all</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="47"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>with<sp/>a<sp/>recursive<sp/>listing<sp/>and<sp/>grep.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="48" refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1a4f22e69ef97d7493be0d0a6222340890" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/>String<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1a4f22e69ef97d7493be0d0a6222340890" kindref="member">operationId</ref>;</highlight></codeline>
<codeline lineno="49" refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1a1dbb212d1d59a6ad2853f9bff59187e8" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/>AtomicInteger<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1a1dbb212d1d59a6ad2853f9bff59187e8" kindref="member">fileCount</ref><sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>AtomicInteger(0);</highlight></codeline>
<codeline lineno="50" refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1a00762d5f0699af54ddc1487076794996" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/>String<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1a00762d5f0699af54ddc1487076794996" kindref="member">suffix</ref>;</highlight></codeline>
<codeline lineno="51"><highlight class="normal"></highlight></codeline>
<codeline lineno="67" refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1a73c5bf41243b40a8fae44335a0604082" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1a73c5bf41243b40a8fae44335a0604082" kindref="member">OutputFileFactory</ref>(</highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1PartitionSpec" kindref="compound">PartitionSpec</ref><sp/>spec,</highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="enumorg_1_1apache_1_1iceberg_1_1FileFormat" kindref="compound">FileFormat</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1a591cd2b744e3c769126fd6a1dcb26497" kindref="member">format</ref>,</highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1io_1_1LocationProvider" kindref="compound">LocationProvider</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1adc14d2d8b6054aba95665de5edfd7de6" kindref="member">locations</ref>,</highlight></codeline>
<codeline lineno="71"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Supplier&lt;FileIO&gt;<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1a8ff3f92198f2f78207e1dd0add5257db" kindref="member">ioSupplier</ref>,</highlight></codeline>
<codeline lineno="72"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1encryption_1_1EncryptionManager" kindref="compound">EncryptionManager</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1a7b0da48f1165f850b870648b763ad2ee" kindref="member">encryptionManager</ref>,</highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1af02f45cd1ff6d3239fe1cfe3f65a360c" kindref="member">partitionId</ref>,</highlight></codeline>
<codeline lineno="74"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1a4c33159900991039bd1e2bc71e6b28b3" kindref="member">taskId</ref>,</highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>String<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1a4f22e69ef97d7493be0d0a6222340890" kindref="member">operationId</ref>,</highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>String<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1a00762d5f0699af54ddc1487076794996" kindref="member">suffix</ref>)<sp/>{</highlight></codeline>
<codeline lineno="77"><highlight class="normal"><sp/><sp/><sp/><sp/>this.defaultSpec<sp/>=<sp/>spec;</highlight></codeline>
<codeline lineno="78"><highlight class="normal"><sp/><sp/><sp/><sp/>this.format<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1a591cd2b744e3c769126fd6a1dcb26497" kindref="member">format</ref>;</highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/><sp/><sp/>this.locations<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1adc14d2d8b6054aba95665de5edfd7de6" kindref="member">locations</ref>;</highlight></codeline>
<codeline lineno="80"><highlight class="normal"><sp/><sp/><sp/><sp/>this.ioSupplier<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1a8ff3f92198f2f78207e1dd0add5257db" kindref="member">ioSupplier</ref>;</highlight></codeline>
<codeline lineno="81"><highlight class="normal"><sp/><sp/><sp/><sp/>this.encryptionManager<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1a7b0da48f1165f850b870648b763ad2ee" kindref="member">encryptionManager</ref>;</highlight></codeline>
<codeline lineno="82"><highlight class="normal"><sp/><sp/><sp/><sp/>this.partitionId<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1af02f45cd1ff6d3239fe1cfe3f65a360c" kindref="member">partitionId</ref>;</highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/><sp/><sp/>this.taskId<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1a4c33159900991039bd1e2bc71e6b28b3" kindref="member">taskId</ref>;</highlight></codeline>
<codeline lineno="84"><highlight class="normal"><sp/><sp/><sp/><sp/>this.operationId<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1a4f22e69ef97d7493be0d0a6222340890" kindref="member">operationId</ref>;</highlight></codeline>
<codeline lineno="85"><highlight class="normal"><sp/><sp/><sp/><sp/>this.suffix<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1a00762d5f0699af54ddc1487076794996" kindref="member">suffix</ref>;</highlight></codeline>
<codeline lineno="86"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="87"><highlight class="normal"></highlight></codeline>
<codeline lineno="88" refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1a30edfa6a8d1a201495bccba67c652274" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1_1Builder" kindref="compound">Builder</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1a30edfa6a8d1a201495bccba67c652274" kindref="member">builderFor</ref>(<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Table" kindref="compound">Table</ref><sp/>table,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1af02f45cd1ff6d3239fe1cfe3f65a360c" kindref="member">partitionId</ref>,<sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1a4c33159900991039bd1e2bc71e6b28b3" kindref="member">taskId</ref>)<sp/>{</highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1_1Builder" kindref="compound">Builder</ref>(table,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1af02f45cd1ff6d3239fe1cfe3f65a360c" kindref="member">partitionId</ref>,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1a4c33159900991039bd1e2bc71e6b28b3" kindref="member">taskId</ref>);</highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="91"><highlight class="normal"></highlight></codeline>
<codeline lineno="92" refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1a83d766bbbaccdbc98a3e13550b67f36e" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/>String<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1a83d766bbbaccdbc98a3e13550b67f36e" kindref="member">generateFilename</ref>()<sp/>{</highlight></codeline>
<codeline lineno="93"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1a591cd2b744e3c769126fd6a1dcb26497" kindref="member">format</ref>.<ref refid="enumorg_1_1apache_1_1iceberg_1_1FileFormat_1a7a2f30869c0bdb996ee12342b777692c" kindref="member">addExtension</ref>(</highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>String.format(</highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;%05d-%d-%s-%05d%s&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="96"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1af02f45cd1ff6d3239fe1cfe3f65a360c" kindref="member">partitionId</ref>,</highlight></codeline>
<codeline lineno="97"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1a4c33159900991039bd1e2bc71e6b28b3" kindref="member">taskId</ref>,</highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1a4f22e69ef97d7493be0d0a6222340890" kindref="member">operationId</ref>,</highlight></codeline>
<codeline lineno="99"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1a1dbb212d1d59a6ad2853f9bff59187e8" kindref="member">fileCount</ref>.incrementAndGet(),</highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">null</highlight><highlight class="normal"><sp/>!=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1a00762d5f0699af54ddc1487076794996" kindref="member">suffix</ref><sp/>?<sp/></highlight><highlight class="stringliteral">&quot;-&quot;</highlight><highlight class="normal"><sp/>+<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1a00762d5f0699af54ddc1487076794996" kindref="member">suffix</ref><sp/>:<sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">));</highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="102"><highlight class="normal"></highlight></codeline>
<codeline lineno="104" refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1a235171ea4c41b1170d4729f9a65705fd" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1encryption_1_1EncryptedOutputFile" kindref="compound">EncryptedOutputFile</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1a235171ea4c41b1170d4729f9a65705fd" kindref="member">newOutputFile</ref>()<sp/>{</highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1io_1_1OutputFile" kindref="compound">OutputFile</ref><sp/>file<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1a8ff3f92198f2f78207e1dd0add5257db" kindref="member">ioSupplier</ref>.get().newOutputFile(<ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1adc14d2d8b6054aba95665de5edfd7de6" kindref="member">locations</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1io_1_1LocationProvider_1aafce07edcb32a01ecfd6caad94e7141a" kindref="member">newDataLocation</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1a83d766bbbaccdbc98a3e13550b67f36e" kindref="member">generateFilename</ref>()));</highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1a7b0da48f1165f850b870648b763ad2ee" kindref="member">encryptionManager</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1encryption_1_1EncryptionManager_1a7977964f7ca95326f15e97abe0b08d29" kindref="member">encrypt</ref>(file);</highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="108"><highlight class="normal"></highlight></codeline>
<codeline lineno="110" refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1adb0f5769b5d65d6b2f282f870dcec354" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1encryption_1_1EncryptedOutputFile" kindref="compound">EncryptedOutputFile</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1adb0f5769b5d65d6b2f282f870dcec354" kindref="member">newOutputFile</ref>(<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1StructLike" kindref="compound">StructLike</ref><sp/>partition)<sp/>{</highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1a235171ea4c41b1170d4729f9a65705fd" kindref="member">newOutputFile</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1a8053eeafcf6763fe7125790b3370d535" kindref="member">defaultSpec</ref>,<sp/>partition);</highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="113"><highlight class="normal"></highlight></codeline>
<codeline lineno="115" refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1a76ff6d12a737e988f0cc380152fd8de9" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1encryption_1_1EncryptedOutputFile" kindref="compound">EncryptedOutputFile</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1a76ff6d12a737e988f0cc380152fd8de9" kindref="member">newOutputFile</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1PartitionSpec" kindref="compound">PartitionSpec</ref><sp/>spec,<sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1StructLike" kindref="compound">StructLike</ref><sp/>partition)<sp/>{</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/>String<sp/>newDataLocation<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1adc14d2d8b6054aba95665de5edfd7de6" kindref="member">locations</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1io_1_1LocationProvider_1aafce07edcb32a01ecfd6caad94e7141a" kindref="member">newDataLocation</ref>(spec,<sp/>partition,<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1a83d766bbbaccdbc98a3e13550b67f36e" kindref="member">generateFilename</ref>());</highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1io_1_1OutputFile" kindref="compound">OutputFile</ref><sp/>rawOutputFile<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1a8ff3f92198f2f78207e1dd0add5257db" kindref="member">ioSupplier</ref>.get().newOutputFile(newDataLocation);</highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1a7b0da48f1165f850b870648b763ad2ee" kindref="member">encryptionManager</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1encryption_1_1EncryptionManager_1a7977964f7ca95326f15e97abe0b08d29" kindref="member">encrypt</ref>(rawOutputFile);</highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="120"><highlight class="normal"></highlight></codeline>
<codeline lineno="121" refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1_1Builder" refkind="compound"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1_1Builder" kindref="compound">Builder</ref><sp/>{</highlight></codeline>
<codeline lineno="122" refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1_1Builder_1a44a03f5f388e84877eba7f44e0865555" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Table" kindref="compound">Table</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1_1Builder_1a44a03f5f388e84877eba7f44e0865555" kindref="member">table</ref>;</highlight></codeline>
<codeline lineno="123" refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1_1Builder_1a3e11bc6175d9e30c0db20c427a35823b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1_1Builder_1a3e11bc6175d9e30c0db20c427a35823b" kindref="member">partitionId</ref>;</highlight></codeline>
<codeline lineno="124" refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1_1Builder_1aee37c6088539b787c355bf0943891ce3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1_1Builder_1aee37c6088539b787c355bf0943891ce3" kindref="member">taskId</ref>;</highlight></codeline>
<codeline lineno="125" refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1_1Builder_1affd5f85ad8c27b089bff9a71fe5b52fc" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1PartitionSpec" kindref="compound">PartitionSpec</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1_1Builder_1affd5f85ad8c27b089bff9a71fe5b52fc" kindref="member">defaultSpec</ref>;</highlight></codeline>
<codeline lineno="126" refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1_1Builder_1ad28b57542a955f5e60c8ad8646fef664" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/>String<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1_1Builder_1ad28b57542a955f5e60c8ad8646fef664" kindref="member">operationId</ref>;</highlight></codeline>
<codeline lineno="127" refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1_1Builder_1a89196cfdde2743648b1431a5621b24da" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/><ref refid="enumorg_1_1apache_1_1iceberg_1_1FileFormat" kindref="compound">FileFormat</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1_1Builder_1a89196cfdde2743648b1431a5621b24da" kindref="member">format</ref>;</highlight></codeline>
<codeline lineno="128" refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1_1Builder_1abaeac9fddad5d7ddb415dd4d49095ba4" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/>String<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1_1Builder_1abaeac9fddad5d7ddb415dd4d49095ba4" kindref="member">suffix</ref>;</highlight></codeline>
<codeline lineno="129" refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1_1Builder_1abd62afa32eaf90aadbe24cec7f1de2a1" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/>Supplier&lt;FileIO&gt;<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1_1Builder_1abd62afa32eaf90aadbe24cec7f1de2a1" kindref="member">ioSupplier</ref>;</highlight></codeline>
<codeline lineno="130"><highlight class="normal"></highlight></codeline>
<codeline lineno="131" refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1_1Builder_1a69adfc329de494a5de722fd26860ba47" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1_1Builder_1a69adfc329de494a5de722fd26860ba47" kindref="member">Builder</ref>(<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Table" kindref="compound">Table</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1_1Builder_1a44a03f5f388e84877eba7f44e0865555" kindref="member">table</ref>,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1_1Builder_1a3e11bc6175d9e30c0db20c427a35823b" kindref="member">partitionId</ref>,<sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1_1Builder_1aee37c6088539b787c355bf0943891ce3" kindref="member">taskId</ref>)<sp/>{</highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this.table<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1_1Builder_1a44a03f5f388e84877eba7f44e0865555" kindref="member">table</ref>;</highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this.partitionId<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1_1Builder_1a3e11bc6175d9e30c0db20c427a35823b" kindref="member">partitionId</ref>;</highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this.taskId<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1_1Builder_1aee37c6088539b787c355bf0943891ce3" kindref="member">taskId</ref>;</highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this.defaultSpec<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1_1Builder_1a44a03f5f388e84877eba7f44e0865555" kindref="member">table</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Table_1a896bd81a171a850db849109694a5b9ce" kindref="member">spec</ref>();</highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this.operationId<sp/>=<sp/>UUID.randomUUID().<ref refid="classorg_1_1apache_1_1iceberg_1_1PartitionSpec_1a37faf7b7fe3b5d285171457a4c9aa30a" kindref="member">toString</ref>();</highlight></codeline>
<codeline lineno="137"><highlight class="normal"></highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>String<sp/>formatAsString<sp/>=</highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1_1Builder_1a44a03f5f388e84877eba7f44e0865555" kindref="member">table</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Table_1a6dc0d000ddb7a7285fc7fdc6383922d5" kindref="member">properties</ref>().getOrDefault(DEFAULT_FILE_FORMAT,<sp/>DEFAULT_FILE_FORMAT_DEFAULT);</highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this.format<sp/>=<sp/><ref refid="enumorg_1_1apache_1_1iceberg_1_1FileFormat" kindref="compound">FileFormat</ref>.<ref refid="enumorg_1_1apache_1_1iceberg_1_1FileFormat_1a67504493c54c015bf2a44db5df36b5e4" kindref="member">fromString</ref>(formatAsString);</highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this.ioSupplier<sp/>=<sp/>table::io;</highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="143"><highlight class="normal"></highlight></codeline>
<codeline lineno="144" refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1_1Builder_1ab59228fceea3803918a22a2f1c1e1f69" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1_1Builder" kindref="compound">Builder</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1_1Builder_1ab59228fceea3803918a22a2f1c1e1f69" kindref="member">defaultSpec</ref>(<ref refid="classorg_1_1apache_1_1iceberg_1_1PartitionSpec" kindref="compound">PartitionSpec</ref><sp/>newDefaultSpec)<sp/>{</highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this.defaultSpec<sp/>=<sp/>newDefaultSpec;</highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">this</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="148"><highlight class="normal"></highlight></codeline>
<codeline lineno="149" refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1_1Builder_1a11eaa7f0e5e6121121b74a91643a930e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1_1Builder" kindref="compound">Builder</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1_1Builder_1a11eaa7f0e5e6121121b74a91643a930e" kindref="member">operationId</ref>(String<sp/>newOperationId)<sp/>{</highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this.operationId<sp/>=<sp/>newOperationId;</highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">this</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="153"><highlight class="normal"></highlight></codeline>
<codeline lineno="154" refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1_1Builder_1a61e21047e4bff2414817d2fd882d6340" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1_1Builder" kindref="compound">Builder</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1_1Builder_1a61e21047e4bff2414817d2fd882d6340" kindref="member">format</ref>(<ref refid="enumorg_1_1apache_1_1iceberg_1_1FileFormat" kindref="compound">FileFormat</ref><sp/>newFormat)<sp/>{</highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this.format<sp/>=<sp/>newFormat;</highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">this</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="158"><highlight class="normal"></highlight></codeline>
<codeline lineno="159" refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1_1Builder_1a8ac5493c450fb0c87029187e677e3ca4" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1_1Builder" kindref="compound">Builder</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1_1Builder_1a8ac5493c450fb0c87029187e677e3ca4" kindref="member">suffix</ref>(String<sp/>newSuffix)<sp/>{</highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this.suffix<sp/>=<sp/>newSuffix;</highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">this</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="163"><highlight class="normal"></highlight></codeline>
<codeline lineno="171" refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1_1Builder_1a8b2eedef2509d6b802753cda458ac363" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1_1Builder" kindref="compound">Builder</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1_1Builder_1a8b2eedef2509d6b802753cda458ac363" kindref="member">ioSupplier</ref>(Supplier&lt;FileIO&gt;<sp/>newIoSupplier)<sp/>{</highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this.ioSupplier<sp/>=<sp/>newIoSupplier;</highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">this</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="175"><highlight class="normal"></highlight></codeline>
<codeline lineno="176" refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1_1Builder_1af8c14afa6a7a3cd67c858789cb414de1" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory" kindref="compound">OutputFileFactory</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1_1Builder_1af8c14afa6a7a3cd67c858789cb414de1" kindref="member">build</ref>()<sp/>{</highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1io_1_1LocationProvider" kindref="compound">LocationProvider</ref><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1adc14d2d8b6054aba95665de5edfd7de6" kindref="member">locations</ref><sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1_1Builder_1a44a03f5f388e84877eba7f44e0865555" kindref="member">table</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Table_1a656729fd107184ca0c1d04f81374375b" kindref="member">locationProvider</ref>();</highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="interfaceorg_1_1apache_1_1iceberg_1_1encryption_1_1EncryptionManager" kindref="compound">EncryptionManager</ref><sp/>encryption<sp/>=<sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1_1Builder_1a44a03f5f388e84877eba7f44e0865555" kindref="member">table</ref>.<ref refid="interfaceorg_1_1apache_1_1iceberg_1_1Table_1aa936700e5d6aade74f96c4cf2ad67948" kindref="member">encryption</ref>();</highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1a73c5bf41243b40a8fae44335a0604082" kindref="member">OutputFileFactory</ref>(</highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1_1Builder_1affd5f85ad8c27b089bff9a71fe5b52fc" kindref="member">defaultSpec</ref>,</highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1_1Builder_1a89196cfdde2743648b1431a5621b24da" kindref="member">format</ref>,</highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1adc14d2d8b6054aba95665de5edfd7de6" kindref="member">locations</ref>,</highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1_1Builder_1abd62afa32eaf90aadbe24cec7f1de2a1" kindref="member">ioSupplier</ref>,</highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>encryption,</highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1_1Builder_1a3e11bc6175d9e30c0db20c427a35823b" kindref="member">partitionId</ref>,</highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1_1Builder_1aee37c6088539b787c355bf0943891ce3" kindref="member">taskId</ref>,</highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1_1Builder_1ad28b57542a955f5e60c8ad8646fef664" kindref="member">operationId</ref>,</highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classorg_1_1apache_1_1iceberg_1_1io_1_1OutputFileFactory_1_1Builder_1abaeac9fddad5d7ddb415dd4d49095ba4" kindref="member">suffix</ref>);</highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="191"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="core/src/main/java/org/apache/iceberg/io/OutputFileFactory.java"/>
  </compounddef>
</doxygen>
