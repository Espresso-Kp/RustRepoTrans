Fail
file path is :
projects/deltachat-core/rust/src/securejoin.rs

output is:


error is :
   Compiling deltachat v1.139.6 (/home/k/ogs_PHD/LLM4SE/2Rust_projects/auto_get_functionPair/projects/deltachat-core/rust)
error: expected one of `)`, `,`, `.`, `?`, or an operator, found `"vg-request-with-auth"`
   --> src/securejoin.rs:247:63
    |
247 |         send_handshake_msg(context, contact_chat_id, join_vg? "vg-request-with-auth" : "vc-request-with-auth",
    |                                                              -^^^^^^^^^^^^^^^^^^^^^^ expected one of `)`, `,`, `.`, `?`, or an operator
    |                                                              |
    |                                                              help: missing `,`

error: expected one of `)`, `,`, `.`, `?`, or an operator, found `:`
   --> src/securejoin.rs:247:86
    |
247 |         send_handshake_msg(context, contact_chat_id, join_vg? "vg-request-with-auth" : "vc-request-with-auth",
    |                                                                                      ^ expected one of `)`, `,`, `.`, `?`, or an operator

error: expected one of `)`, `,`, `.`, `?`, or an operator, found `"vg-request"`
   --> src/securejoin.rs:252:63
    |
252 |         send_handshake_msg(context, contact_chat_id, join_vg? "vg-request" : "vc-request",
    |                                                              -^^^^^^^^^^^^ expected one of `)`, `,`, `.`, `?`, or an operator
    |                                                              |
    |                                                              help: missing `,`

error: expected one of `)`, `,`, `.`, `?`, or an operator, found `:`
   --> src/securejoin.rs:252:76
    |
252 |         send_handshake_msg(context, contact_chat_id, join_vg? "vg-request" : "vc-request",
    |                                                                            ^ expected one of `)`, `,`, `.`, `?`, or an operator

error[E0252]: the name `stock_str` is defined multiple times
  --> src/securejoin.rs:28:5
   |
5  | use crate::stock_str::{self, chat_id_2_contact_id};
   |                        ---- previous import of the module `stock_str` here
...
28 | use crate::stock_str;
   |     ^^^^^^^^^^^^^^^^ `stock_str` reimported here
   |
   = note: `stock_str` must be defined only once in the type namespace of this module

error[E0252]: the name `ChatId` is defined multiple times
  --> src/securejoin.rs:12:31
   |
4  | use crate::chat::{ChatId, ProtectionStatus};
   |                   ------ previous import of the type `ChatId` here
...
12 | use crate::chat::{self, Chat, ChatId, ChatIdBlocked, ProtectionStatus};
   |                               ^^^^^^--
   |                               |
   |                               `ChatId` reimported here
   |                               help: remove unnecessary import
   |
   = note: `ChatId` must be defined only once in the type namespace of this module

error[E0252]: the name `ProtectionStatus` is defined multiple times
  --> src/securejoin.rs:12:54
   |
4  | use crate::chat::{ChatId, ProtectionStatus};
   |                           ---------------- previous import of the type `ProtectionStatus` here
...
12 | use crate::chat::{self, Chat, ChatId, ChatIdBlocked, ProtectionStatus};
   |                                                      ^^^^^^^^^^^^^^^^ `ProtectionStatus` reimported here
   |
   = note: `ProtectionStatus` must be defined only once in the type namespace of this module

error[E0432]: unresolved import `crate::stock_str::chat_id_2_contact_id`
 --> src/securejoin.rs:5:30
  |
5 | use crate::stock_str::{self, chat_id_2_contact_id};
  |                              ^^^^^^^^^^^^^^^^^^^^ no `chat_id_2_contact_id` in `stock_str`

error[E0425]: cannot find value `DC_QR_ASK_VERIFYCONTACT` in this scope
   --> src/securejoin.rs:223:64
    |
223 |     if qr_scan.is_none() || qr_scan.as_ref().unwrap().state != DC_QR_ASK_VERIFYCONTACT && qr_scan.as_ref().unwrap().state != DC_QR_ASK_VE...
    |                                                                ^^^^^^^^^^^^^^^^^^^^^^^ not found in this scope

error[E0425]: cannot find value `DC_QR_ASK_VERIFYGROUP` in this scope
   --> src/securejoin.rs:223:126
    |
223 | ...NTACT && qr_scan.as_ref().unwrap().state != DC_QR_ASK_VERIFYGROUP {
    |                                                ^^^^^^^^^^^^^^^^^^^^^ not found in this scope

error[E0425]: cannot find value `DC_QR_ASK_VERIFYGROUP` in this scope
   --> src/securejoin.rs:235:50
    |
235 |     join_vg = qr_scan.as_ref().unwrap().state == DC_QR_ASK_VERIFYGROUP;
    |                                                  ^^^^^^^^^^^^^^^^^^^^^ not found in this scope

error[E0425]: cannot find value `DC_VC_CONTACT_CONFIRM` in this scope
   --> src/securejoin.rs:244:51
    |
244 |         context.inner.write().await.bob_expects = DC_VC_CONTACT_CONFIRM;
    |                                                   ^^^^^^^^^^^^^^^^^^^^^ not found in this scope

error[E0425]: cannot find value `DC_EVENT_SECUREJOIN_JOINER_PROGRESS` in this scope
   --> src/securejoin.rs:245:29
    |
245 |         context.cb(context, DC_EVENT_SECUREJOIN_JOINER_PROGRESS, chat_id_2_contact_id(context, contact_chat_id), 400).await;
    |                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ not found in this scope

error[E0425]: cannot find function `free` in this scope
   --> src/securejoin.rs:249:9
    |
249 |         free(own_fingerprint);
    |         ^^^^ not found in this scope
    |
help: consider importing this function
    |
4   + use libc::free;
    |

error[E0425]: cannot find value `DC_VC_AUTH_REQUIRED` in this scope
   --> src/securejoin.rs:251:51
    |
251 |         context.inner.write().await.bob_expects = DC_VC_AUTH_REQUIRED;
    |                                                   ^^^^^^^^^^^^^^^^^^^ not found in this scope

error[E0433]: failed to resolve: use of undeclared type `Duration`
   --> src/securejoin.rs:259:28
    |
259 |         tokio::time::sleep(Duration::from_millis(300)).await; // 0.3 seconds
    |                            ^^^^^^^^ use of undeclared type `Duration`
    |
help: consider importing one of these items
    |
4   + use chrono::Duration;
    |
4   + use core::time::Duration;
    |
4   + use std::time::Duration;
    |
4   + use tokio::time::Duration;
    |

warning: unused import: `std::sync::Arc`
 --> src/securejoin.rs:6:5
  |
6 | use std::sync::Arc;
  |     ^^^^^^^^^^^^^^
  |
note: the lint level is defined here
 --> src/lib.rs:6:5
  |
6 |     unused,
  |     ^^^^^^
  = note: `#[warn(unused_imports)]` implied by `#[warn(unused)]`

warning: unused imports: `ChatId`, `ProtectionStatus`
  --> src/securejoin.rs:12:31
   |
12 | use crate::chat::{self, Chat, ChatId, ChatIdBlocked, ProtectionStatus};
   |                               ^^^^^^                 ^^^^^^^^^^^^^^^^

warning: unused import: `crate::stock_str`
  --> src/securejoin.rs:28:5
   |
28 | use crate::stock_str;
   |     ^^^^^^^^^^^^^^^^

error[E0425]: cannot find function `dc_alloc_ongoing` in this scope
   --> src/securejoin.rs:219:8
    |
219 |     if dc_alloc_ongoing(context).await? == 0 {
    |        ^^^^^^^^^^^^^^^^ not found in this scope

error[E0599]: no method named `write` found for struct `Arc<InnerContext>` in the current scope
   --> src/securejoin.rs:201:27
    |
201 |             context.inner.write().await.bob_expects = 0;
    |                           ^^^^^ method not found in `Arc<InnerContext>`
...
220 |         goto_cleanup!();
    |         --------------- in this macro invocation
    |
    = help: items from traits can only be used if the trait is implemented and in scope
    = note: the following traits define an item `write`, perhaps you need to implement one of them:
            candidate #1: `std::io::Write`
            candidate #2: `std::hash::Hasher`
            candidate #3: `tokio::io::AsyncWriteExt`
            candidate #4: `futures::AsyncWriteExt`
            candidate #5: `futures_lite::AsyncWriteExt`
            candidate #6: `der::writer::Writer`
            candidate #7: `embedded_io::blocking::Write`
            candidate #8: `quinn_proto::coding::BufMutExt`
            candidate #9: `der::writer::Writer`
            candidate #10: `itoa::private::Sealed`
            candidate #11: `ssh_encoding::writer::Writer`
            candidate #12: `dtoa::private::Sealed`
            candidate #13: `ssh_encoding::writer::Writer`
            candidate #14: `futures_lite::io::AsyncWriteExt`
            candidate #15: `iroh_quinn_proto::coding::BufMutExt`
            candidate #16: `attohttpc::request::body::Body`
            candidate #17: `CustomWrite`
    = note: this error originates in the macro `cleanup` which comes from the expansion of the macro `goto_cleanup` (in Nightly builds, run with -Z macro-backtrace for more info)

error[E0599]: no method named `write` found for struct `Arc<InnerContext>` in the current scope
   --> src/securejoin.rs:179:31
    |
179 |                 context.inner.write().await.qr_lock.unlock().await;
    |                               ^^^^^ method not found in `Arc<InnerContext>`
...
220 |         goto_cleanup!();
    |         --------------- in this macro invocation
    |
    = help: items from traits can only be used if the trait is implemented and in scope
    = note: the following traits define an item `write`, perhaps you need to implement one of them:
            candidate #1: `std::io::Write`
            candidate #2: `std::hash::Hasher`
            candidate #3: `tokio::io::AsyncWriteExt`
            candidate #4: `futures::AsyncWriteExt`
            candidate #5: `futures_lite::AsyncWriteExt`
            candidate #6: `der::writer::Writer`
            candidate #7: `embedded_io::blocking::Write`
            candidate #8: `quinn_proto::coding::BufMutExt`
            candidate #9: `der::writer::Writer`
            candidate #10: `itoa::private::Sealed`
            candidate #11: `ssh_encoding::writer::Writer`
            candidate #12: `dtoa::private::Sealed`
            candidate #13: `ssh_encoding::writer::Writer`
            candidate #14: `futures_lite::io::AsyncWriteExt`
            candidate #15: `iroh_quinn_proto::coding::BufMutExt`
            candidate #16: `attohttpc::request::body::Body`
            candidate #17: `CustomWrite`
    = note: this error originates in the macro `unlock_qr` which comes from the expansion of the macro `goto_cleanup` (in Nightly builds, run with -Z macro-backtrace for more info)

error[E0609]: no field `state` on type `&_`
   --> src/securejoin.rs:223:55
    |
223 |     if qr_scan.is_none() || qr_scan.as_ref().unwrap().state != DC_QR_ASK_VERIFYCONTACT && qr_scan.as_ref().unwrap().state != DC_QR_ASK_VE...
    |                                                       ^^^^^ unknown field

error[E0599]: no method named `write` found for struct `Arc<InnerContext>` in the current scope
   --> src/securejoin.rs:201:27
    |
201 |             context.inner.write().await.bob_expects = 0;
    |                           ^^^^^ method not found in `Arc<InnerContext>`
...
225 |         goto_cleanup!();
    |         --------------- in this macro invocation
    |
    = help: items from traits can only be used if the trait is implemented and in scope
    = note: the following traits define an item `write`, perhaps you need to implement one of them:
            candidate #1: `std::io::Write`
            candidate #2: `std::hash::Hasher`
            candidate #3: `tokio::io::AsyncWriteExt`
            candidate #4: `futures::AsyncWriteExt`
            candidate #5: `futures_lite::AsyncWriteExt`
            candidate #6: `der::writer::Writer`
            candidate #7: `embedded_io::blocking::Write`
            candidate #8: `quinn_proto::coding::BufMutExt`
            candidate #9: `der::writer::Writer`
            candidate #10: `itoa::private::Sealed`
            candidate #11: `ssh_encoding::writer::Writer`
            candidate #12: `dtoa::private::Sealed`
            candidate #13: `ssh_encoding::writer::Writer`
            candidate #14: `futures_lite::io::AsyncWriteExt`
            candidate #15: `iroh_quinn_proto::coding::BufMutExt`
            candidate #16: `attohttpc::request::body::Body`
            candidate #17: `CustomWrite`
    = note: this error originates in the macro `cleanup` which comes from the expansion of the macro `goto_cleanup` (in Nightly builds, run with -Z macro-backtrace for more info)

error[E0599]: no method named `write` found for struct `Arc<InnerContext>` in the current scope
   --> src/securejoin.rs:179:31
    |
179 |                 context.inner.write().await.qr_lock.unlock().await;
    |                               ^^^^^ method not found in `Arc<InnerContext>`
...
225 |         goto_cleanup!();
    |         --------------- in this macro invocation
    |
    = help: items from traits can only be used if the trait is implemented and in scope
    = note: the following traits define an item `write`, perhaps you need to implement one of them:
            candidate #1: `std::io::Write`
            candidate #2: `std::hash::Hasher`
            candidate #3: `tokio::io::AsyncWriteExt`
            candidate #4: `futures::AsyncWriteExt`
            candidate #5: `futures_lite::AsyncWriteExt`
            candidate #6: `der::writer::Writer`
            candidate #7: `embedded_io::blocking::Write`
            candidate #8: `quinn_proto::coding::BufMutExt`
            candidate #9: `der::writer::Writer`
            candidate #10: `itoa::private::Sealed`
            candidate #11: `ssh_encoding::writer::Writer`
            candidate #12: `dtoa::private::Sealed`
            candidate #13: `ssh_encoding::writer::Writer`
            candidate #14: `futures_lite::io::AsyncWriteExt`
            candidate #15: `iroh_quinn_proto::coding::BufMutExt`
            candidate #16: `attohttpc::request::body::Body`
            candidate #17: `CustomWrite`
    = note: this error originates in the macro `unlock_qr` which comes from the expansion of the macro `goto_cleanup` (in Nightly builds, run with -Z macro-backtrace for more info)

error[E0599]: no method named `write` found for struct `Arc<InnerContext>` in the current scope
   --> src/securejoin.rs:201:27
    |
201 |             context.inner.write().await.bob_expects = 0;
    |                           ^^^^^ method not found in `Arc<InnerContext>`
...
230 |         goto_cleanup!();
    |         --------------- in this macro invocation
    |
    = help: items from traits can only be used if the trait is implemented and in scope
    = note: the following traits define an item `write`, perhaps you need to implement one of them:
            candidate #1: `std::io::Write`
            candidate #2: `std::hash::Hasher`
            candidate #3: `tokio::io::AsyncWriteExt`
            candidate #4: `futures::AsyncWriteExt`
            candidate #5: `futures_lite::AsyncWriteExt`
            candidate #6: `der::writer::Writer`
            candidate #7: `embedded_io::blocking::Write`
            candidate #8: `quinn_proto::coding::BufMutExt`
            candidate #9: `der::writer::Writer`
            candidate #10: `itoa::private::Sealed`
            candidate #11: `ssh_encoding::writer::Writer`
            candidate #12: `dtoa::private::Sealed`
            candidate #13: `ssh_encoding::writer::Writer`
            candidate #14: `futures_lite::io::AsyncWriteExt`
            candidate #15: `iroh_quinn_proto::coding::BufMutExt`
            candidate #16: `attohttpc::request::body::Body`
            candidate #17: `CustomWrite`
    = note: this error originates in the macro `cleanup` which comes from the expansion of the macro `goto_cleanup` (in Nightly builds, run with -Z macro-backtrace for more info)

error[E0599]: no method named `write` found for struct `Arc<InnerContext>` in the current scope
   --> src/securejoin.rs:179:31
    |
179 |                 context.inner.write().await.qr_lock.unlock().await;
    |                               ^^^^^ method not found in `Arc<InnerContext>`
...
230 |         goto_cleanup!();
    |         --------------- in this macro invocation
    |
    = help: items from traits can only be used if the trait is implemented and in scope
    = note: the following traits define an item `write`, perhaps you need to implement one of them:
            candidate #1: `std::io::Write`
            candidate #2: `std::hash::Hasher`
            candidate #3: `tokio::io::AsyncWriteExt`
            candidate #4: `futures::AsyncWriteExt`
            candidate #5: `futures_lite::AsyncWriteExt`
            candidate #6: `der::writer::Writer`
            candidate #7: `embedded_io::blocking::Write`
            candidate #8: `quinn_proto::coding::BufMutExt`
            candidate #9: `der::writer::Writer`
            candidate #10: `itoa::private::Sealed`
            candidate #11: `ssh_encoding::writer::Writer`
            candidate #12: `dtoa::private::Sealed`
            candidate #13: `ssh_encoding::writer::Writer`
            candidate #14: `futures_lite::io::AsyncWriteExt`
            candidate #15: `iroh_quinn_proto::coding::BufMutExt`
            candidate #16: `attohttpc::request::body::Body`
            candidate #17: `CustomWrite`
    = note: this error originates in the macro `unlock_qr` which comes from the expansion of the macro `goto_cleanup` (in Nightly builds, run with -Z macro-backtrace for more info)

error[E0599]: no method named `read` found for struct `Arc<InnerContext>` in the current scope
   --> src/securejoin.rs:187:30
    |
187 |             if context.inner.read().await.shall_stop_ongoing {
    |                              ^^^^ method not found in `Arc<InnerContext>`
...
233 |     check_exit!();
    |     ------------- in this macro invocation
    |
    = help: items from traits can only be used if the trait is implemented and in scope
    = note: the following traits define an item `read`, perhaps you need to implement one of them:
            candidate #1: `std::io::Read`
            candidate #2: `tokio::io::AsyncReadExt`
            candidate #3: `futures::AsyncReadExt`
            candidate #4: `futures_lite::AsyncReadExt`
            candidate #5: `XofReader`
            candidate #6: `iter_read::IterReadItem`
            candidate #7: `embedded_io::blocking::Read`
            candidate #8: `rustls::msgs::codec::Codec`
            candidate #9: `digest::xof::XofReader`
            candidate #10: `ssh_encoding::reader::Reader`
            candidate #11: `BinDecodable`
            candidate #12: `rustls::msgs::codec::Codec`
            candidate #13: `ssh_encoding::reader::Reader`
            candidate #14: `futures_lite::io::AsyncReadExt`
            candidate #15: `CustomRead`
            candidate #16: `object::ReadRef`
    = note: this error originates in the macro `check_exit` (in Nightly builds, run with -Z macro-backtrace for more info)

error[E0599]: no method named `write` found for struct `Arc<InnerContext>` in the current scope
   --> src/securejoin.rs:201:27
    |
201 |             context.inner.write().await.bob_expects = 0;
    |                           ^^^^^ method not found in `Arc<InnerContext>`
...
233 |     check_exit!();
    |     ------------- in this macro invocation
    |
    = help: items from traits can only be used if the trait is implemented and in scope
    = note: the following traits define an item `write`, perhaps you need to implement one of them:
            candidate #1: `std::io::Write`
            candidate #2: `std::hash::Hasher`
            candidate #3: `tokio::io::AsyncWriteExt`
            candidate #4: `futures::AsyncWriteExt`
            candidate #5: `futures_lite::AsyncWriteExt`
            candidate #6: `der::writer::Writer`
            candidate #7: `embedded_io::blocking::Write`
            candidate #8: `quinn_proto::coding::BufMutExt`
            candidate #9: `der::writer::Writer`
            candidate #10: `itoa::private::Sealed`
            candidate #11: `ssh_encoding::writer::Writer`
            candidate #12: `dtoa::private::Sealed`
            candidate #13: `ssh_encoding::writer::Writer`
            candidate #14: `futures_lite::io::AsyncWriteExt`
            candidate #15: `iroh_quinn_proto::coding::BufMutExt`
            candidate #16: `attohttpc::request::body::Body`
            candidate #17: `CustomWrite`
    = note: this error originates in the macro `cleanup` which comes from the expansion of the macro `check_exit` (in Nightly builds, run with -Z macro-backtrace for more info)

error[E0599]: no method named `write` found for struct `Arc<InnerContext>` in the current scope
   --> src/securejoin.rs:179:31
    |
179 |                 context.inner.write().await.qr_lock.unlock().await;
    |                               ^^^^^ method not found in `Arc<InnerContext>`
...
233 |     check_exit!();
    |     ------------- in this macro invocation
    |
    = help: items from traits can only be used if the trait is implemented and in scope
    = note: the following traits define an item `write`, perhaps you need to implement one of them:
            candidate #1: `std::io::Write`
            candidate #2: `std::hash::Hasher`
            candidate #3: `tokio::io::AsyncWriteExt`
            candidate #4: `futures::AsyncWriteExt`
            candidate #5: `futures_lite::AsyncWriteExt`
            candidate #6: `der::writer::Writer`
            candidate #7: `embedded_io::blocking::Write`
            candidate #8: `quinn_proto::coding::BufMutExt`
            candidate #9: `der::writer::Writer`
            candidate #10: `itoa::private::Sealed`
            candidate #11: `ssh_encoding::writer::Writer`
            candidate #12: `dtoa::private::Sealed`
            candidate #13: `ssh_encoding::writer::Writer`
            candidate #14: `futures_lite::io::AsyncWriteExt`
            candidate #15: `iroh_quinn_proto::coding::BufMutExt`
            candidate #16: `attohttpc::request::body::Body`
            candidate #17: `CustomWrite`
    = note: this error originates in the macro `unlock_qr` which comes from the expansion of the macro `check_exit` (in Nightly builds, run with -Z macro-backtrace for more info)

error[E0308]: mismatched types
   --> src/securejoin.rs:235:15
    |
162 |     let join_vg = 0;
    |                   - expected due to this value
...
235 |     join_vg = qr_scan.as_ref().unwrap().state == DC_QR_ASK_VERIFYGROUP;
    |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ expected integer, found `bool`

error[E0599]: no method named `write` found for struct `Arc<InnerContext>` in the current scope
   --> src/securejoin.rs:170:31
    |
170 |                 context.inner.write().await.qr_lock.lock().await;
    |                               ^^^^^ method not found in `Arc<InnerContext>`
...
237 |     lock_qr!();
    |     ---------- in this macro invocation
    |
    = help: items from traits can only be used if the trait is implemented and in scope
    = note: the following traits define an item `write`, perhaps you need to implement one of them:
            candidate #1: `std::io::Write`
            candidate #2: `std::hash::Hasher`
            candidate #3: `tokio::io::AsyncWriteExt`
            candidate #4: `futures::AsyncWriteExt`
            candidate #5: `futures_lite::AsyncWriteExt`
            candidate #6: `der::writer::Writer`
            candidate #7: `embedded_io::blocking::Write`
            candidate #8: `quinn_proto::coding::BufMutExt`
            candidate #9: `der::writer::Writer`
            candidate #10: `itoa::private::Sealed`
            candidate #11: `ssh_encoding::writer::Writer`
            candidate #12: `dtoa::private::Sealed`
            candidate #13: `ssh_encoding::writer::Writer`
            candidate #14: `futures_lite::io::AsyncWriteExt`
            candidate #15: `iroh_quinn_proto::coding::BufMutExt`
            candidate #16: `attohttpc::request::body::Body`
            candidate #17: `CustomWrite`
    = note: this error originates in the macro `lock_qr` (in Nightly builds, run with -Z macro-backtrace for more info)

error[E0599]: no method named `write` found for struct `Arc<InnerContext>` in the current scope
   --> src/securejoin.rs:238:19
    |
238 |     context.inner.write().await.bobs_qr_scan = qr_scan.clone();
    |                   ^^^^^ method not found in `Arc<InnerContext>`
    |
    = help: items from traits can only be used if the trait is implemented and in scope
    = note: the following traits define an item `write`, perhaps you need to implement one of them:
            candidate #1: `std::io::Write`
            candidate #2: `std::hash::Hasher`
            candidate #3: `tokio::io::AsyncWriteExt`
            candidate #4: `futures::AsyncWriteExt`
            candidate #5: `futures_lite::AsyncWriteExt`
            candidate #6: `der::writer::Writer`
            candidate #7: `embedded_io::blocking::Write`
            candidate #8: `quinn_proto::coding::BufMutExt`
            candidate #9: `der::writer::Writer`
            candidate #10: `itoa::private::Sealed`
            candidate #11: `ssh_encoding::writer::Writer`
            candidate #12: `dtoa::private::Sealed`
            candidate #13: `ssh_encoding::writer::Writer`
            candidate #14: `futures_lite::io::AsyncWriteExt`
            candidate #15: `iroh_quinn_proto::coding::BufMutExt`
            candidate #16: `attohttpc::request::body::Body`
            candidate #17: `CustomWrite`
help: some of the expressions' fields have a method of the same name
    |
238 |     context.inner.debug_logging.write().await.bobs_qr_scan = qr_scan.clone();
    |                   ++++++++++++++
238 |     context.inner.last_error.write().await.bobs_qr_scan = qr_scan.clone();
    |                   +++++++++++
238 |     context.inner.metadata.write().await.bobs_qr_scan = qr_scan.clone();
    |                   +++++++++
238 |     context.inner.quota.write().await.bobs_qr_scan = qr_scan.clone();
    |                   ++++++
      and 3 other candidates

error[E0599]: no method named `write` found for struct `Arc<InnerContext>` in the current scope
   --> src/securejoin.rs:179:31
    |
179 |                 context.inner.write().await.qr_lock.unlock().await;
    |                               ^^^^^ method not found in `Arc<InnerContext>`
...
239 |     unlock_qr!();
    |     ------------ in this macro invocation
    |
    = help: items from traits can only be used if the trait is implemented and in scope
    = note: the following traits define an item `write`, perhaps you need to implement one of them:
            candidate #1: `std::io::Write`
            candidate #2: `std::hash::Hasher`
            candidate #3: `tokio::io::AsyncWriteExt`
            candidate #4: `futures::AsyncWriteExt`
            candidate #5: `futures_lite::AsyncWriteExt`
            candidate #6: `der::writer::Writer`
            candidate #7: `embedded_io::blocking::Write`
            candidate #8: `quinn_proto::coding::BufMutExt`
            candidate #9: `der::writer::Writer`
            candidate #10: `itoa::private::Sealed`
            candidate #11: `ssh_encoding::writer::Writer`
            candidate #12: `dtoa::private::Sealed`
            candidate #13: `ssh_encoding::writer::Writer`
            candidate #14: `futures_lite::io::AsyncWriteExt`
            candidate #15: `iroh_quinn_proto::coding::BufMutExt`
            candidate #16: `attohttpc::request::body::Body`
            candidate #17: `CustomWrite`
    = note: this error originates in the macro `unlock_qr` (in Nightly builds, run with -Z macro-backtrace for more info)

error[E0425]: cannot find function `fingerprint_equals_sender` in this scope
   --> src/securejoin.rs:241:8
    |
241 |     if fingerprint_equals_sender(context, qr_scan.as_ref().unwrap().fingerprint.clone(), contact_chat_id).await? {
    |        ^^^^^^^^^^^^^^^^^^^^^^^^^ not found in this scope

error[E0599]: no method named `write` found for struct `Arc<InnerContext>` in the current scope
   --> src/securejoin.rs:244:23
    |
244 |         context.inner.write().await.bob_expects = DC_VC_CONTACT_CONFIRM;
    |                       ^^^^^ method not found in `Arc<InnerContext>`
    |
    = help: items from traits can only be used if the trait is implemented and in scope
    = note: the following traits define an item `write`, perhaps you need to implement one of them:
            candidate #1: `std::io::Write`
            candidate #2: `std::hash::Hasher`
            candidate #3: `tokio::io::AsyncWriteExt`
            candidate #4: `futures::AsyncWriteExt`
            candidate #5: `futures_lite::AsyncWriteExt`
            candidate #6: `der::writer::Writer`
            candidate #7: `embedded_io::blocking::Write`
            candidate #8: `quinn_proto::coding::BufMutExt`
            candidate #9: `der::writer::Writer`
            candidate #10: `itoa::private::Sealed`
            candidate #11: `ssh_encoding::writer::Writer`
            candidate #12: `dtoa::private::Sealed`
            candidate #13: `ssh_encoding::writer::Writer`
            candidate #14: `futures_lite::io::AsyncWriteExt`
            candidate #15: `iroh_quinn_proto::coding::BufMutExt`
            candidate #16: `attohttpc::request::body::Body`
            candidate #17: `CustomWrite`
help: some of the expressions' fields have a method of the same name
    |
244 |         context.inner.debug_logging.write().await.bob_expects = DC_VC_CONTACT_CONFIRM;
    |                       ++++++++++++++
244 |         context.inner.last_error.write().await.bob_expects = DC_VC_CONTACT_CONFIRM;
    |                       +++++++++++
244 |         context.inner.metadata.write().await.bob_expects = DC_VC_CONTACT_CONFIRM;
    |                       +++++++++
244 |         context.inner.quota.write().await.bob_expects = DC_VC_CONTACT_CONFIRM;
    |                       ++++++
      and 3 other candidates

error[E0599]: no method named `cb` found for reference `&context::Context` in the current scope
   --> src/securejoin.rs:245:17
    |
245 |         context.cb(context, DC_EVENT_SECUREJOIN_JOINER_PROGRESS, chat_id_2_contact_id(context, contact_chat_id), 400).await;
    |                 ^^ method not found in `&Context`

error[E0277]: the `?` operator can only be used on `Result`s, not `Option`s, in an async function that returns `Result`
   --> src/securejoin.rs:246:66
    |
153 |   pub async fn join_securejoin(context: &Context, qr: &str) -> Result<ChatId> {
    |  _____________________________________________________________________________-
154 | |     /* ==========================================================
155 | |        ====             Bob - the joiner's side             =====
156 | |        ====   Step 2 in "Setup verified contact" protocol   =====
...   |
246 | |         let own_fingerprint = get_self_fingerprint(context).await?;
    | |                                                                  ^ use `.ok_or(...)?` to provide an error compatible with `std::result::Result<ChatId, anyhow::Error>`
...   |
264 | |     Ok(ret_chat_id)
265 | | }
    | |_- this function returns a `Result`
    |
    = help: the trait `FromResidual<std::option::Option<Infallible>>` is not implemented for `std::result::Result<ChatId, anyhow::Error>`
    = help: the following other types implement trait `FromResidual<R>`:
              <std::result::Result<T, F> as FromResidual<Yeet<E>>>
              <std::result::Result<T, F> as FromResidual<std::result::Result<Infallible, E>>>

error[E0599]: no method named `write` found for struct `Arc<InnerContext>` in the current scope
   --> src/securejoin.rs:251:23
    |
251 |         context.inner.write().await.bob_expects = DC_VC_AUTH_REQUIRED;
    |                       ^^^^^ method not found in `Arc<InnerContext>`
    |
    = help: items from traits can only be used if the trait is implemented and in scope
    = note: the following traits define an item `write`, perhaps you need to implement one of them:
            candidate #1: `std::io::Write`
            candidate #2: `std::hash::Hasher`
            candidate #3: `tokio::io::AsyncWriteExt`
            candidate #4: `futures::AsyncWriteExt`
            candidate #5: `futures_lite::AsyncWriteExt`
            candidate #6: `der::writer::Writer`
            candidate #7: `embedded_io::blocking::Write`
            candidate #8: `quinn_proto::coding::BufMutExt`
            candidate #9: `der::writer::Writer`
            candidate #10: `itoa::private::Sealed`
            candidate #11: `ssh_encoding::writer::Writer`
            candidate #12: `dtoa::private::Sealed`
            candidate #13: `ssh_encoding::writer::Writer`
            candidate #14: `futures_lite::io::AsyncWriteExt`
            candidate #15: `iroh_quinn_proto::coding::BufMutExt`
            candidate #16: `attohttpc::request::body::Body`
            candidate #17: `CustomWrite`
help: some of the expressions' fields have a method of the same name
    |
251 |         context.inner.debug_logging.write().await.bob_expects = DC_VC_AUTH_REQUIRED;
    |                       ++++++++++++++
251 |         context.inner.last_error.write().await.bob_expects = DC_VC_AUTH_REQUIRED;
    |                       +++++++++++
251 |         context.inner.metadata.write().await.bob_expects = DC_VC_AUTH_REQUIRED;
    |                       +++++++++
251 |         context.inner.quota.write().await.bob_expects = DC_VC_AUTH_REQUIRED;
    |                       ++++++
      and 3 other candidates

error[E0599]: no method named `read` found for struct `Arc<InnerContext>` in the current scope
   --> src/securejoin.rs:187:30
    |
187 |             if context.inner.read().await.shall_stop_ongoing {
    |                              ^^^^ method not found in `Arc<InnerContext>`
...
257 |         check_exit!();
    |         ------------- in this macro invocation
    |
    = help: items from traits can only be used if the trait is implemented and in scope
    = note: the following traits define an item `read`, perhaps you need to implement one of them:
            candidate #1: `std::io::Read`
            candidate #2: `tokio::io::AsyncReadExt`
            candidate #3: `futures::AsyncReadExt`
            candidate #4: `futures_lite::AsyncReadExt`
            candidate #5: `XofReader`
            candidate #6: `iter_read::IterReadItem`
            candidate #7: `embedded_io::blocking::Read`
            candidate #8: `rustls::msgs::codec::Codec`
            candidate #9: `digest::xof::XofReader`
            candidate #10: `ssh_encoding::reader::Reader`
            candidate #11: `BinDecodable`
            candidate #12: `rustls::msgs::codec::Codec`
            candidate #13: `ssh_encoding::reader::Reader`
            candidate #14: `futures_lite::io::AsyncReadExt`
            candidate #15: `CustomRead`
            candidate #16: `object::ReadRef`
    = note: this error originates in the macro `check_exit` (in Nightly builds, run with -Z macro-backtrace for more info)

error[E0599]: no method named `write` found for struct `Arc<InnerContext>` in the current scope
   --> src/securejoin.rs:201:27
    |
201 |             context.inner.write().await.bob_expects = 0;
    |                           ^^^^^ method not found in `Arc<InnerContext>`
...
257 |         check_exit!();
    |         ------------- in this macro invocation
    |
    = help: items from traits can only be used if the trait is implemented and in scope
    = note: the following traits define an item `write`, perhaps you need to implement one of them:
            candidate #1: `std::io::Write`
            candidate #2: `std::hash::Hasher`
            candidate #3: `tokio::io::AsyncWriteExt`
            candidate #4: `futures::AsyncWriteExt`
            candidate #5: `futures_lite::AsyncWriteExt`
            candidate #6: `der::writer::Writer`
            candidate #7: `embedded_io::blocking::Write`
            candidate #8: `quinn_proto::coding::BufMutExt`
            candidate #9: `der::writer::Writer`
            candidate #10: `itoa::private::Sealed`
            candidate #11: `ssh_encoding::writer::Writer`
            candidate #12: `dtoa::private::Sealed`
            candidate #13: `ssh_encoding::writer::Writer`
            candidate #14: `futures_lite::io::AsyncWriteExt`
            candidate #15: `iroh_quinn_proto::coding::BufMutExt`
            candidate #16: `attohttpc::request::body::Body`
            candidate #17: `CustomWrite`
    = note: this error originates in the macro `cleanup` which comes from the expansion of the macro `check_exit` (in Nightly builds, run with -Z macro-backtrace for more info)

error[E0599]: no method named `write` found for struct `Arc<InnerContext>` in the current scope
   --> src/securejoin.rs:179:31
    |
179 |                 context.inner.write().await.qr_lock.unlock().await;
    |                               ^^^^^ method not found in `Arc<InnerContext>`
...
257 |         check_exit!();
    |         ------------- in this macro invocation
    |
    = help: items from traits can only be used if the trait is implemented and in scope
    = note: the following traits define an item `write`, perhaps you need to implement one of them:
            candidate #1: `std::io::Write`
            candidate #2: `std::hash::Hasher`
            candidate #3: `tokio::io::AsyncWriteExt`
            candidate #4: `futures::AsyncWriteExt`
            candidate #5: `futures_lite::AsyncWriteExt`
            candidate #6: `der::writer::Writer`
            candidate #7: `embedded_io::blocking::Write`
            candidate #8: `quinn_proto::coding::BufMutExt`
            candidate #9: `der::writer::Writer`
            candidate #10: `itoa::private::Sealed`
            candidate #11: `ssh_encoding::writer::Writer`
            candidate #12: `dtoa::private::Sealed`
            candidate #13: `ssh_encoding::writer::Writer`
            candidate #14: `futures_lite::io::AsyncWriteExt`
            candidate #15: `iroh_quinn_proto::coding::BufMutExt`
            candidate #16: `attohttpc::request::body::Body`
            candidate #17: `CustomWrite`
    = note: this error originates in the macro `unlock_qr` which comes from the expansion of the macro `check_exit` (in Nightly builds, run with -Z macro-backtrace for more info)

warning: unreachable statement
   --> src/securejoin.rs:201:13
    |
201 |               context.inner.write().await.bob_expects = 0;
    |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ unreachable statement
...
256 | /     loop {
257 | |         check_exit!();
258 | |
259 | |         tokio::time::sleep(Duration::from_millis(300)).await; // 0.3 seconds
260 | |     }
    | |_____- any code following this expression is unreachable
261 |
262 |       cleanup!();
    |       ---------- in this macro invocation
    |
    = note: `#[warn(unreachable_code)]` implied by `#[warn(unused)]`
    = note: this warning originates in the macro `cleanup` (in Nightly builds, run with -Z macro-backtrace for more info)

error[E0599]: no method named `write` found for struct `Arc<InnerContext>` in the current scope
   --> src/securejoin.rs:201:27
    |
201 |             context.inner.write().await.bob_expects = 0;
    |                           ^^^^^ method not found in `Arc<InnerContext>`
...
262 |     cleanup!();
    |     ---------- in this macro invocation
    |
    = help: items from traits can only be used if the trait is implemented and in scope
    = note: the following traits define an item `write`, perhaps you need to implement one of them:
            candidate #1: `std::io::Write`
            candidate #2: `std::hash::Hasher`
            candidate #3: `tokio::io::AsyncWriteExt`
            candidate #4: `futures::AsyncWriteExt`
            candidate #5: `futures_lite::AsyncWriteExt`
            candidate #6: `der::writer::Writer`
            candidate #7: `embedded_io::blocking::Write`
            candidate #8: `quinn_proto::coding::BufMutExt`
            candidate #9: `der::writer::Writer`
            candidate #10: `itoa::private::Sealed`
            candidate #11: `ssh_encoding::writer::Writer`
            candidate #12: `dtoa::private::Sealed`
            candidate #13: `ssh_encoding::writer::Writer`
            candidate #14: `futures_lite::io::AsyncWriteExt`
            candidate #15: `iroh_quinn_proto::coding::BufMutExt`
            candidate #16: `attohttpc::request::body::Body`
            candidate #17: `CustomWrite`
    = note: this error originates in the macro `cleanup` (in Nightly builds, run with -Z macro-backtrace for more info)

error[E0599]: no method named `write` found for struct `Arc<InnerContext>` in the current scope
   --> src/securejoin.rs:179:31
    |
179 |                 context.inner.write().await.qr_lock.unlock().await;
    |                               ^^^^^ method not found in `Arc<InnerContext>`
...
262 |     cleanup!();
    |     ---------- in this macro invocation
    |
    = help: items from traits can only be used if the trait is implemented and in scope
    = note: the following traits define an item `write`, perhaps you need to implement one of them:
            candidate #1: `std::io::Write`
            candidate #2: `std::hash::Hasher`
            candidate #3: `tokio::io::AsyncWriteExt`
            candidate #4: `futures::AsyncWriteExt`
            candidate #5: `futures_lite::AsyncWriteExt`
            candidate #6: `der::writer::Writer`
            candidate #7: `embedded_io::blocking::Write`
            candidate #8: `quinn_proto::coding::BufMutExt`
            candidate #9: `der::writer::Writer`
            candidate #10: `itoa::private::Sealed`
            candidate #11: `ssh_encoding::writer::Writer`
            candidate #12: `dtoa::private::Sealed`
            candidate #13: `ssh_encoding::writer::Writer`
            candidate #14: `futures_lite::io::AsyncWriteExt`
            candidate #15: `iroh_quinn_proto::coding::BufMutExt`
            candidate #16: `attohttpc::request::body::Body`
            candidate #17: `CustomWrite`
    = note: this error originates in the macro `unlock_qr` which comes from the expansion of the macro `cleanup` (in Nightly builds, run with -Z macro-backtrace for more info)

error[E0308]: mismatched types
   --> src/securejoin.rs:264:8
    |
264 |     Ok(ret_chat_id)
    |     -- ^^^^^^^^^^^ expected `ChatId`, found integer
    |     |
    |     arguments to this enum variant are incorrect
    |
help: the type constructed contains `{integer}` due to the type of the argument passed
   --> src/securejoin.rs:264:5
    |
264 |     Ok(ret_chat_id)
    |     ^^^-----------^
    |        |
    |        this argument influences the type of `Ok`
note: tuple variant defined here
   --> /home/k/.rustup/toolchains/1.77.1-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/result.rs:506:5
    |
506 |     Ok(#[stable(feature = "rust1", since = "1.0.0")] T),
    |     ^^
help: try wrapping the expression in `chat::ChatId` (its field is private, but it's local to this crate and its privacy can be changed)
    |
264 |     Ok(chat::ChatId(ret_chat_id))
    |        +++++++++++++           +

Some errors have detailed explanations: E0252, E0277, E0308, E0425, E0432, E0433, E0599, E0609.
For more information about an error, try `rustc --explain E0252`.
warning: `deltachat` (lib) generated 4 warnings
error: could not compile `deltachat` (lib) due to 42 previous errors; 4 warnings emitted
warning: build failed, waiting for other jobs to finish...
error[E0599]: no method named `read` found for struct `Arc<InnerContext>` in the current scope
   --> src/securejoin.rs:187:30
    |
187 |             if context.inner.read().await.shall_stop_ongoing {
    |                              ^^^^ method not found in `Arc<InnerContext>`
...
233 |     check_exit!();
    |     ------------- in this macro invocation
    |
    = help: items from traits can only be used if the trait is implemented and in scope
    = note: the following traits define an item `read`, perhaps you need to implement one of them:
            candidate #1: `std::io::Read`
            candidate #2: `tokio::io::AsyncReadExt`
            candidate #3: `futures::AsyncReadExt`
            candidate #4: `futures_lite::AsyncReadExt`
            candidate #5: `XofReader`
            candidate #6: `iter_read::IterReadItem`
            candidate #7: `embedded_io::blocking::Read`
            candidate #8: `rustls::msgs::codec::Codec`
            candidate #9: `digest::xof::XofReader`
            candidate #10: `ssh_encoding::reader::Reader`
            candidate #11: `BinDecodable`
            candidate #12: `object::read::read_ref::ReadRef`
            candidate #13: `rustls::msgs::codec::Codec`
            candidate #14: `ssh_encoding::reader::Reader`
            candidate #15: `futures_lite::io::AsyncReadExt`
            candidate #16: `CustomRead`
    = note: this error originates in the macro `check_exit` (in Nightly builds, run with -Z macro-backtrace for more info)

error[E0277]: the `?` operator can only be used on `Result`s, not `Option`s, in an async function that returns `Result`
   --> src/securejoin.rs:246:66
    |
153 |   pub async fn join_securejoin(context: &Context, qr: &str) -> Result<ChatId> {
    |  _____________________________________________________________________________-
154 | |     /* ==========================================================
155 | |        ====             Bob - the joiner's side             =====
156 | |        ====   Step 2 in "Setup verified contact" protocol   =====
...   |
246 | |         let own_fingerprint = get_self_fingerprint(context).await?;
    | |                                                                  ^ use `.ok_or(...)?` to provide an error compatible with `std::result::Result<chat::ChatId, anyhow::Error>`
...   |
264 | |     Ok(ret_chat_id)
265 | | }
    | |_- this function returns a `Result`
    |
    = help: the trait `FromResidual<std::option::Option<Infallible>>` is not implemented for `std::result::Result<chat::ChatId, anyhow::Error>`
    = help: the following other types implement trait `FromResidual<R>`:
              <std::result::Result<T, F> as FromResidual<Yeet<E>>>
              <std::result::Result<T, F> as FromResidual<std::result::Result<Infallible, E>>>

error[E0599]: no method named `read` found for struct `Arc<InnerContext>` in the current scope
   --> src/securejoin.rs:187:30
    |
187 |             if context.inner.read().await.shall_stop_ongoing {
    |                              ^^^^ method not found in `Arc<InnerContext>`
...
257 |         check_exit!();
    |         ------------- in this macro invocation
    |
    = help: items from traits can only be used if the trait is implemented and in scope
    = note: the following traits define an item `read`, perhaps you need to implement one of them:
            candidate #1: `std::io::Read`
            candidate #2: `tokio::io::AsyncReadExt`
            candidate #3: `futures::AsyncReadExt`
            candidate #4: `futures_lite::AsyncReadExt`
            candidate #5: `XofReader`
            candidate #6: `iter_read::IterReadItem`
            candidate #7: `embedded_io::blocking::Read`
            candidate #8: `rustls::msgs::codec::Codec`
            candidate #9: `digest::xof::XofReader`
            candidate #10: `ssh_encoding::reader::Reader`
            candidate #11: `BinDecodable`
            candidate #12: `object::read::read_ref::ReadRef`
            candidate #13: `rustls::msgs::codec::Codec`
            candidate #14: `ssh_encoding::reader::Reader`
            candidate #15: `futures_lite::io::AsyncReadExt`
            candidate #16: `CustomRead`
    = note: this error originates in the macro `check_exit` (in Nightly builds, run with -Z macro-backtrace for more info)

warning: `deltachat` (lib test) generated 4 warnings (4 duplicates)
error: could not compile `deltachat` (lib test) due to 42 previous errors; 4 warnings emitted
error: command `/home/k/.rustup/toolchains/1.77.1-x86_64-unknown-linux-gnu/bin/cargo test --no-run --message-format json-render-diagnostics` exited with code 101

