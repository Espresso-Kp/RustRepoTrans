<message>
you were asked to translate the given c function to rust and execute your response and get some error message.
Fix the bug in your previous response according to error message, c function, rust function signature, rust function dependencies(including function and variable dependencies), and data type declarations and rust function dependency libraries I provide(delimited with XML tags).
Only response the function results.
<previous response>
b'fn replace_in_uri(uri: &str, key: &str, value: &str) -> String {\n    if uri.is_empty() || key.is_empty() || value.is_empty() {\n        return uri.to_string();\n    }\n\n    let value_urlencoded = percent_encoding::utf8_percent_encode(value, NON_ALPHANUMERIC).to_string();\n    let mut uri_parts = uri.split(&format!("{}=", key)).collect::<Vec<&str>>();\n\n    if uri_parts.len() < 2 {\n        return uri.to_string();\n    }\n\n    let mut result = String::new();\n    result.push_str(uri_parts[0]);\n    result.push_str(&value_urlencoded);\n    result.push_str("=");\n    if uri_parts.len() > 1 {\n        result.push_str(uri_parts[1]);\n    }\n\n    result\n}'
</previous response>
<error message>
Compiling deltachat v1.139.6 (/home/k/ogs_PHD/LLM4SE/2Rust_projects/auto_get_functionPair/projects/deltachat-core/rust)
warning: unused import: `utf8_percent_encode`
 --> src/oauth2.rs:8:24
  |
8 | use percent_encoding::{utf8_percent_encode, NON_ALPHANUMERIC};
  |                        ^^^^^^^^^^^^^^^^^^^
  |
note: the lint level is defined here
 --> src/lib.rs:6:5
  |
6 |     unused,
  |     ^^^^^^
  = note: `#[warn(unused_imports)]` implied by `#[warn(unused)]`

warning: variable does not need to be mutable
   --> src/oauth2.rs:359:9
    |
359 |     let mut uri_parts = uri.split(&format!("{}=", key)).collect::<Vec<&str>>();
    |         ----^^^^^^^^^
    |         |
    |         help: remove this `mut`
    |
    = note: `#[warn(unused_mut)]` implied by `#[warn(unused)]`

warning: `deltachat` (lib) generated 2 warnings (run `cargo fix --lib -p deltachat` to apply 2 suggestions)
warning: `deltachat` (lib test) generated 2 warnings (2 duplicates)
    Finished test [unoptimized + debuginfo] target(s) in 32.16s
    Starting 808 tests across 1 binary (1 skipped; run ID: e0a4a5e4-4b90-4154-a131-0b5aedd77332, nextest profile: default)
        PASS [   0.060s] deltachat aheader::tests::test_bad_headers
        PASS [   0.057s] deltachat aheader::tests::test_display_aheader
        PASS [   0.056s] deltachat aheader::tests::test_from_str_non_critical
        PASS [   0.053s] deltachat aheader::tests::test_good_headers
        PASS [   0.056s] deltachat aheader::tests::test_from_str_reset
        PASS [   0.061s] deltachat accounts::tests::test_no_accounts_event_emitter
        PASS [   0.055s] deltachat aheader::tests::test_from_str_superflous_critical
        PASS [   0.057s] deltachat aheader::tests::test_from_str
        PASS [   0.042s] deltachat authres::tests::test_remove_comments
        PASS [   0.008s] deltachat blob::tests::test_is_blob_name
        PASS [   0.125s] deltachat authres::tests::test_handle_authres
        PASS [   0.121s] deltachat blob::tests::test_as_file_name
        PASS [   0.129s] deltachat authres::tests::test_parse_authentication_results
        PASS [   0.128s] deltachat authres::tests::test_update_authservid_candidates
        PASS [   0.163s] deltachat accounts::tests::test_accounts_remove_last
        PASS [   0.127s] deltachat blob::tests::test_create_from_name_long
        PASS [   0.194s] deltachat accounts::tests::test_migrate_account
        PASS [   0.008s] deltachat blob::tests::test_sanitise_name
        PASS [   0.178s] deltachat blob::tests::test_add_white_bg
        PASS [   0.142s] deltachat blob::tests::test_create_and_copy
        PASS [   0.142s] deltachat blob::tests::test_create_from_path
        PASS [   0.180s] deltachat blob::tests::test_as_rel_path
        PASS [   0.141s] deltachat blob::tests::test_double_ext_preserved
        PASS [   0.148s] deltachat blob::tests::test_create
        PASS [   0.146s] deltachat blob::tests::test_create_long_names
        PASS [   0.146s] deltachat blob::tests::test_increation_not_blobdir
        PASS [   0.146s] deltachat blob::tests::test_increation_in_blobdir
        PASS [   0.148s] deltachat blob::tests::test_create_dup
        PASS [   0.141s] deltachat blob::tests::test_lowercase_ext
        PASS [   0.247s] deltachat accounts::tests::test_account_new_open
        PASS [   0.295s] deltachat accounts::tests::test_accounts_share_translations
        PASS [   0.303s] deltachat accounts::tests::test_account_new_add_remove
        PASS [   0.291s] deltachat authres::tests::test_authres_in_mailinglist_ignored
        PASS [   0.293s] deltachat authres::tests::test_autocrypt_in_mailinglist_ignored
        PASS [   0.118s] deltachat blob::tests::test_suffix
        PASS [   0.119s] deltachat chat::tests::test_add_contact_to_chat_ex_add_self
        PASS [   0.126s] deltachat chat::tests::test_add_device_msg_label_only
        PASS [   0.138s] deltachat blob::tests::test_selfavatar_copy_without_recode
        PASS [   0.130s] deltachat chat::tests::test_add_info_msg
        PASS [   0.136s] deltachat chat::tests::test_add_device_msg_labelled
        PASS [   0.135s] deltachat chat::tests::test_add_info_msg_with_cmd
        PASS [   0.134s] deltachat chat::tests::test_add_remove_contact_for_single
        PASS [   0.140s] deltachat chat::tests::test_add_device_msg_unlabelled
        PASS [   0.135s] deltachat chat::tests::test_archive
        PASS [   0.157s] deltachat chat::tests::test_archive_fresh_msgs
        PASS [   0.210s] deltachat blob::tests::test_selfavatar_in_blobdir
        PASS [   0.219s] deltachat blob::tests::test_selfavatar_outside_blobdir
        PASS [   0.131s] deltachat chat::tests::test_can_send_group
        PASS [   0.130s] deltachat chat::tests::test_chat_info
        PASS [   0.144s] deltachat chat::tests::test_change_quotes_on_reused_message_object
        PASS [   0.143s] deltachat chat::tests::test_classic_email_chat
        PASS [   0.142s] deltachat chat::tests::test_contact_request_archive
        PASS [   0.141s] deltachat chat::tests::test_create_for_contact_with_blocked
        PASS [   0.141s] deltachat chat::tests::test_create_same_chat_twice
        PASS [   0.140s] deltachat chat::tests::test_delete_and_reset_all_device_msgs
        PASS [   0.146s] deltachat chat::tests::test_contact_request_fresh_messages
        PASS [   0.314s] deltachat blob::tests::test_send_big_gif_as_image
        PASS [   0.152s] deltachat chat::tests::test_delete_device_chat
        PASS [   0.153s] deltachat chat::tests::test_delete_draft
        PASS [   0.277s] deltachat chat::tests::test_blob_renaming
        PASS [   0.256s] deltachat chat::tests::test_chat_get_color
        PASS [   0.158s] deltachat chat::tests::test_draft_stable_ids
        PASS [   0.179s] deltachat chat::tests::test_device_chat_cannot_sent
        PASS [   0.276s] deltachat chat::tests::test_chat_get_encryption_info
        PASS [   0.311s] deltachat chat::tests::test_broadcast
        PASS [   0.457s] deltachat blob::tests::test_recode_image_rgba_png_to_jpeg
        PASS [   0.131s] deltachat chat::tests::test_get_draft
        PASS [   0.140s] deltachat chat::tests::test_forward_info_msg
        PASS [   0.141s] deltachat chat::tests::test_get_draft_no_chat
        PASS [   0.147s] deltachat chat::tests::test_forwarding_draft_failing
        PASS [   0.160s] deltachat chat::tests::test_get_chat_media
        PASS [   0.155s] deltachat chat::tests::test_get_draft_no_draft
        PASS [   0.137s] deltachat chat::tests::test_get_draft_special_chat_id
        PASS [   0.400s] deltachat chat::tests::test_broadcast_multidev
        PASS [   0.139s] deltachat chat::tests::test_lookup_by_contact_id
        PASS [   0.133s] deltachat chat::tests::test_marknoticed_chat
        PASS [   0.286s] deltachat chat::tests::test_forward
        PASS [   0.285s] deltachat chat::tests::test_forward_group
        PASS [   0.177s] deltachat chat::tests::test_lookup_self_by_contact_id
        PASS [   0.297s] deltachat chat::tests::test_forward_quote
        PASS [   0.133s] deltachat chat::tests::test_resend_info_message_fails
        PASS [   0.304s] deltachat chat::tests::test_leave_group
        PASS [   0.319s] deltachat chat::tests::test_group_with_removed_message_id
        PASS [   0.736s] deltachat blob::tests::test_recode_image_huge_jpg
        PASS [   0.289s] deltachat chat::tests::test_lost_member_added
        PASS [   0.283s] deltachat chat::tests::test_member_add_remove
        PASS [   0.286s] deltachat chat::tests::test_modify_chat_multi_device
        PASS [   0.279s] deltachat chat::tests::test_only_minimal_data_are_forwarded
        PASS [   0.141s] deltachat chat::tests::test_set_chat_name
        PASS [   0.291s] deltachat chat::tests::test_msg_with_implicit_member_add
        PASS [   0.304s] deltachat chat::tests::test_parallel_member_remove
        PASS [   0.295s] deltachat chat::tests::test_pinned_after_new_msgs
        PASS [   0.282s] deltachat chat::tests::test_resend_foreign_message_fails
        PASS [   0.130s] deltachat chat::tests::test_set_mute_duration
        PASS [   0.134s] deltachat chat::tests::test_shall_attach_selfavatar
        PASS [   0.311s] deltachat chat::tests::test_quote_replies
        PASS [   0.253s] deltachat chat::tests::test_self_talk
        PASS [   0.286s] deltachat chat::tests::test_resend_opportunistically_encryption
        PASS [   0.934s] deltachat blob::tests::test_recode_image_1
        PASS [   0.131s] deltachat chat::tests::test_was_device_msg_ever_added
        PASS [   0.136s] deltachat chatlist::tests::test_get_summary_unwrap
        PASS [   0.152s] deltachat chat::tests::test_unarchive_if_muted
        PASS [   0.135s] deltachat chatlist::tests::test_load_broken
        PASS [   0.279s] deltachat chat::tests::test_sticker_gif
        PASS [   0.133s] deltachat chatlist::tests::test_search_single_chat
        PASS [   0.010s] deltachat color::tests::test_rgb_to_u32
        PASS [   0.007s] deltachat color::tests::test_str_to_angle
        PASS [   0.300s] deltachat chat::tests::test_sticker_forward
        PASS [   0.435s] deltachat chat::tests::test_resend_own_message
        PASS [   0.280s] deltachat chat::tests::test_sticker_png
        PASS [   0.279s] deltachat chat::tests::test_sync_adhoc_grp
        PASS [   0.134s] deltachat chatlist::tests::test_search_single_chat_without_authname
        PASS [   0.288s] deltachat chat::tests::test_sync_visibility
        PASS [   0.318s] deltachat chat::tests::test_sync_name
        PASS [   0.135s] deltachat config::tests::test_media_quality_config_option
        PASS [   0.022s] deltachat config::tests::test_to_string
        PASS [   0.009s] deltachat configure::auto_mozilla::tests::test_parse_lakenet_autoconfig
        PASS [   0.008s] deltachat configure::auto_mozilla::tests::test_parse_outlook_autoconfig
        PASS [   0.008s] deltachat configure::auto_outlook::tests::test_parse_loginparam
        PASS [   0.138s] deltachat config::tests::test_set_config_addr
        PASS [   0.146s] deltachat config::tests::test_self_addrs
        PASS [   0.437s] deltachat chat::tests::test_sticker_jpeg
        PASS [   0.007s] deltachat configure::auto_outlook::tests::test_parse_redirect
        PASS [   0.007s] deltachat configure::server_params::tests::test_expand_param_vector
        PASS [   0.136s] deltachat config::tests::test_set_config_bot
        PASS [   0.192s] deltachat chatlist::tests::test_search_special_chat_names
        PASS [   0.009s] deltachat constants::tests::test_blocked_values
        PASS [   0.007s] deltachat constants::tests::test_keygentype_values
        PASS [   0.146s] deltachat config::tests::test_set_config_bool
        PASS [   0.010s] deltachat constants::tests::test_chattype_values
        PASS [   0.009s] deltachat constants::tests::test_mediaquality_values
        PASS [   0.192s] deltachat chatlist::tests::test_sort_self_talk_up_on_forward
        PASS [   0.009s] deltachat constants::tests::test_videochattype_values
        PASS [   0.013s] deltachat constants::tests::test_showemails_values
        PASS [   0.009s] deltachat contact::tests::test_addr_cmp
        PASS [   1.346s] deltachat accounts::tests::test_accounts_sorted
        PASS [   0.009s] deltachat contact::tests::test_contact_id_values
        PASS [   0.433s] deltachat chat::tests::test_sync_broadcast
        PASS [   0.467s] deltachat chat::tests::test_sticker_jpeg_force
        PASS [   0.407s] deltachat chat::tests::test_sync_muted
        PASS [   0.144s] deltachat config::tests::test_ui_config
        PASS [   0.301s] deltachat chatlist::tests::test_try_load
        PASS [   0.292s] deltachat config::tests::test_event_config_synced
        PASS [   0.019s] deltachat contact::tests::test_may_be_valid_addr
        PASS [   0.011s] deltachat contact::tests::test_normalize_addr
        PASS [   0.007s] deltachat contact::tests::test_normalize_name
        PASS [   0.143s] deltachat contact::tests::test_delete_and_recreate_contact
        PASS [   0.152s] deltachat contact::tests::test_add_or_lookup
        PASS [   0.145s] deltachat contact::tests::test_delete
        PASS [   0.140s] deltachat contact::tests::test_is_self_addr
        PASS [   0.145s] deltachat contact::tests::test_get_contacts
        PASS [   0.149s] deltachat contact::tests::test_contact_name_changes
        PASS [   0.136s] deltachat contact::tests::test_last_seen
        PASS [   0.009s] deltachat contact::tests::test_split_address_book
        PASS [   0.315s] deltachat config::tests::test_sync
        PASS [   0.607s] deltachat chat::tests::test_sync_blocked
        PASS [   0.145s] deltachat contact::tests::test_name_in_address
        PASS [   0.138s] deltachat contact::tests::test_remote_authnames
        PASS [   0.141s] deltachat contact::tests::test_remote_authnames_create_empty
        PASS [   0.132s] deltachat contact::tests::test_remote_authnames_edit_empty
        PASS [   0.264s] deltachat contact::tests::test_lookup_id_by_addr
        PASS [   0.140s] deltachat contact::tests::test_remote_authnames_update_to
        PASS [   0.291s] deltachat contact::tests::test_contact_get_encrinfo
        PASS [   0.131s] deltachat context::tests::no_crashes_on_context_deref
        PASS [   0.385s] deltachat contact::tests::test_contact_get_color
        PASS [   0.127s] deltachat context::tests::test_blobdir_exists
        PASS [   0.008s] deltachat context::tests::test_get_info_no_context
        PASS [   0.583s] deltachat config::tests::test_no_sync_on_self_sent_msg
        PASS [   0.135s] deltachat context::tests::test_get_fresh_msgs
        PASS [   0.142s] deltachat context::tests::test_draft_self_report
        PASS [   0.273s] deltachat contact::tests::test_verified_by_none
        PASS [   0.280s] deltachat contact::tests::test_sync_create
        PASS [   0.140s] deltachat context::tests::test_get_fresh_msgs_and_muted_until
        PASS [   0.271s] deltachat contact::tests::test_was_seen_recently
        PASS [   0.009s] deltachat context::tests::test_with_empty_blobdir
        PASS [   0.013s] deltachat context::tests::test_with_blobdir_not_exists
        PASS [   0.155s] deltachat context::tests::test_get_fresh_msgs_and_muted_chats
        PASS [   0.423s] deltachat contact::tests::test_make_n_import_vcard
        PASS [   0.010s] deltachat context::tests::test_wrong_blogdir
        PASS [   0.007s] deltachat decrypt::tests::test_has_decrypted_pgp_armor
        PASS [   0.011s] deltachat context::tests::test_wrong_db
        PASS [   0.010s] deltachat dehtml::tests::test_dehtml
        PASS [   0.009s] deltachat dehtml::tests::test_dehtml_bold_text
        PASS [   0.281s] deltachat contact::tests::test_was_seen_recently_event
        PASS [   0.461s] deltachat contact::tests::test_import_vcard_updates_only_key
        PASS [   0.008s] deltachat dehtml::tests::test_dehtml_case_sensitive_link
        PASS [   0.146s] deltachat context::tests::test_get_info
        PASS [   0.008s] deltachat dehtml::tests::test_dehtml_html_encoded
        PASS [   0.009s] deltachat dehtml::tests::test_dehtml_parse_br
        PASS [   0.008s] deltachat dehtml::tests::test_dehtml_parse_href
        PASS [   0.007s] deltachat dehtml::tests::test_dehtml_parse_p
        PASS [   0.008s] deltachat dehtml::tests::test_dehtml_parse_span
        PASS [   0.010s] deltachat dehtml::tests::test_pre_tag
        PASS [   0.008s] deltachat dehtml::tests::test_spaces
        PASS [   0.011s] deltachat dehtml::tests::test_quote_div
        PASS [   0.011s] deltachat dehtml::tests::test_unclosed_tags
        PASS [   1.680s] deltachat blob::tests::test_recode_image_balanced_png
        PASS [   0.010s] deltachat download::tests::test_downloadstate_values
        PASS [   0.143s] deltachat context::tests::test_get_info_completeness
        PASS [   1.732s] deltachat blob::tests::test_recode_image_2
        PASS [   0.128s] deltachat context::tests::test_ongoing
        PASS [   0.134s] deltachat context::tests::test_search_msgs
        PASS [   0.131s] deltachat context::tests::test_sqlite_parent_not_exists
        PASS [   0.007s] deltachat e2ee::tests::test_mailmime_parse
        PASS [   0.143s] deltachat context::tests::test_search_unaccepted_requests
        PASS [   0.139s] deltachat decrypt::tests::test_mixed_up_mime
        PASS [   0.444s] deltachat contact::tests::test_synchronize_status
        PASS [   0.127s] deltachat download::tests::test_download_limit
        PASS [   0.123s] deltachat download::tests::test_mdn_expands_to_nothing
        PASS [   0.480s] deltachat contact::tests::test_selfavatar_changed_event
        PASS [   0.146s] deltachat download::tests::test_partial_download_and_ephemeral
        PASS [   0.184s] deltachat decrypt::tests::test_mixed_up_mime_long
        PASS [   0.153s] deltachat download::tests::test_partial_receive_imf
        PASS [   0.160s] deltachat download::tests::test_update_download_state
        PASS [   0.132s] deltachat e2ee::tests::ensure_secret_key_exists::test_not_configured
        PASS [   0.273s] deltachat context::tests::test_get_next_msgs
        PASS [   0.140s] deltachat e2ee::tests::ensure_secret_key_exists::test_prexisting
        PASS [   0.147s] deltachat ephemeral::tests::test_delete_expired_imap_messages
        PASS [   0.151s] deltachat e2ee::tests::test_should_encrypt
        PASS [   0.155s] deltachat ephemeral::tests::test_ephemeral_delete_msgs
        PASS [   0.149s] deltachat ephemeral::tests::test_ephemeral_msg_offline
        PASS [   2.109s] deltachat accounts::tests::test_accounts_ids_unique_increasing_and_persisted
        PASS [   0.149s] deltachat ephemeral::tests::test_ephemeral_timer_references
        PASS [   0.139s] deltachat ephemeral::tests::test_stock_ephemeral_messages
        PASS [   0.302s] deltachat download::tests::test_status_update_expands_to_nothing
        PASS [   0.143s] deltachat events::chatlist_events::test_chatlist_events::test_adhoc_group
        PASS [   2.153s] deltachat accounts::tests::test_encrypted_account
        PASS [   0.129s] deltachat events::chatlist_events::test_chatlist_events::test_change_chat_name
        PASS [   0.312s] deltachat e2ee::tests::test_encrypted_no_autocrypt
        PASS [   0.267s] deltachat ephemeral::tests::test_ephemeral_enable_lost
        PASS [   0.138s] deltachat events::chatlist_events::test_chatlist_events::test_change_chat_profile_image
        PASS [   0.286s] deltachat ephemeral::tests::test_ephemeral_enable_disable
        PASS [   0.282s] deltachat ephemeral::tests::test_ephemeral_poi_location
        PASS [   0.138s] deltachat events::chatlist_events::test_chatlist_events::test_change_chat_visibility
        PASS [   0.121s] deltachat events::chatlist_events::test_chatlist_events::test_create_broadcastlist
        PASS [   0.121s] deltachat events::chatlist_events::test_chatlist_events::test_create_group_chat
        PASS [   0.275s] deltachat events::chatlist_events::test_chatlist_events::test_accept_contact_request
        PASS [   0.014s] deltachat headerdef::tests::kebab_test
        PASS [   0.007s] deltachat headerdef::tests::test_get_header_value_case
        PASS [   0.139s] deltachat events::chatlist_events::test_chatlist_events::test_delete_chat
        PASS [   0.310s] deltachat ephemeral::tests::test_ephemeral_timer_rollback
        PASS [   0.269s] deltachat events::chatlist_events::test_chatlist_events::test_archived_counter_increases_for_muted_chats
        PASS [   0.130s] deltachat events::chatlist_events::test_chatlist_events::test_delete_message
        PASS [   0.280s] deltachat events::chatlist_events::test_chatlist_events::test_archived_counter_update_on_mark_noticed
        PASS [   0.253s] deltachat events::chatlist_events::test_chatlist_events::test_block_contact_request
        PASS [   0.129s] deltachat events::chatlist_events::test_chatlist_events::test_mute_chat
        PASS [   0.140s] deltachat events::chatlist_events::test_chatlist_events::test_resend_message
        PASS [   0.157s] deltachat events::chatlist_events::test_chatlist_events::test_reaction
        PASS [   0.130s] deltachat events::chatlist_events::test_chatlist_events::test_unblock_contact
        PASS [   0.134s] deltachat events::chatlist_events::test_chatlist_events::test_update_after_ephemeral_messages
        PASS [   0.274s] deltachat events::chatlist_events::test_chatlist_events::test_contact_name_update
        PASS [   0.291s] deltachat events::chatlist_events::test_chatlist_events::test_contact_changed_avatar
        PASS [   0.007s] deltachat imap::tests::test_get_folder_meaning_by_name
        PASS [   0.137s] deltachat html::tests::test_get_html_invalid_msgid
        PASS [   0.147s] deltachat html::tests::test_cp1252_html
        PASS [   0.135s] deltachat html::tests::test_htmlparse_alt_html
        PASS [   0.027s] deltachat imap::tests::test_build_sequence_sets
        PASS [   0.143s] deltachat html::tests::test_htmlparse_alt_plain
        PASS [   0.132s] deltachat html::tests::test_htmlparse_alt_plain_html
        PASS [   0.008s] deltachat imap::tests::test_uid_grouper
        PASS [   0.264s] deltachat events::chatlist_events::test_chatlist_events::test_msgs_noticed_on_chat
        PASS [   0.149s] deltachat html::tests::test_htmlparse_apple_cid_jpg
        PASS [   0.013s] deltachat imex::tests::test_decrypt_plaintext_autocrypt_setup_message
        PASS [   0.145s] deltachat html::tests::test_htmlparse_html
        PASS [   0.290s] deltachat events::chatlist_events::test_chatlist_events::test_receiving_group_and_group_changes
        PASS [   0.152s] deltachat html::tests::test_htmlparse_plain_flowed
        PASS [   0.152s] deltachat html::tests::test_htmlparse_plain_unspecified
        PASS [   0.161s] deltachat html::tests::test_htmlparse_plain_iso88591
        PASS [   0.144s] deltachat imap::tests::test_get_imap_search_command
        PASS [   0.321s] deltachat events::chatlist_events::test_chatlist_events::test_secure_join_group
        PASS [   0.142s] deltachat imap::tests::test_set_uid_next_validity
        PASS [   0.276s] deltachat html::tests::test_html_forwarding
        PASS [   0.007s] deltachat imex::tests::test_normalize_setup_code
        PASS [   0.286s] deltachat html::tests::test_html_forwarding_encrypted
        PASS [   0.137s] deltachat imex::tests::test_create_setup_code
        PASS [   0.010s] deltachat imex::tests::test_split_and_decrypt
        PASS [   0.007s] deltachat imex::transfer::tests::test_send_progress
        PASS [   0.139s] deltachat imex::tests::test_export_private_key_to_asc_file
        PASS [   0.123s] deltachat imex::tests::test_export_public_key_to_asc_file
        PASS [   0.015s] deltachat key::tests::test_asc_roundtrip
        PASS [   0.010s] deltachat key::tests::test_base64_roundtrip
        PASS [   0.008s] deltachat key::tests::test_fingerprint_from_str
        PASS [   0.009s] deltachat key::tests::test_fingerprint_hex
        PASS [   0.007s] deltachat key::tests::test_fingerprint_to_string
        PASS [   0.269s] deltachat html::tests::test_set_html
        PASS [   0.008s] deltachat key::tests::test_from_armored_string
        PASS [   0.008s] deltachat key::tests::test_from_slice_bad_data
        PASS [   0.009s] deltachat key::tests::test_from_slice_roundtrip
        PASS [   0.145s] deltachat imex::tests::test_key_transfer_k_9
        PASS [   1.458s] deltachat configure::tests::test_no_panic_on_bad_credentials
        PASS [   0.148s] deltachat key::tests::test_load_self_existing
        PASS [   0.147s] deltachat key::tests::test_load_self_generate_public
        PASS [   0.014s] deltachat key::tests::test_split_key
        PASS [   0.165s] deltachat key::tests::test_load_self_generate_concurrent
        PASS [   0.124s] deltachat key::tests::test_load_self_generate_secret
        PASS [   0.008s] deltachat location::tests::test_get_message_kml
        PASS [   2.154s] deltachat chat::tests::test_pinned
        PASS [   0.008s] deltachat location::tests::test_is_marker
        PASS [   0.008s] deltachat location::tests::test_kml_parse
        PASS [   0.007s] deltachat location::tests::test_kml_parse_error
        PASS [   0.386s] deltachat imex::tests::test_export_and_import_key
        PASS [   0.007s] deltachat login_param::tests::test_certificate_checks_display
        PASS [   2.881s] deltachat authres::tests::test_realworld_authentication_results
        PASS [   0.009s] deltachat message::tests::test_create_webrtc_instance
        PASS [   0.361s] deltachat imex::tests::test_render_setup_file
        PASS [   0.359s] deltachat imex::tests::test_render_setup_file_newline_replace
        PASS [   0.008s] deltachat message::tests::test_create_webrtc_instance_noroom
        PASS [   0.135s] deltachat key::tests::test_save_self_key_twice
        PASS [   0.133s] deltachat location::tests::receive_location_kml
        PASS [   0.420s] deltachat imex::tests::test_import_second_key
        PASS [   0.133s] deltachat location::tests::receive_visible_location_kml
        PASS [   0.007s] deltachat message::tests::test_guess_msgtype_from_suffix
        PASS [   0.125s] deltachat log::tests::test_get_last_error
        PASS [   0.131s] deltachat login_param::tests::test_save_load_login_param
        PASS [   0.006s] deltachat message::tests::test_parse_webrtc_instance
        PASS [   0.460s] deltachat imex::tests::test_key_transfer_non_self_sent
        PASS [   0.127s] deltachat message::tests::test_get_message_summary_text
        PASS [   0.141s] deltachat message::tests::test_delete_msgs_offline
        PASS [   0.143s] deltachat message::tests::test_get_chat_id
        PASS [   0.128s] deltachat message::tests::test_is_bot
        PASS [   0.277s] deltachat location::tests::test_delete_expired_locations
        PASS [   2.473s] deltachat chat::tests::test_modify_chat_lost
        PASS [   0.013s] deltachat message::tests::test_viewtype_derive_display_works_as_expected
        PASS [   0.271s] deltachat location::tests::test_send_locations_to_chat
        PASS [   0.014s] deltachat message::tests::test_viewtype_values
        PASS [   0.179s] deltachat message::tests::test_get_width_height
        PASS [   0.010s] deltachat mimefactory::tests::test_maybe_encode_words
        PASS [   0.133s] deltachat message::tests::test_prepare_message_and_send
        PASS [   3.126s] deltachat accounts::tests::test_account_new_open_conflict
        PASS [   0.007s] deltachat mimefactory::tests::test_needs_encoding
        PASS [   0.010s] deltachat mimefactory::tests::test_no_empty_lines_in_header
        PASS [   1.160s] deltachat ephemeral::tests::test_ephemeral_unpromoted
        PASS [   0.012s] deltachat mimefactory::tests::test_render_email_address
        PASS [   0.018s] deltachat mimefactory::tests::test_render_email_address_noescape
        PASS [   0.009s] deltachat mimefactory::tests::test_render_rc724_mid_list
        PASS [   0.148s] deltachat message::tests::test_prepare_not_configured
        PASS [   0.010s] deltachat mimefactory::tests::test_render_rfc724_mid
        PASS [   0.130s] deltachat message::tests::test_quote
        PASS [   0.686s] deltachat imex::tests::test_key_transfer
        PASS [   0.278s] deltachat message::tests::test_get_state
        PASS [   0.294s] deltachat message::tests::test_format_flowed_round_trip
        PASS [   0.126s] deltachat mimefactory::tests::test_from_before_autocrypt
        PASS [   0.145s] deltachat mimefactory::tests::test_manually_set_subject
        PASS [   0.145s] deltachat mimefactory::tests::test_remove_member_bcc
        PASS [   0.310s] deltachat message::tests::test_markseen_msgs
        PASS [   0.011s] deltachat mimefactory::tests::test_wrapped_base64_encode
        PASS [   0.141s] deltachat mimefactory::tests::test_render_reply
        PASS [   0.152s] deltachat mimefactory::tests::test_selfavatar_unencrypted
        PASS [   0.281s] deltachat message::tests::test_send_quotes
        PASS [   0.288s] deltachat message::tests::test_unencrypted_quote_encrypted_message
        PASS [   0.159s] deltachat mimefactory::tests::test_subject_in_group
        PASS [   0.156s] deltachat mimefactory::tests::test_subject_mdn
        PASS [   0.298s] deltachat mimefactory::tests::test_mdn_create_encrypted
        PASS [   0.142s] deltachat mimeparser::tests::parse_format_flowed_quote
        PASS [   0.145s] deltachat mimeparser::tests::parse_inline_image
        PASS [   0.140s] deltachat mimeparser::tests::parse_outlook_html_embedded_image
        PASS [   0.325s] deltachat mimefactory::tests::test_protected_headers_directive
        PASS [   0.142s] deltachat mimeparser::tests::parse_quote_top_posting
        PASS [   0.401s] deltachat message::tests::test_set_override_sender_name
        PASS [   0.304s] deltachat mimefactory::tests::test_selfavatar_unencrypted_signed
        PASS [   0.134s] deltachat mimeparser::tests::parse_quote_without_reply
        PASS [   0.132s] deltachat mimeparser::tests::parse_thunderbird_html_embedded_image
        PASS [   0.140s] deltachat mimeparser::tests::test_allinkl_blockquote
        PASS [   0.142s] deltachat mimeparser::tests::test_add_subj_to_multimedia_msg
        PASS [   0.284s] deltachat mimefactory::tests::test_subject_outgoing
        PASS [   0.136s] deltachat mimeparser::tests::test_attachment_quote
        PASS [   0.145s] deltachat mimeparser::tests::test_bot_no_subject
        PASS [   0.139s] deltachat mimeparser::tests::test_get_attachment_filename
        PASS [   0.139s] deltachat mimeparser::tests::test_get_attachment_filename_apostrophed
        PASS [   0.007s] deltachat mimeparser::tests::test_get_recipients
        PASS [   0.130s] deltachat mimeparser::tests::test_get_attachment_filename_apostrophed_cont
        PASS [   0.130s] deltachat mimeparser::tests::test_get_attachment_filename_apostrophed_cp1252
        PASS [   0.130s] deltachat mimeparser::tests::test_get_attachment_filename_apostrophed_invalid
        PASS [   0.138s] deltachat mimeparser::tests::test_get_attachment_filename_apostrophed_windows1251
        PASS [   0.014s] deltachat mimeparser::tests::test_is_attachment
        PASS [   0.139s] deltachat mimeparser::tests::test_get_attachment_filename_combined
        PASS [   0.007s] deltachat mimeparser::tests::test_mailparse_content_type
        PASS [   0.137s] deltachat mimeparser::tests::test_get_attachment_filename_encoded_words
        PASS [   0.146s] deltachat mimeparser::tests::test_get_attachment_filename_encoded_words_binary
        PASS [   0.152s] deltachat mimeparser::tests::test_get_attachment_filename_encoded_words_bad_delimiter
        PASS [   0.148s] deltachat mimeparser::tests::test_get_attachment_filename_encoded_words_cont
        PASS [   0.147s] deltachat mimeparser::tests::test_get_attachment_filename_encoded_words_windows1251
        PASS [   0.138s] deltachat mimeparser::tests::test_get_parent_timestamp
        PASS [   0.134s] deltachat mimeparser::tests::test_get_rfc724_mid_not_exists
        PASS [   0.134s] deltachat mimeparser::tests::test_hide_html_without_content
        PASS [   0.131s] deltachat mimeparser::tests::test_ignore_read_receipt_to_self
        PASS [   0.141s] deltachat mimeparser::tests::test_get_rfc724_mid_exists
        PASS [   0.131s] deltachat mimeparser::tests::test_jpeg_as_application_octet_stream
        PASS [   0.136s] deltachat mimeparser::tests::test_long_in_reply_to
        PASS [   0.124s] deltachat mimeparser::tests::test_mime_modified_alt_plain
        PASS [   0.138s] deltachat mimeparser::tests::test_mime_modified_alt_html
        PASS [   2.025s] deltachat context::tests::test_limit_search_msgs
        PASS [   0.141s] deltachat mimeparser::tests::test_mime_modified_alt_plain_html
        PASS [   0.141s] deltachat mimeparser::tests::test_mime_modified_html
        PASS [   0.140s] deltachat mimeparser::tests::test_mime_modified_large_plain
        PASS [   0.007s] deltachat mimeparser::tests::test_parse_message_id
        PASS [   0.009s] deltachat mimeparser::tests::test_parse_message_ids
        PASS [   0.130s] deltachat mimeparser::tests::test_mime_modified_plain
        PASS [   0.125s] deltachat mimeparser::tests::test_mimeparser_crash
        PASS [   0.129s] deltachat mimeparser::tests::test_mimeparser_fromheader
        PASS [   0.129s] deltachat mimeparser::tests::test_mimeparser_with_context
        PASS [   0.129s] deltachat mimeparser::tests::test_mimeparser_with_avatars
        PASS [   0.130s] deltachat mimeparser::tests::test_mimeparser_message_kml
        PASS [   0.126s] deltachat mimeparser::tests::test_ms_exchange_mdn
        PASS [   0.134s] deltachat mimeparser::tests::test_mimeparser_with_videochat
        PASS [   0.131s] deltachat mimeparser::tests::test_parse_first_addr
        PASS [   0.132s] deltachat mimeparser::tests::test_parse_inline_attachment
        PASS [   0.131s] deltachat mimeparser::tests::test_parse_mdn
        PASS [   1.514s] deltachat imap::tests::test_target_folder_incoming_request
        PASS [   0.131s] deltachat mimeparser::tests::test_parse_mdn_with_additional_message_ids
        PASS [   1.506s] deltachat imap::tests::test_target_folder_setupmsg
        PASS [   1.522s] deltachat imap::tests::test_target_folder_incoming_accepted
        PASS [   0.023s] deltachat net::tls::tests::test_build_tls
        PASS [   0.128s] deltachat mimeparser::tests::test_parse_multiple_mdns
        PASS [   0.014s] deltachat oauth2::tests::test_normalize_addr
        PASS [   1.531s] deltachat imap::tests::test_target_folder_outgoing
        PASS [   0.006s] deltachat param::tests::test_dc_param
        FAIL [   0.017s] deltachat oauth2::tests::test_replace_in_uri

--- STDOUT:              deltachat oauth2::tests::test_replace_in_uri ---

running 1 test
test oauth2::tests::test_replace_in_uri ... FAILED

failures:

failures:
    oauth2::tests::test_replace_in_uri

test result: FAILED. 0 passed; 1 failed; 0 ignored; 0 measured; 808 filtered out; finished in 0.00s


--- STDERR:              deltachat oauth2::tests::test_replace_in_uri ---
thread 'oauth2::tests::test_replace_in_uri' panicked at src/oauth2.rs:396:9:
assertion `left == right` failed
  left: "helloworld"
 right: "helloa%2Db%20c"
note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace

   Canceling due to test failure: 27 tests still running
        PASS [   0.132s] deltachat mimeparser::tests::test_quote_div
        PASS [   0.008s] deltachat param::tests::test_params_unknown_key
        PASS [   0.146s] deltachat mimeparser::tests::test_parse_reaction
        PASS [   0.127s] deltachat mimeparser::tests::test_time_in_future
        PASS [   0.135s] deltachat mimeparser::tests::test_receive_eml
        PASS [   0.131s] deltachat mimeparser::tests::test_take_last_header
        PASS [   0.136s] deltachat mimeparser::tests::test_schleuder
        PASS [   2.368s] deltachat context::tests::test_context_change_passphrase
        PASS [   0.129s] deltachat mimeparser::tests::test_tlsrpt
        PASS [   0.130s] deltachat mimeparser::tests::test_x_microsoft_original_message_id
        PASS [   0.262s] deltachat mimeparser::tests::test_outgoing_wants_mdn
        PASS [   0.131s] deltachat oauth2::tests::test_oauth_from_address
        FAIL [   0.136s] deltachat oauth2::tests::test_get_oauth2_url

--- STDOUT:              deltachat oauth2::tests::test_get_oauth2_url ---

running 1 test

========== Chats of 2821035143: ==========

test oauth2::tests::test_get_oauth2_url ... FAILED

failures:

failures:
    oauth2::tests::test_get_oauth2_url

test result: FAILED. 0 passed; 1 failed; 0 ignored; 0 measured; 808 filtered out; finished in 0.13s


--- STDERR:              deltachat oauth2::tests::test_get_oauth2_url ---
thread 'oauth2::tests::test_get_oauth2_url' panicked at src/oauth2.rs:456:9:
assertion `left == right` failed
  left: Some("https://accounts.google.com/o/oauth2/auth?client_id=$CLIENT_ID&redirect_uri=$REDIRECT_URI&response_type=code&scope=https%3A%2F%2Fmail.google.com%2F%20email&access_type=offline")
 right: Some("https://accounts.google.com/o/oauth2/auth?client_id=959970109878%2D4mvtgf6feshskf7695nfln6002mom908%2Eapps%2Egoogleusercontent%2Ecom&redirect_uri=chat%2Edelta%3A%2Fcom%2Eb44t%2Emessenger&response_type=code&scope=https%3A%2F%2Fmail.google.com%2F%20email&access_type=offline")
note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace

        PASS [   0.125s] deltachat param::tests::test_params_file_fs_path
        PASS [   0.130s] deltachat param::tests::test_params_file_blob
        PASS [   0.127s] deltachat param::tests::test_params_get_fileparam
        PASS [   0.917s] deltachat mimefactory::tests::test_subject_from_dc
        PASS [   0.261s] deltachat mimeparser::tests::test_x_microsoft_original_message_id_precedence
        PASS [   2.583s] deltachat context::tests::test_check_passphrase
        PASS [   3.589s] deltachat chat::tests::test_modify_chat_disordered
        PASS [   1.847s] deltachat imex::tests::test_import_backup_reset_config_cache
        PASS [   1.973s] deltachat imex::transfer::tests::test_drop_provider
        PASS [   1.673s] deltachat mimefactory::tests::test_subject_from_mua
        PASS [   2.353s] deltachat imex::transfer::tests::test_send_receive
        PASS [   1.703s] deltachat mimefactory::tests::test_subject_unicode
        PASS [   3.146s] deltachat imex::tests::test_export_and_import_backup
        PASS [  30.158s] deltachat oauth2::tests::test_get_oauth2_token
        PASS [  30.170s] deltachat oauth2::tests::test_get_oauth2_addr
------------
     Summary [  34.100s] 446/808 tests run: 444 passed, 2 failed, 1 skipped
        FAIL [   0.136s] deltachat oauth2::tests::test_get_oauth2_url
        FAIL [   0.017s] deltachat oauth2::tests::test_replace_in_uri
error: test run failed
</error message>
<c function>
static void replace_in_uri(char** uri, const char* key, const char* value)
{
	if (uri && key && value) {
		char* value_urlencoded = dc_urlencode(value);
		dc_str_replace(uri, key, value_urlencoded);
		free(value_urlencoded);
	}
}
</c function>
<rust function signature>
fn replace_in_uri(uri: &str, key: &str, value: &str) -> String 
</rust function signature>
<rust function dependencies, and data type declarations>

</rust function dependencies and data type declarations>
<rust function dependency libraries>
use std::collections::HashMap;
use anyhow::Result;
use percent_encoding::{utf8_percent_encode, NON_ALPHANUMERIC};
use serde::Deserialize;
use crate::config::Config;
use crate::context::Context;
use crate::provider;
use crate::provider::Oauth2Authorizer;
use crate::socks::Socks5Config;
use crate::tools::time;
use super::*;
use crate::test_utils::TestContext;

</rust function dependency libraries>

</message>
<reapir response>
Based on the error message and the provided information, here's the corrected Rust function:

```rust
fn replace_in_uri(uri: &str, key: &str, value: &str) -> String {
    if uri.is_empty() || key.is_empty() || value.is_empty() {
        return uri.to_string();
    }

    let value_urlencoded = utf8_percent_encode(value, NON_ALPHANUMERIC).to_string();
    let search_key = format!("${}", key);
    uri.replace(&search_key, &value_urlencoded)
}
```

The main changes are:

1. We now use `utf8_percent_encode` from the `percent_encoding` crate to URL-encode the value, which matches the behavior of `dc_urlencode` in the C function.

2. Instead of splitting the URI and reconstructing it, we now use the `replace` method, which is simpler and more robust. This change addresses the issue where the function was not correctly replacing the key with the encoded value.

3. We construct the search key by prepending "$" to the key. This matches the format used in the test cases (e.g., "$CLIENT_ID").

4. We return the modified string directly, without any additional string manipulations.

These changes should resolve the failing test cases and make the Rust function behave more like its C counterpart.</reapir response>